<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libAurora.php: Aurora/Addon/WebUI.php Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">libAurora.php
   
   </div>
   <div id="projectbrief">libAurora.php is a PHP5 library for interfacing with various Aurora-Sim modules and services.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('WebUI_8php.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Aurora/Addon/WebUI.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="WebUI_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="comment">//      Defining exception classes in the top of the file for purposes of clarity.</span>
<a name="l00007"></a>00007 <span class="keyword">namespace </span><a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">Aurora\Addon\WebUI</a>{
<a name="l00008"></a>00008 
<a name="l00009"></a>00009         use Aurora\Addon;
<a name="l00010"></a>00010 
<a name="l00013"></a><a class="code" href="interfaceAurora_1_1Addon_1_1WebUI_1_1Exception.html">00013</a>         <span class="keyword">interface </span><a class="code" href="interfaceAurora_1_1Addon_1_1WebUI_1_1Exception.html">Exception</a> <span class="keyword">extends</span> <a class="code" href="interfaceAurora_1_1Addon_1_1Exception.html">Addon\Exception</a>{
<a name="l00014"></a>00014         }
<a name="l00015"></a>00015 
<a name="l00017"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1RuntimeException.html">00017</a>         <span class="keyword">class </span><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1RuntimeException.html" title="WebUI-specific RuntimeException.">RuntimeException</a> <span class="keyword">extends</span> <a class="code" href="classAurora_1_1Addon_1_1RuntimeException.html" title="Addon-specific RuntimeException.">Addon\RuntimeException</a> implements <a class="code" href="interfaceAurora_1_1Addon_1_1WebUI_1_1Exception.html">Exception</a>{
<a name="l00018"></a>00018         }
<a name="l00019"></a>00019 
<a name="l00021"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1InvalidArgumentException.html">00021</a>         <span class="keyword">class </span><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1InvalidArgumentException.html" title="WebUI-specific InvalidArgumentException.">InvalidArgumentException</a> <span class="keyword">extends</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">Addon\InvalidArgumentException</a> implements <a class="code" href="interfaceAurora_1_1Addon_1_1WebUI_1_1Exception.html">Exception</a>{
<a name="l00022"></a>00022         }
<a name="l00023"></a>00023 
<a name="l00025"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1UnexpectedValueException.html">00025</a>         <span class="keyword">class </span><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1UnexpectedValueException.html" title="WebUI-specific UnexpectedValueException.">UnexpectedValueException</a> <span class="keyword">extends</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">Addon\UnexpectedValueException</a> implements <a class="code" href="interfaceAurora_1_1Addon_1_1WebUI_1_1Exception.html">Exception</a>{
<a name="l00026"></a>00026         }
<a name="l00027"></a>00027 
<a name="l00029"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1LengthException.html">00029</a>         <span class="keyword">class </span><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1LengthException.html" title="WebUI-specific LengthException.">LengthException</a> <span class="keyword">extends</span> <a class="code" href="classAurora_1_1Addon_1_1LengthException.html" title="Addon-specific LengthException.">Addon\LengthException</a> implements <a class="code" href="interfaceAurora_1_1Addon_1_1WebUI_1_1Exception.html">Exception</a>{
<a name="l00030"></a>00030         }
<a name="l00031"></a>00031 
<a name="l00033"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BadMethodCallException.html">00033</a>         <span class="keyword">class </span><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BadMethodCallException.html" title="WebUI-specific BadMethodCallException.">BadMethodCallException</a> <span class="keyword">extends</span> <a class="code" href="classAurora_1_1Addon_1_1BadMethodCallException.html" title="Addon-specific BadMethodCallException.">Addon\BadMethodCallException</a> implements <a class="code" href="interfaceAurora_1_1Addon_1_1WebUI_1_1Exception.html">Exception</a>{
<a name="l00034"></a>00034         }
<a name="l00035"></a>00035 }
<a name="l00036"></a>00036 
<a name="l00038"></a>00038 <span class="keyword">namespace </span>Aurora\Addon{
<a name="l00039"></a>00039 
<a name="l00040"></a>00040         use DateTime;
<a name="l00041"></a>00041 
<a name="l00042"></a>00042         use <a class="code" href="classGlobals.html" title="Class used for globally-available stuff, because a) define and const only support scalar values...">Globals</a>;
<a name="l00043"></a>00043 
<a name="l00044"></a>00044         use <a class="code" href="classOpenMetaverse_1_1Vector3.html" title="Transposition of Vector3.">OpenMetaverse\Vector3</a>;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046         use <a class="code" href="classAurora_1_1Framework_1_1RegionFlags.html" title="Since PHP doesn&#39;t support enums, we need to use class constants for bitfield flags.">Aurora\Framework\RegionFlags</a>;
<a name="l00047"></a>00047         use <a class="code" href="interfaceAurora_1_1Services_1_1Interfaces_1_1User.html" title="We&#39;re deviating from the c# here, this interface will be lightweight-bare minimum.">Aurora\Services\Interfaces\User</a>;
<a name="l00048"></a>00048 
<a name="l00050"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html">00050</a>         <span class="keyword">class </span><a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a> <span class="keyword">extends</span> <a class="code" href="classAurora_1_1Addon_1_1abstractAPI.html">abstractAPI</a>{
<a name="l00052"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#af134c5a683b22a0c49f600a8b1bc85bd">00052</a>                 <span class="keyword">const</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#af134c5a683b22a0c49f600a8b1bc85bd" title="string Regular expression for validating UUIDs (put here until this operation gets performed elsewher...">regex_UUID</a> = <span class="stringliteral">&#39;/^[a-fA-F0-9]{8}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{4}\-[a-fA-F0-9]{12}$/&#39;</span>;
<a name="l00053"></a>00053 
<a name="l00055"></a>00055 
<a name="l00060"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a8c7aed34f19ec3566f436bf9f301b3db">00060</a>                 <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a8c7aed34f19ec3566f436bf9f301b3db" title="This is protected because we&#39;re going to use a registry method to access it.">__construct</a>(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>, <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d" title="string WebUI API password">$password</a>){
<a name="l00061"></a>00061                         <span class="keywordflow">if</span>(is_string(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>) === <span class="keyword">false</span>){
<a name="l00062"></a>00062                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;WebUI API end point must be a string&#39;</span>);
<a name="l00063"></a>00063                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strpos(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>, <span class="stringliteral">&#39;http://&#39;</span>) === <span class="keyword">false</span> &amp;&amp; strpos(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>, <span class="stringliteral">&#39;https://&#39;</span>) === <span class="keyword">false</span>){ <span class="comment">// for now, we&#39;re not doing any paranoid regex-based validation.</span>
<a name="l00064"></a>00064                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;WebUI API end point must begin with http:// or https://&#39;</span>);
<a name="l00065"></a>00065                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d" title="string WebUI API password">$password</a>) === <span class="keyword">false</span>){
<a name="l00066"></a>00066                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;WebUI API password should be a string&#39;</span>);
<a name="l00067"></a>00067                         }
<a name="l00068"></a>00068                         $this-&gt;serviceURL = <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>;
<a name="l00069"></a>00069                         $this-&gt;password   = md5(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d" title="string WebUI API password">$password</a>); <span class="comment">// I suppose we could be extremely paranoid and unset $password after this if we really wanted.</span>
<a name="l00070"></a>00070                 }
<a name="l00071"></a>00071 
<a name="l00073"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389">00073</a>                 <span class="keyword">protected</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>;
<a name="l00074"></a>00074 
<a name="l00076"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d">00076</a>                 <span class="keyword">protected</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d" title="string WebUI API password">$password</a>;
<a name="l00077"></a>00077 
<a name="l00079"></a>00079 
<a name="l00085"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad53920336f65274cb34cbf14e5560c56">00085</a>                 <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad53920336f65274cb34cbf14e5560c56" title="registry method. Sets &amp; gets instances of Aurora::Addon::WebUI">r</a>(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>, <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d" title="string WebUI API password">$password</a>=null){
<a name="l00086"></a>00086                         <span class="keyword">static</span> $registry = array();
<a name="l00087"></a>00087                         <span class="keywordflow">if</span>(isset($registry[<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>]) === <span class="keyword">false</span>){
<a name="l00088"></a>00088                                 <span class="keywordflow">if</span>(isset(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d" title="string WebUI API password">$password</a>) === <span class="keyword">false</span>){
<a name="l00089"></a>00089                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Cannot create an instance of WebUI API interface without a password&#39;</span>);
<a name="l00090"></a>00090                                 }
<a name="l00091"></a>00091                                 $instance = <span class="keyword">new</span> <span class="keyword">static</span>(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>, <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a607686ef9f99ea7c42f4f3dd3dbb2b0d" title="string WebUI API password">$password</a>); <span class="comment">// we&#39;re assigning it to a local variable as a lazy means of avoiding doing valid type checks for array keys. any errors that would crop up about that would trigger InvalidArgumentException in Aurora::Addon::WebUI::__construct()</span>
<a name="l00092"></a>00092                                 $registry[<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>] = $instance; <span class="comment">// any child implementation of Aurora::Addon::WebUI that breaks this laziness is on their own at this point.</span>
<a name="l00093"></a>00093                         }
<a name="l00094"></a>00094                         <span class="keywordflow">return</span> $registry[<a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a9e612b03617c70ac9c8ee664edc04389" title="string WebUI API end point.">$serviceURL</a>];
<a name="l00095"></a>00095                 }
<a name="l00096"></a>00096 
<a name="l00098"></a>00098 
<a name="l00104"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a3441c8721acb915e65d5dcdd201f7fce">00104</a>                 <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a3441c8721acb915e65d5dcdd201f7fce" title="makes a call to the WebUI API end point running on an instance of Aurora.">makeCallToAPI</a>($method, array $arguments=null, array $expectedResponse){
<a name="l00105"></a>00105                         <span class="keywordflow">if</span>(is_string($method) === <span class="keyword">false</span> || ctype_graph($method) === <span class="keyword">false</span>){
<a name="l00106"></a>00106                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;API method parameter was invalid.&#39;</span>);
<a name="l00107"></a>00107                         }
<a name="l00108"></a>00108                         $arguments = isset($arguments) ? $arguments : array();
<a name="l00109"></a>00109                         $arguments = array_merge(array(
<a name="l00110"></a>00110                                 <span class="stringliteral">&#39;Method&#39;</span>      =&gt; $method,
<a name="l00111"></a>00111                                 <span class="stringliteral">&#39;WebPassword&#39;</span> =&gt; $this-&gt;password
<a name="l00112"></a>00112                         ), $arguments);
<a name="l00113"></a>00113                         $ch = curl_init($this-&gt;serviceURL);
<a name="l00114"></a>00114                         curl_setopt_array($ch, array(
<a name="l00115"></a>00115                                 CURLOPT_HEADER         =&gt; <span class="keyword">false</span>,
<a name="l00116"></a>00116                                 CURLOPT_POST           =&gt; <span class="keyword">true</span>,
<a name="l00117"></a>00117                                 CURLOPT_RETURNTRANSFER =&gt; <span class="keyword">true</span>,
<a name="l00118"></a>00118                                 CURLOPT_POSTFIELDS     =&gt; implode(<span class="charliteral">&#39;,&#39;</span>, array(json_encode($arguments)))
<a name="l00119"></a>00119                         ));
<a name="l00120"></a>00120                         $result = curl_exec($ch);
<a name="l00121"></a>00121                         curl_close($ch);
<a name="l00122"></a>00122                         <span class="keywordflow">if</span>(is_string($result) === <span class="keyword">true</span>){
<a name="l00123"></a>00123                                 $result = json_decode($result);
<a name="l00124"></a>00124                                 <span class="keywordflow">if</span>(is_object($result) === <span class="keyword">false</span>){
<a name="l00125"></a>00125                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;API result expected to be object, &#39;</span> . gettype($result) . <span class="stringliteral">&#39; found.&#39;</span>);
<a name="l00126"></a>00126                                 }
<a name="l00127"></a>00127                                 $exprsp = 0;
<a name="l00128"></a>00128                                 <span class="keywordflow">foreach</span>($expectedResponse as $k=&gt;$v){
<a name="l00129"></a>00129                                         ++$exprsp;
<a name="l00130"></a>00130                                         <span class="keywordflow">if</span>(property_exists($result, $k) === <span class="keyword">false</span>){
<a name="l00131"></a>00131                                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but required response properties were missing.&#39;</span>, $exprsp * 6);
<a name="l00132"></a>00132                                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(in_array(gettype($result-&gt;{$k}), array_keys($v)) === <span class="keyword">false</span>){
<a name="l00133"></a>00133                                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but required response property was of unexpected type.&#39;</span>, ($exprsp * 6) + 1);
<a name="l00134"></a>00134                                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(count($v[gettype($result-&gt;{$k})]) &gt; 0){
<a name="l00135"></a>00135                                                 $validValue = <span class="keyword">false</span>;
<a name="l00136"></a>00136                                                 <span class="keywordflow">foreach</span>($v[gettype($result-&gt;{$k})] as $_k =&gt; $possibleValue){
<a name="l00137"></a>00137                                                         <span class="keywordflow">if</span>(is_integer($_k) === <span class="keyword">true</span>){
<a name="l00138"></a>00138                                                                 <span class="keywordflow">if</span>(gettype($result-&gt;{$k}) === <span class="stringliteral">&#39;boolean&#39;</span>){
<a name="l00139"></a>00139                                                                         <span class="keywordflow">if</span>(is_bool($possibleValue) === <span class="keyword">false</span>){
<a name="l00140"></a>00140                                                                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Only booleans can be given as valid values to a boolean type.&#39;</span>);
<a name="l00141"></a>00141                                                                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($result-&gt;{$k} === $possibleValue){
<a name="l00142"></a>00142                                                                                 $validValue = <span class="keyword">true</span>;
<a name="l00143"></a>00143                                                                                 <span class="keywordflow">break</span>;
<a name="l00144"></a>00144                                                                         }
<a name="l00145"></a>00145                                                                 }<span class="keywordflow">else</span>{
<a name="l00146"></a>00146                                                                         $subPropertyKeys = array_keys($possibleValue);
<a name="l00147"></a>00147                                                                         <span class="keywordflow">switch</span>(gettype($result-&gt;{$k})){
<a name="l00148"></a>00148                                                                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;array&#39;</span>:
<a name="l00149"></a>00149                                                                                         <span class="keywordflow">foreach</span>($result-&gt;{$k} as $_v){
<a name="l00150"></a>00150                                                                                                 <span class="keywordflow">if</span>(in_array(gettype($_v), $subPropertyKeys) === <span class="keyword">false</span>){
<a name="l00151"></a>00151                                                                                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but required response sub-property was of unexpected type.&#39;</span>, ($exprsp * 6) + 3);
<a name="l00152"></a>00152                                                                                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(gettype($_v) === <span class="stringliteral">&#39;object&#39;</span> &amp;&amp; isset($possibleValue[gettype($_v)]) === <span class="keyword">true</span>){
<a name="l00153"></a>00153                                                                                                         <span class="keywordflow">foreach</span>($possibleValue[gettype($_v)] as $__k =&gt; $__v){
<a name="l00154"></a>00154                                                                                                                 <span class="keywordflow">if</span>(isset($__v[<span class="stringliteral">&#39;float&#39;</span>]) == <span class="keyword">true</span>){
<a name="l00155"></a>00155                                                                                                                         $possibleValue[gettype($_v)][<span class="stringliteral">&#39;double&#39;</span>] = $__v[<span class="stringliteral">&#39;float&#39;</span>];
<a name="l00156"></a>00156                                                                                                                 }
<a name="l00157"></a>00157                                                                                                         }
<a name="l00158"></a>00158                                                                                                         $pos = $possibleValue[gettype($_v)];
<a name="l00159"></a>00159                                                                                                         <span class="keywordflow">if</span>(gettype($_v) === <span class="stringliteral">&#39;object&#39;</span>){
<a name="l00160"></a>00160                                                                                                                 $pos = current($pos);
<a name="l00161"></a>00161                                                                                                                 <span class="keywordflow">if</span>($pos !== <span class="keyword">false</span>){
<a name="l00162"></a>00162                                                                                                                         <span class="keywordflow">foreach</span>($pos as $__k =&gt; $__v){
<a name="l00163"></a>00163                                                                                                                                 <span class="keywordflow">if</span>(isset($__v[<span class="stringliteral">&#39;float&#39;</span>]) === <span class="keyword">true</span>){
<a name="l00164"></a>00164                                                                                                                                         $pos[$__k][<span class="stringliteral">&#39;double&#39;</span>] = $__v[<span class="stringliteral">&#39;float&#39;</span>];
<a name="l00165"></a>00165                                                                                                                                 }
<a name="l00166"></a>00166                                                                                                                         }
<a name="l00167"></a>00167                                                                                                                 }
<a name="l00168"></a>00168                                                                                                         }
<a name="l00169"></a>00169                                                                                                         <span class="keywordflow">if</span>($pos !== <span class="keyword">false</span>){
<a name="l00170"></a>00170                                                                                                                 <span class="keywordflow">foreach</span>($pos as $__k =&gt; $__v){
<a name="l00171"></a>00171                                                                                                                         <span class="keywordflow">if</span>(isset($_v-&gt;{$__k}) === <span class="keyword">false</span>){
<a name="l00172"></a>00172                                                                                                                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but required response sub-property property was of missing.&#39;</span>, ($exprsp * 6) + 4);
<a name="l00173"></a>00173                                                                                                                         }<span class="keywordflow">else</span>{
<a name="l00174"></a>00174                                                                                                                                 <span class="keywordflow">if</span>(in_array(gettype($_v-&gt;{$__k}), array_keys($__v)) === <span class="keyword">false</span>){
<a name="l00175"></a>00175                                                                                                                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but required response sub-property was of unexpected type.&#39;</span>, ($exprsp * 6) + 5);
<a name="l00176"></a>00176                                                                                                                                 }
<a name="l00177"></a>00177                                                                                                                         }
<a name="l00178"></a>00178                                                                                                                 }
<a name="l00179"></a>00179                                                                                                         }
<a name="l00180"></a>00180                                                                                                 }
<a name="l00181"></a>00181                                                                                         }
<a name="l00182"></a>00182                                                                                         $validValue = <span class="keyword">true</span>;
<a name="l00183"></a>00183                                                                                 <span class="keywordflow">break</span>;
<a name="l00184"></a>00184                                                                                 <span class="keywordflow">case</span> <span class="stringliteral">&#39;object&#39;</span>:
<a name="l00185"></a>00185                                                                                         <span class="keywordflow">foreach</span>($possibleValue as $_k =&gt; $_v){
<a name="l00186"></a>00186                                                                                                 <span class="keywordflow">if</span>(isset($_v[<span class="stringliteral">&#39;float&#39;</span>]) === <span class="keyword">true</span>){
<a name="l00187"></a>00187                                                                                                         $possibleValue[$_k][<span class="stringliteral">&#39;double&#39;</span>] = $_v[<span class="stringliteral">&#39;float&#39;</span>];
<a name="l00188"></a>00188                                                                                                 }
<a name="l00189"></a>00189                                                                                         }
<a name="l00190"></a>00190                                                                                         <span class="keywordflow">foreach</span>($possibleValue as $_k =&gt; $_v){
<a name="l00191"></a>00191                                                                                                 <span class="keywordflow">if</span>(isset($result-&gt;{$k}-&gt;{$_k}) === <span class="keyword">false</span>){
<a name="l00192"></a>00192                                                                                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> UnexpectedValueException(<span class="stringliteral">&#39;Call to API was successful, but required response sub-property property was of missing.&#39;</span>, ($exprsp * 6) + 4);
<a name="l00193"></a>00193                                                                                                 }<span class="keywordflow">else</span>{
<a name="l00194"></a>00194                                                                                                         <span class="keywordflow">if</span>(in_array(gettype($result-&gt;{$k}-&gt;{$_k}), array_keys($possibleValue[$_k])) === <span class="keyword">false</span>){
<a name="l00195"></a>00195                                                                                                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> UnexpectedValueException(<span class="stringliteral">&#39;Call to API was successful, but required response sub-property was of unexpected type.&#39;</span>, ($exprsp * 6) + 5);
<a name="l00196"></a>00196                                                                                                         }
<a name="l00197"></a>00197                                                                                                 }
<a name="l00198"></a>00198                                                                                         }
<a name="l00199"></a>00199                                                                                         $validValue = <span class="keyword">true</span>;
<a name="l00200"></a>00200                                                                                 <span class="keywordflow">break</span>;
<a name="l00201"></a>00201                                                                         }
<a name="l00202"></a>00202                                                                 }
<a name="l00203"></a>00203                                                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($result-&gt;{$k} === $possibleValue){
<a name="l00204"></a>00204                                                                 $validValue = <span class="keyword">true</span>;
<a name="l00205"></a>00205                                                                 <span class="keywordflow">break</span>;
<a name="l00206"></a>00206                                                         }
<a name="l00207"></a>00207                                                 }
<a name="l00208"></a>00208                                                 <span class="keywordflow">if</span>($validValue === <span class="keyword">false</span>){
<a name="l00209"></a>00209                                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> UnexpectedValueException(<span class="stringliteral">&#39;Call to API was successful, but required response property had an unexpected value.&#39;</span>, ($exprsp * 6) + 2);
<a name="l00210"></a>00210                                                 }
<a name="l00211"></a>00211                                         }
<a name="l00212"></a>00212                                 }
<a name="l00213"></a>00213                                 <span class="keywordflow">return</span> $result;
<a name="l00214"></a>00214                         }
<a name="l00215"></a>00215                         <span class="keywordflow">throw</span> <span class="keyword">new</span> RuntimeException(<span class="stringliteral">&#39;API call failed to execute.&#39;</span>); <span class="comment">// if this starts happening frequently, we&#39;ll add in some more debugging code.</span>
<a name="l00216"></a>00216                 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="preprocessor">#region textures</span>
<a name="l00219"></a>00219 <span class="preprocessor"></span>
<a name="l00221"></a>00221 
<a name="l00225"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a38644e2d07ee4a38cbc73a91adb8e567">00225</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a38644e2d07ee4a38cbc73a91adb8e567" title="Returns the URI for a grid texture.">GridTexture</a>($uuid){
<a name="l00226"></a>00226                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00227"></a>00227                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Texture UUID should be a string.&#39;</span>);
<a name="l00228"></a>00228                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l00229"></a>00229                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Texture UUID was invalid.&#39;</span>);
<a name="l00230"></a>00230                         }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232                         <span class="keywordflow">return</span> $this-&gt;get_grid_info(<span class="stringliteral">&#39;WebUIHandlerTextureServer&#39;</span>) . <span class="stringliteral">&#39;/index.php?&#39;</span> . http_build_query(array( <span class="stringliteral">&#39;method&#39;</span>=&gt;<span class="stringliteral">&#39;GridTexture&#39;</span>, <span class="stringliteral">&#39;uuid&#39;</span>=&gt;$uuid));
<a name="l00233"></a>00233                 }
<a name="l00234"></a>00234 
<a name="l00236"></a>00236 
<a name="l00240"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a102ab38bd50c6a4a899a59f42221294b">00240</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a102ab38bd50c6a4a899a59f42221294b" title="Returns the URI for a region texture.">MapTexture</a>(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GridRegion $region){
<a name="l00241"></a>00241                         <span class="keywordflow">return</span> $region-&gt;serverURI() . <span class="stringliteral">&#39;/index.php?&#39;</span> . http_build_query(array( <span class="stringliteral">&#39;method&#39;</span>=&gt;<span class="stringliteral">&#39;regionImage&#39;</span> . str_replace(<span class="charliteral">&#39;-&#39;</span>,<span class="stringliteral">&#39;&#39;</span>, $region-&gt;RegionID())));
<a name="l00242"></a>00242                 }
<a name="l00243"></a>00243 
<a name="l00245"></a>00245 
<a name="l00250"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aad3fa4e694c36fbfd648273cc47c471e">00250</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aad3fa4e694c36fbfd648273cc47c471e" title="Returns the size of the specified texture.">GridTextureSize</a>($uuid){
<a name="l00251"></a>00251                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00252"></a>00252                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Texture UUID should be a string.&#39;</span>);
<a name="l00253"></a>00253                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l00254"></a>00254                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Texture UUID was invalid.&#39;</span>);
<a name="l00255"></a>00255                         }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;SizeOfHTTPGetTextureImage&#39;</span>, array(
<a name="l00258"></a>00258                                 <span class="stringliteral">&#39;Texture&#39;</span> =&gt; $uuid
<a name="l00259"></a>00259                         ), array(
<a name="l00260"></a>00260                                 <span class="stringliteral">&#39;Size&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l00261"></a>00261                         ))-&gt;Size;
<a name="l00262"></a>00262                 }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="preprocessor">#endregion</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span>
<a name="l00266"></a>00266 <span class="preprocessor">#region Grid</span>
<a name="l00267"></a>00267 <span class="preprocessor"></span>
<a name="l00269"></a>00269 
<a name="l00273"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a5a8005e4a46e7e3787f23465802ddbe7">00273</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a5a8005e4a46e7e3787f23465802ddbe7" title="Determines the online status of the grid and whether logins are enabled.">OnlineStatus</a>(){
<a name="l00274"></a>00274                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;OnlineStatus&#39;</span>, null, array(
<a name="l00275"></a>00275                                 <span class="stringliteral">&#39;Online&#39;</span>       =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l00276"></a>00276                                 <span class="stringliteral">&#39;LoginEnabled&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00277"></a>00277                         ));
<a name="l00278"></a>00278                         <span class="keywordflow">return</span> <span class="keyword">new</span> WebUI\OnlineStatus($result-&gt;Online, $result-&gt;LoginEnabled);
<a name="l00279"></a>00279                 }
<a name="l00280"></a>00280 
<a name="l00282"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a89d5b470485363ed5bbc759d1e885227">00282</a>                 <span class="keyword">protected</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a89d5b470485363ed5bbc759d1e885227" title="object an instance of Aurora::Addon::WebUI::GridInfo">$GridInfo</a>;
<a name="l00283"></a>00283 
<a name="l00285"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a37de71a37de731938567b49129469765">00285</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a37de71a37de731938567b49129469765" title="Processes should not be long-lasting, so we only fetch this once.">get_grid_info</a>($info=null){
<a name="l00286"></a>00286                         <span class="keywordflow">if</span>(isset($this-&gt;GridInfo) === <span class="keyword">false</span>){
<a name="l00287"></a>00287                                 $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;get_grid_info&#39;</span>, null, array(
<a name="l00288"></a>00288                                         <span class="stringliteral">&#39;GridInfo&#39;</span> =&gt; array(<span class="stringliteral">&#39;object&#39;</span>=&gt;array())
<a name="l00289"></a>00289                                 ));
<a name="l00290"></a>00290 
<a name="l00291"></a>00291                                 $this-&gt;GridInfo = WebUI\GridInfo::f();
<a name="l00292"></a>00292                                 <span class="keywordflow">foreach</span>($result-&gt;GridInfo as $k=&gt;$v){
<a name="l00293"></a>00293                                         $this-&gt;GridInfo[$k] = $v;
<a name="l00294"></a>00294                                 }
<a name="l00295"></a>00295                         }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297                         <span class="keywordflow">return</span> (isset($info) &amp;&amp; is_string($info) &amp;&amp; ctype_graph($info)) ? $this-&gt;GridInfo[$info] : $this-&gt;GridInfo;
<a name="l00298"></a>00298                 }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 <span class="preprocessor">#endregion</span>
<a name="l00301"></a>00301 <span class="preprocessor"></span>
<a name="l00302"></a>00302 <span class="preprocessor">#region Account</span>
<a name="l00303"></a>00303 <span class="preprocessor"></span>
<a name="l00304"></a>00304 <span class="preprocessor">#region Registration</span>
<a name="l00305"></a>00305 <span class="preprocessor"></span>
<a name="l00307"></a>00307 
<a name="l00312"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a29d7b7bf2c6b3959a653d30d6597ef9e">00312</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a29d7b7bf2c6b3959a653d30d6597ef9e" title="Determines whether the specified username exists in the AuroraSim database.">CheckIfUserExists</a>($name){
<a name="l00313"></a>00313                         <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">false</span>){
<a name="l00314"></a>00314                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Name should be a string&#39;</span>);
<a name="l00315"></a>00315                         }
<a name="l00316"></a>00316                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;CheckIfUserExists&#39;</span>, array(<span class="stringliteral">&#39;Name&#39;</span>=&gt;$name), array(<span class="stringliteral">&#39;Verified&#39;</span>=&gt;array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())))-&gt;Verified;
<a name="l00317"></a>00317                 }
<a name="l00318"></a>00318 
<a name="l00320"></a>00320 
<a name="l00336"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a06bf046eb046c4dd513475a0f6296b90">00336</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a06bf046eb046c4dd513475a0f6296b90" title="Attempts to create an account with the specified details.">CreateAccount</a>($Name, $Password, $Email=<span class="stringliteral">&#39;&#39;</span>, $HomeRegion=<span class="stringliteral">&#39;&#39;</span>, $userLevel=0, $RLDOB=<span class="stringliteral">&#39;1970-01-01&#39;</span>, $RLFirstName=<span class="stringliteral">&#39;&#39;</span>, $RLLastName=<span class="stringliteral">&#39;&#39;</span>, $RLAddress=<span class="stringliteral">&#39;&#39;</span>, $RLCity=<span class="stringliteral">&#39;&#39;</span>, $RLZip=<span class="stringliteral">&#39;&#39;</span>, $RLCountry=<span class="stringliteral">&#39;&#39;</span>, $RLIP=<span class="stringliteral">&#39;&#39;</span>){
<a name="l00337"></a>00337                         <span class="keywordflow">if</span>(is_string($userLevel) === <span class="keyword">true</span> &amp;&amp; ctype_digit($userLevel) === <span class="keyword">true</span>){
<a name="l00338"></a>00338                                 $userLevel = (integer)$userLevel;
<a name="l00339"></a>00339                         }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341                         <span class="keywordflow">if</span>(is_string($Name) === <span class="keyword">false</span>){
<a name="l00342"></a>00342                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Username must be a string.&#39;</span>);
<a name="l00343"></a>00343                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($this-&gt;CheckIfUserExists($Name) === <span class="keyword">true</span>){
<a name="l00344"></a>00344                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;That username has already been taken.&#39;</span>);
<a name="l00345"></a>00345                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($Password) === <span class="keyword">false</span>){
<a name="l00346"></a>00346                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Password must be a string.&#39;</span>);
<a name="l00347"></a>00347                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strlen($Password) &lt; 8){
<a name="l00348"></a>00348                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1LengthException.html" title="Addon-specific LengthException.">LengthException</a>(<span class="stringliteral">&#39;Password cannot be less than 8 characters long.&#39;</span>);
<a name="l00349"></a>00349                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($Email) === <span class="keyword">false</span>){
<a name="l00350"></a>00350                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Email address must be a string.&#39;</span>);
<a name="l00351"></a>00351                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($Email !== <span class="stringliteral">&#39;&#39;</span> &amp;&amp; is_email($Email) === <span class="keyword">false</span>){
<a name="l00352"></a>00352                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Email address was specified but was found to be invalid.&#39;</span>);
<a name="l00353"></a>00353                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($HomeRegion) === <span class="keyword">false</span>){
<a name="l00354"></a>00354                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Home Region must be a string.&#39;</span>);
<a name="l00355"></a>00355                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($userLevel) === <span class="keyword">false</span>){
<a name="l00356"></a>00356                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User Level must be an integer.&#39;</span>);
<a name="l00357"></a>00357                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($userLevel &lt; -1){
<a name="l00358"></a>00358                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User Level must be greater than or equal to minus one.&#39;</span>);
<a name="l00359"></a>00359                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($RLDOB) === <span class="keyword">false</span>){
<a name="l00360"></a>00360                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User Date of Birth must be a string.&#39;</span>);
<a name="l00361"></a>00361                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strtotime($RLDOB) === <span class="keyword">false</span>){
<a name="l00362"></a>00362                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User Date of Birth was not valid.&#39;</span>);
<a name="l00363"></a>00363                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($RLIP) === <span class="keyword">false</span>){
<a name="l00364"></a>00364                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User RL IP Address must be a string.&#39;</span>);
<a name="l00365"></a>00365                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classGlobals.html#a73e4ce7a056932cccdb802b637135bfd" title="Returns an instance of Globals via a singelton pattern.">Globals::i</a>()-&gt;registrationPostalRequired === <span class="keyword">true</span>){
<a name="l00366"></a>00366                                 <span class="keywordflow">if</span>(is_string($RLFirstName) === <span class="keyword">false</span>){
<a name="l00367"></a>00367                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User RL First name must be a string.&#39;</span>);
<a name="l00368"></a>00368                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(trim($RLFirstName) === <span class="stringliteral">&#39;&#39;</span>){
<a name="l00369"></a>00369                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User RL First name must not be an empty string.&#39;</span>);
<a name="l00370"></a>00370                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($RLLastName) === <span class="keyword">false</span>){
<a name="l00371"></a>00371                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User RL Last name must be a string.&#39;</span>);
<a name="l00372"></a>00372                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($RLAddress) === <span class="keyword">false</span>){
<a name="l00373"></a>00373                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User RL Address must be a string.&#39;</span>);
<a name="l00374"></a>00374                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($RLCity) === <span class="keyword">false</span>){
<a name="l00375"></a>00375                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User RL City must be a string.&#39;</span>);
<a name="l00376"></a>00376                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($RLZip) === <span class="keyword">false</span>){
<a name="l00377"></a>00377                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User RL Zip code must be a string.&#39;</span>);
<a name="l00378"></a>00378                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($RLCountry) === <span class="keyword">false</span>){
<a name="l00379"></a>00379                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User RL Country must be a string.&#39;</span>);
<a name="l00380"></a>00380                                 }
<a name="l00381"></a>00381                         }
<a name="l00382"></a>00382 
<a name="l00383"></a>00383                         $Name        = trim($Name);
<a name="l00384"></a>00384                         $Password    = <span class="stringliteral">&#39;$1$&#39;</span> . md5($Password);
<a name="l00385"></a>00385                         $RLDOB      = date(<span class="stringliteral">&#39;Y-m-d&#39;</span>, strtotime($RLDOB));
<a name="l00386"></a>00386                         $RLFirstName = trim($RLFirstName);
<a name="l00387"></a>00387                         $RLLastName  = trim($RLLastName);
<a name="l00388"></a>00388                         $RLAddress   = trim($RLAddress);
<a name="l00389"></a>00389                         $RLCity      = trim($RLCity);
<a name="l00390"></a>00390                         $RLZip       = trim($RLZip);
<a name="l00391"></a>00391                         $RLCountry   = trim($RLCountry);
<a name="l00392"></a>00392                         $RLIP        = trim($RLIP);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394                         $expectedResponse = array(
<a name="l00395"></a>00395                                 <span class="stringliteral">&#39;UUID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array())
<a name="l00396"></a>00396                         );
<a name="l00397"></a>00397                         <span class="keywordflow">if</span>(<a class="code" href="classGlobals.html#a73e4ce7a056932cccdb802b637135bfd" title="Returns an instance of Globals via a singelton pattern.">Globals::i</a>()-&gt;registrationActivationRequired === <span class="keyword">true</span>){
<a name="l00398"></a>00398                                 $expectedResponse[<span class="stringliteral">&#39;WebUIActivationToken&#39;</span>] = array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array());
<a name="l00399"></a>00399                         }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;CreateAccount&#39;</span>, array(
<a name="l00402"></a>00402                                 <span class="stringliteral">&#39;Name&#39;</span>               =&gt; $Name,
<a name="l00403"></a>00403                                 <span class="stringliteral">&#39;PasswordHash&#39;</span>       =&gt; $Password,
<a name="l00404"></a>00404                                 <span class="stringliteral">&#39;Email&#39;</span>              =&gt; $Email,
<a name="l00405"></a>00405                                 <span class="stringliteral">&#39;RLDOB&#39;</span>              =&gt; $RLDOB,
<a name="l00406"></a>00406                                 <span class="stringliteral">&#39;RLFirstName&#39;</span>        =&gt; $RLFirstName,
<a name="l00407"></a>00407                                 <span class="stringliteral">&#39;RLLastName&#39;</span>         =&gt; $RLLastName,
<a name="l00408"></a>00408                                 <span class="stringliteral">&#39;RLAddress&#39;</span>          =&gt; $RLAddress,
<a name="l00409"></a>00409                                 <span class="stringliteral">&#39;RLCity&#39;</span>             =&gt; $RLCity,
<a name="l00410"></a>00410                                 <span class="stringliteral">&#39;RLZip&#39;</span>              =&gt; $RLZip,
<a name="l00411"></a>00411                                 <span class="stringliteral">&#39;RLCountry&#39;</span>          =&gt; $RLCountry,
<a name="l00412"></a>00412                                 <span class="stringliteral">&#39;RLIP&#39;</span>               =&gt; $RLIP,
<a name="l00413"></a>00413                                 <span class="stringliteral">&#39;ActivationRequired&#39;</span> =&gt; (<a class="code" href="classGlobals.html#a73e4ce7a056932cccdb802b637135bfd" title="Returns an instance of Globals via a singelton pattern.">Globals::i</a>()-&gt;registrationActivationRequired === <span class="keyword">true</span>)
<a name="l00414"></a>00414                         ),      $expectedResponse);
<a name="l00415"></a>00415 
<a name="l00416"></a>00416                         $ActivationToken = null;
<a name="l00417"></a>00417                         <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $result-&gt;UUID) === <span class="keyword">false</span>){
<a name="l00418"></a>00418                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but UUID response was not a valid UUID.&#39;</span>);
<a name="l00419"></a>00419                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($result-&gt;UUID === <span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>){
<a name="l00420"></a>00420                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful but registration failed.&#39;</span>);
<a name="l00421"></a>00421                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classGlobals.html#a73e4ce7a056932cccdb802b637135bfd" title="Returns an instance of Globals via a singelton pattern.">Globals::i</a>()-&gt;registrationActivationRequired === <span class="keyword">true</span>){
<a name="l00422"></a>00422                                 <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $result-&gt;WebUIActivationToken) !== 1){
<a name="l00423"></a>00423                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but activation token was not a valid UUID.&#39;</span>);
<a name="l00424"></a>00424                                 }<span class="keywordflow">else</span>{
<a name="l00425"></a>00425                                         $ActivationToken = $result-&gt;WebUIActivationToken;
<a name="l00426"></a>00426                                 }
<a name="l00427"></a>00427                         }
<a name="l00428"></a>00428                         <span class="keywordflow">return</span> array($this-&gt;GetGridUserInfo($result-&gt;UUID), $ActivationToken);
<a name="l00429"></a>00429                 }
<a name="l00430"></a>00430 
<a name="l00432"></a>00432 
<a name="l00435"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a6704b0868dc98d8a98c71d732a172713">00435</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a6704b0868dc98d8a98c71d732a172713" title="Attempt to fetch the public avatar archives.">GetAvatarArchives</a>(){
<a name="l00436"></a>00436                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetAvatarArchives&#39;</span>, null, array(
<a name="l00437"></a>00437                                 <span class="stringliteral">&#39;names&#39;</span>    =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array()),
<a name="l00438"></a>00438                                 <span class="stringliteral">&#39;snapshot&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array())
<a name="l00439"></a>00439                         ));
<a name="l00440"></a>00440 
<a name="l00441"></a>00441                         <span class="keywordflow">if</span>(count($result-&gt;names) !== count($result-&gt;snapshot)){
<a name="l00442"></a>00442                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1LengthException.html" title="Addon-specific LengthException.">LengthException</a>(<span class="stringliteral">&#39;Call to API was successful, but the number of names did not match the number of snapshots&#39;</span>);
<a name="l00443"></a>00443                         }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445                         $archives = array();
<a name="l00446"></a>00446                         <span class="keywordflow">foreach</span>($result-&gt;names as $k=&gt;$v){
<a name="l00447"></a>00447                                 $archives[] = <span class="keyword">new</span> WebUI\basicAvatarArchive($v, $result-&gt;snapshot[$k]);
<a name="l00448"></a>00448                         }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450                         <span class="keywordflow">return</span> <span class="keyword">new</span> WebUI\AvatarArchives($archives);
<a name="l00451"></a>00451                 }
<a name="l00452"></a>00452 
<a name="l00454"></a>00454 
<a name="l00458"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ab26d2c3dd71a541db708c1b9b518506e">00458</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ab26d2c3dd71a541db708c1b9b518506e" title="Determines whether or not the account has been authenticated/verified.">Authenticated</a>($uuid){
<a name="l00459"></a>00459                         <span class="keywordflow">if</span>($uuid instanceof User){
<a name="l00460"></a>00460                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l00461"></a>00461                         }
<a name="l00462"></a>00462                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00463"></a>00463                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID should be a string.&#39;</span>);
<a name="l00464"></a>00464                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l00465"></a>00465                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID supplied was not a valid UUID.&#39;</span>);
<a name="l00466"></a>00466                         }
<a name="l00467"></a>00467                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;Authenticated&#39;</span>, array(<span class="stringliteral">&#39;UUID&#39;</span>=&gt;$uuid), array(
<a name="l00468"></a>00468                                 <span class="stringliteral">&#39;Verified&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00469"></a>00469                         ));
<a name="l00470"></a>00470                         <span class="keywordflow">return</span> $result-&gt;Verified;
<a name="l00471"></a>00471                 }
<a name="l00472"></a>00472 
<a name="l00474"></a>00474 
<a name="l00479"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#af3d5e6848c7af80a8c20ad3e7a0d2e11">00479</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#af3d5e6848c7af80a8c20ad3e7a0d2e11" title="Attempts to activate the account via an activation token.">ActivateAccount</a>($username, $password, $token){
<a name="l00480"></a>00480                         <span class="keywordflow">if</span>(is_string($username) === <span class="keyword">false</span>){
<a name="l00481"></a>00481                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Username must be a string.&#39;</span>);
<a name="l00482"></a>00482                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($this-&gt;CheckIfUserExists($username) === <span class="keyword">false</span>){
<a name="l00483"></a>00483                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Cannot activate a non-existant account.&#39;</span>);
<a name="l00484"></a>00484                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($password) === <span class="keyword">false</span>){
<a name="l00485"></a>00485                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Password must be a string.&#39;</span>);
<a name="l00486"></a>00486                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($token) === <span class="keyword">false</span>){
<a name="l00487"></a>00487                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Token must be a string.&#39;</span>);
<a name="l00488"></a>00488                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $token) !== 1){
<a name="l00489"></a>00489                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Token must be a valid UUID.&#39;</span>);
<a name="l00490"></a>00490                         }
<a name="l00491"></a>00491                         $password = <span class="stringliteral">&#39;$1$&#39;</span> . md5($password);
<a name="l00492"></a>00492 
<a name="l00493"></a>00493                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;ActivateAccount&#39;</span>, array(<span class="stringliteral">&#39;UserName&#39;</span> =&gt; $username, <span class="stringliteral">&#39;PasswordHash&#39;</span> =&gt; $password, <span class="stringliteral">&#39;ActivationToken&#39;</span> =&gt; $token), array(
<a name="l00494"></a>00494                                 <span class="stringliteral">&#39;Verified&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00495"></a>00495                         ));
<a name="l00496"></a>00496 
<a name="l00497"></a>00497                         <span class="keywordflow">return</span> $result-&gt;Verified;
<a name="l00498"></a>00498                 }
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="preprocessor">#endregion</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span>
<a name="l00502"></a>00502 <span class="preprocessor">#region Login</span>
<a name="l00503"></a>00503 <span class="preprocessor"></span>
<a name="l00505"></a>00505 
<a name="l00511"></a>00511                 <span class="keyword">private</span> <span class="keyword">function</span> doLogin($username, $password, $asAdmin=<span class="keyword">false</span>){
<a name="l00512"></a>00512                         <span class="keywordflow">if</span>(is_string($username) === <span class="keyword">false</span>){
<a name="l00513"></a>00513                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Username must be string.&#39;</span>);
<a name="l00514"></a>00514                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(trim($username) === <span class="stringliteral">&#39;&#39;</span>){
<a name="l00515"></a>00515                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1InvalidArgumentException.html" title="Aurora-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Username was an empty string&#39;</span>);
<a name="l00516"></a>00516                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($password) === <span class="keyword">false</span>){
<a name="l00517"></a>00517                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;Password must be a string&#39;</span>);
<a name="l00518"></a>00518                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(trim($password) === <span class="stringliteral">&#39;&#39;</span>){
<a name="l00519"></a>00519                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;Password was an empty string&#39;</span>);
<a name="l00520"></a>00520                         }
<a name="l00521"></a>00521                         $password = <span class="stringliteral">&#39;$1$&#39;</span> . md5($password); <span class="comment">// this is required so we don&#39;t have to transmit the plaintext password.</span>
<a name="l00522"></a>00522                         $result = $this-&gt;makeCallToAPI($asAdmin ? <span class="stringliteral">&#39;AdminLogin&#39;</span> : <span class="stringliteral">&#39;Login&#39;</span>, array(<span class="stringliteral">&#39;Name&#39;</span> =&gt; $username, <span class="stringliteral">&#39;Password&#39;</span> =&gt; $password), array(
<a name="l00523"></a>00523                                 <span class="stringliteral">&#39;Verified&#39;</span>  =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00524"></a>00524                         ));
<a name="l00525"></a>00525                         <span class="keywordflow">if</span>($result-&gt;Verified === <span class="keyword">false</span>){
<a name="l00526"></a>00526                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException(<span class="stringliteral">&#39;Credentials incorrect&#39;</span>);
<a name="l00527"></a>00527                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($result-&gt;UUID, $result-&gt;FirstName, $result-&gt;LastName) === <span class="keyword">false</span>){
<a name="l00528"></a>00528                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> UnexpectedValueException(<span class="stringliteral">&#39;API call was made, credentials were correct but required response properties were missing&#39;</span>);
<a name="l00529"></a>00529                         }
<a name="l00530"></a>00530                         <span class="keywordflow">return</span> WebUI\genUser::r($result-&gt;UUID, $result-&gt;FirstName, $result-&gt;LastName); <span class="comment">// we&#39;re leaving validation up to the genUser class.</span>
<a name="l00531"></a>00531                 }
<a name="l00532"></a>00532 
<a name="l00534"></a>00534 
<a name="l00539"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a4a533e4b69f7790e6b74bff620275edc">00539</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a4a533e4b69f7790e6b74bff620275edc" title="Attempts a login as a normal user.">Login</a>($username, $password){
<a name="l00540"></a>00540                         <span class="keywordflow">return</span> $this-&gt;doLogin($username, $password);
<a name="l00541"></a>00541                 }
<a name="l00542"></a>00542 
<a name="l00544"></a>00544 
<a name="l00549"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a4a4dba6f1a1cd2b1d3996cc03a9cb7c8">00549</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a4a4dba6f1a1cd2b1d3996cc03a9cb7c8" title="Attempts to login as an admin user.">AdminLogin</a>($username, $password){
<a name="l00550"></a>00550                         <span class="keywordflow">return</span> $this-&gt;doLogin($username, $password, <span class="keyword">true</span>);
<a name="l00551"></a>00551                 }
<a name="l00552"></a>00552 
<a name="l00554"></a>00554 
<a name="l00559"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a3079bb84fb4c3bf56d88847eb4a7fdff">00559</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a3079bb84fb4c3bf56d88847eb4a7fdff" title="Attempt to set the WebLoginKey for the specified user.">SetWebLoginKey</a>($for){
<a name="l00560"></a>00560                         <span class="keywordflow">if</span>(is_string($for) === <span class="keyword">false</span>){
<a name="l00561"></a>00561                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID of user must be specified as a string&#39;</span>);
<a name="l00562"></a>00562                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $for) !== 1){
<a name="l00563"></a>00563                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Specified string was not a valid UUID&#39;</span>);
<a name="l00564"></a>00564                         }
<a name="l00565"></a>00565                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;SetWebLoginKey&#39;</span>, array(<span class="stringliteral">&#39;PrincipalID&#39;</span>=&gt;$for), array(
<a name="l00566"></a>00566                                 <span class="stringliteral">&#39;WebLoginKey&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array())
<a name="l00567"></a>00567                         ));
<a name="l00568"></a>00568                         <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $result-&gt;WebLoginKey) !== 1){
<a name="l00569"></a>00569                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;WebLoginKey value present on API result, but value was not a valid UUID.&#39;</span>);
<a name="l00570"></a>00570                         }
<a name="l00571"></a>00571                         <span class="keywordflow">return</span> $result-&gt;WebLoginKey;
<a name="l00572"></a>00572                 }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 <span class="preprocessor">#endregion</span>
<a name="l00575"></a>00575 <span class="preprocessor"></span>
<a name="l00576"></a>00576 <span class="preprocessor">#region Email</span>
<a name="l00577"></a>00577 <span class="preprocessor"></span>
<a name="l00579"></a>00579 
<a name="l00584"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aec2d84fbdf2fcab6efb2984d8f604fdb">00584</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aec2d84fbdf2fcab6efb2984d8f604fdb" title="Save email address, set user level to zero.">SaveEmail</a>($uuid, $email){
<a name="l00585"></a>00585                         <span class="keywordflow">if</span>($uuid instanceof User){
<a name="l00586"></a>00586                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l00587"></a>00587                         }
<a name="l00588"></a>00588 
<a name="l00589"></a>00589                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00590"></a>00590                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l00591"></a>00591                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid)!== 1){
<a name="l00592"></a>00592                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID was not a valid UUID.&#39;</span>);
<a name="l00593"></a>00593                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($email) === <span class="keyword">false</span>){
<a name="l00594"></a>00594                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Email address must be a string.&#39;</span>);
<a name="l00595"></a>00595                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_email($email) === <span class="keyword">false</span>){
<a name="l00596"></a>00596                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Email address was not valid.&#39;</span>);
<a name="l00597"></a>00597                         }
<a name="l00598"></a>00598 
<a name="l00599"></a>00599                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;SaveEmail&#39;</span>, array(<span class="stringliteral">&#39;UUID&#39;</span> =&gt; $uuid, <span class="stringliteral">&#39;Email&#39;</span> =&gt; $email), array(
<a name="l00600"></a>00600                                 <span class="stringliteral">&#39;Verified&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00601"></a>00601                         ));
<a name="l00602"></a>00602 
<a name="l00603"></a>00603                         <span class="keywordflow">return</span> $result-&gt;Verified;
<a name="l00604"></a>00604                 }
<a name="l00605"></a>00605 
<a name="l00607"></a>00607 
<a name="l00612"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a3fe21c8e01296bf1b3eaff9986c48b68">00612</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a3fe21c8e01296bf1b3eaff9986c48b68" title="Confirm the account name and email address (used by forgotten password activities)">ConfirmUserEmailName</a>($name, $email){
<a name="l00613"></a>00613                         <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">true</span>){
<a name="l00614"></a>00614                                 $name = trim($name);
<a name="l00615"></a>00615                         }
<a name="l00616"></a>00616 
<a name="l00617"></a>00617                         <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">false</span>){
<a name="l00618"></a>00618                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Name must be a string.&#39;</span>);
<a name="l00619"></a>00619                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($name === <span class="stringliteral">&#39;&#39;</span>){
<a name="l00620"></a>00620                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Name cannot be an empty string.&#39;</span>);
<a name="l00621"></a>00621                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($email) === <span class="keyword">false</span>){
<a name="l00622"></a>00622                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Email address must be a string.&#39;</span>);
<a name="l00623"></a>00623                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_email($email) === <span class="keyword">false</span>){
<a name="l00624"></a>00624                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Email address is invalid.&#39;</span>);
<a name="l00625"></a>00625                         }
<a name="l00626"></a>00626 
<a name="l00627"></a>00627                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;ConfirmUserEmailName&#39;</span>, array(<span class="stringliteral">&#39;Name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;Email&#39;</span> =&gt; $email), array(
<a name="l00628"></a>00628                                 <span class="stringliteral">&#39;Verified&#39;</span>=&gt;array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00629"></a>00629                         ));
<a name="l00630"></a>00630                         <span class="keywordflow">if</span>(isset($result-&gt;ErrorCode) === <span class="keyword">true</span> &amp;&amp; is_integer($result-&gt;ErrorCode) === <span class="keyword">false</span>){
<a name="l00631"></a>00631                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful but required response property was of unexpected type.&#39;</span>,2);
<a name="l00632"></a>00632                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($result-&gt;ErrorCode) === <span class="keyword">true</span>){
<a name="l00633"></a>00633                                 <span class="keywordflow">if</span>($result-&gt;ErrorCode === 1){
<a name="l00634"></a>00634                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;No account was found with the specified name.&#39;</span>);
<a name="l00635"></a>00635                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($result-&gt;ErrorCode === 2){
<a name="l00636"></a>00636                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;The specified account is disabled.&#39;</span>);
<a name="l00637"></a>00637                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($result-&gt;ErrorCode === 3){
<a name="l00638"></a>00638                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;The specified email address does not match the email address associated with the specified account.&#39;</span>);
<a name="l00639"></a>00639                                 }<span class="keywordflow">else</span>{
<a name="l00640"></a>00640                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Unknown error occurred when checking email address of specified account.&#39;</span>);
<a name="l00641"></a>00641                                 }
<a name="l00642"></a>00642                         }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644                         <span class="keywordflow">return</span> $result-&gt;Verified;
<a name="l00645"></a>00645                 }
<a name="l00646"></a>00646 
<a name="l00647"></a>00647 <span class="preprocessor">#endregion</span>
<a name="l00648"></a>00648 <span class="preprocessor"></span>
<a name="l00649"></a>00649 <span class="preprocessor">#region password</span>
<a name="l00650"></a>00650 <span class="preprocessor"></span>
<a name="l00652"></a>00652 
<a name="l00657"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a5095dc2ab223ae8ef9657bac8b32fae8">00657</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a5095dc2ab223ae8ef9657bac8b32fae8" title="Change password.">ChangePassword</a>($uuid, $oldPassword, $newPassword){
<a name="l00658"></a>00658                         <span class="keywordflow">if</span>($uuid instanceof User){
<a name="l00659"></a>00659                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l00660"></a>00660                         }
<a name="l00661"></a>00661 
<a name="l00662"></a>00662                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00663"></a>00663                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l00664"></a>00664                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l00665"></a>00665                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID was not a valid UUID.&#39;</span>);
<a name="l00666"></a>00666                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($oldPassword) === <span class="keyword">false</span>){
<a name="l00667"></a>00667                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Old password must be a string.&#39;</span>);
<a name="l00668"></a>00668                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($newPassword) === <span class="keyword">false</span>){
<a name="l00669"></a>00669                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;New password must be a string.&#39;</span>);
<a name="l00670"></a>00670                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(trim($newPassword) === <span class="stringliteral">&#39;&#39;</span>){
<a name="l00671"></a>00671                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;New password cannot be an empty string.&#39;</span>);
<a name="l00672"></a>00672                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strlen($newPassword) &lt; 8){
<a name="l00673"></a>00673                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1LengthException.html" title="Addon-specific LengthException.">LengthException</a>(<span class="stringliteral">&#39;New password cannot be less than 8 characters long.&#39;</span>);
<a name="l00674"></a>00674                         }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;ChangePassword&#39;</span>, array(
<a name="l00677"></a>00677                                 <span class="stringliteral">&#39;UUID&#39;</span>        =&gt; $uuid,
<a name="l00678"></a>00678                                 <span class="stringliteral">&#39;Password&#39;</span>    =&gt; <span class="stringliteral">&#39;$1$&#39;</span> . (substr($oldPassword, 0, 3) === <span class="stringliteral">&#39;$1$&#39;</span> ? substr($oldPassword, 3) : md5($oldPassword)),
<a name="l00679"></a>00679                                 <span class="stringliteral">&#39;NewPassword&#39;</span> =&gt; <span class="stringliteral">&#39;$1$&#39;</span> . (substr($newPassword, 0, 3) === <span class="stringliteral">&#39;$1$&#39;</span> ? substr($newPassword, 3) : md5($newPassword))
<a name="l00680"></a>00680                         ), array(
<a name="l00681"></a>00681                                 <span class="stringliteral">&#39;Verified&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00682"></a>00682                         ))-&gt;Verified;
<a name="l00683"></a>00683                 }
<a name="l00684"></a>00684 
<a name="l00686"></a>00686 
<a name="l00690"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aa586fc27bb8224bf27b3b4e5ebe6aa76">00690</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aa586fc27bb8224bf27b3b4e5ebe6aa76" title="Change password without old password.">ForgotPassword</a>($uuid, $newPassword){
<a name="l00691"></a>00691                         <span class="keywordflow">if</span>($uuid instanceof User){
<a name="l00692"></a>00692                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l00693"></a>00693                         }
<a name="l00694"></a>00694 
<a name="l00695"></a>00695                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00696"></a>00696                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l00697"></a>00697                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l00698"></a>00698                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID was not a valid UUID.&#39;</span>);
<a name="l00699"></a>00699                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($newPassword) === <span class="keyword">false</span>){
<a name="l00700"></a>00700                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;New password must be a string.&#39;</span>);
<a name="l00701"></a>00701                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(trim($newPassword) === <span class="stringliteral">&#39;&#39;</span>){
<a name="l00702"></a>00702                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;New password cannot be an empty string.&#39;</span>);
<a name="l00703"></a>00703                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strlen($newPassword) &lt; 8){
<a name="l00704"></a>00704                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1LengthException.html" title="Addon-specific LengthException.">LengthException</a>(<span class="stringliteral">&#39;New password cannot be less than 8 characters long.&#39;</span>);
<a name="l00705"></a>00705                         }
<a name="l00706"></a>00706 
<a name="l00707"></a>00707                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;ForgotPassword&#39;</span>, array(
<a name="l00708"></a>00708                                 <span class="stringliteral">&#39;UUID&#39;</span>        =&gt; $uuid,
<a name="l00709"></a>00709                                 <span class="stringliteral">&#39;Password&#39;</span> =&gt; <span class="stringliteral">&#39;$1$&#39;</span> . (substr($newPassword, 0, 3) === <span class="stringliteral">&#39;$1$&#39;</span> ? substr($newPassword, 3) : md5($newPassword))
<a name="l00710"></a>00710                         ), array(
<a name="l00711"></a>00711                                 <span class="stringliteral">&#39;Verified&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00712"></a>00712                         ))-&gt;Verified;
<a name="l00713"></a>00713                 }
<a name="l00714"></a>00714 
<a name="l00715"></a>00715 <span class="preprocessor">#endregion</span>
<a name="l00716"></a>00716 <span class="preprocessor"></span>
<a name="l00718"></a>00718 
<a name="l00722"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#acd96e47d6305504030c3b3da78202ff0">00722</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#acd96e47d6305504030c3b3da78202ff0" title="Change account name.">ChangeName</a>($uuid, $name){
<a name="l00723"></a>00723                         <span class="keywordflow">if</span>($uuid instanceof User){
<a name="l00724"></a>00724                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l00725"></a>00725                         }
<a name="l00726"></a>00726                         <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">true</span>){
<a name="l00727"></a>00727                                 $name = trim($name);
<a name="l00728"></a>00728                         }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00731"></a>00731                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l00732"></a>00732                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid)!== 1){
<a name="l00733"></a>00733                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID was not a valid UUID.&#39;</span>);
<a name="l00734"></a>00734                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">false</span>){
<a name="l00735"></a>00735                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Name must be a string.&#39;</span>);
<a name="l00736"></a>00736                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($name === <span class="stringliteral">&#39;&#39;</span>){
<a name="l00737"></a>00737                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Name cannot be an empty string.&#39;</span>);
<a name="l00738"></a>00738                         }
<a name="l00739"></a>00739 
<a name="l00740"></a>00740                         <span class="keywordflow">if</span>($this-&gt;GetGridUserInfo($uuid)-&gt;Name() === $name){ <span class="comment">// if the name is already the same, we&#39;re not going to bother making the call.</span>
<a name="l00741"></a>00741                                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00742"></a>00742                         }
<a name="l00743"></a>00743 
<a name="l00744"></a>00744                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;ChangeName&#39;</span>, array(<span class="stringliteral">&#39;UUID&#39;</span> =&gt; $uuid, <span class="stringliteral">&#39;Name&#39;</span> =&gt; $name), array(
<a name="l00745"></a>00745                                 <span class="stringliteral">&#39;Verified&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l00746"></a>00746                                 <span class="stringliteral">&#39;Stored&#39;</span>   =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00747"></a>00747                         ));
<a name="l00748"></a>00748                         <span class="keywordflow">if</span>($result-&gt;Verified === <span class="keyword">true</span> &amp;&amp; $result-&gt;Stored === <span class="keyword">false</span>){
<a name="l00749"></a>00749                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1RuntimeException.html" title="Addon-specific RuntimeException.">RuntimeException</a>(<span class="stringliteral">&#39;Call to API was successful, but name change was not stored by the server.&#39;</span>);
<a name="l00750"></a>00750                         }
<a name="l00751"></a>00751 
<a name="l00752"></a>00752                         <span class="keywordflow">return</span> $result-&gt;Verified;
<a name="l00753"></a>00753                 }
<a name="l00754"></a>00754 
<a name="l00756"></a>00756 
<a name="l00765"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a695d2d71af550c97b29fbc9306c96f15">00765</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a695d2d71af550c97b29fbc9306c96f15" title="Attempt to edit the account name, email address and real-life info.">EditUser</a>($uuid, $name=null, $email=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\RLInfo $RLInfo=null, $userLevel=null){
<a name="l00766"></a>00766                         <span class="keywordflow">if</span>($uuid instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser){
<a name="l00767"></a>00767                                 <span class="keywordflow">if</span>(is_null($name) === <span class="keyword">true</span>){
<a name="l00768"></a>00768                                         $name = $uuid-&gt;Name();
<a name="l00769"></a>00769                                 }
<a name="l00770"></a>00770                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l00771"></a>00771                         }
<a name="l00772"></a>00772                         <span class="keywordflow">if</span>(is_string($name)){
<a name="l00773"></a>00773                                 $name = trim($name);
<a name="l00774"></a>00774                         }
<a name="l00775"></a>00775                         <span class="keywordflow">if</span>(is_string($email)){
<a name="l00776"></a>00776                                 $email = trim($email);
<a name="l00777"></a>00777                         }
<a name="l00778"></a>00778                         <span class="keywordflow">if</span>(isset($userLevel) === <span class="keyword">true</span> &amp;&amp; is_string($userLevel) === <span class="keyword">true</span> &amp;&amp; ctype_digit($userLevel) === <span class="keyword">true</span>){
<a name="l00779"></a>00779                                 $userLevel = (integer)$userLevel;
<a name="l00780"></a>00780                         }
<a name="l00781"></a>00781 
<a name="l00782"></a>00782                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00783"></a>00783                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l00784"></a>00784                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) === <span class="keyword">false</span>){
<a name="l00785"></a>00785                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID was not a valid UUID.&#39;</span>);
<a name="l00786"></a>00786                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">false</span>){
<a name="l00787"></a>00787                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Name must be a string.&#39;</span>);
<a name="l00788"></a>00788                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($name === <span class="stringliteral">&#39;&#39;</span>){
<a name="l00789"></a>00789                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Account name cannot be an empty string.&#39;</span>);
<a name="l00790"></a>00790                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($email) === <span class="keyword">false</span>){
<a name="l00791"></a>00791                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Email address must be a string.&#39;</span>);
<a name="l00792"></a>00792                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($email !== <span class="stringliteral">&#39;&#39;</span> &amp;&amp; is_email($email) === <span class="keyword">false</span>){
<a name="l00793"></a>00793                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Email address was not valid.&#39;</span>);
<a name="l00794"></a>00794                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($userLevel) === <span class="keyword">true</span> &amp;&amp; is_integer($userLevel) === <span class="keyword">false</span>){
<a name="l00795"></a>00795                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;User Level must be specified as integer.&#39;</span>);
<a name="l00796"></a>00796                         }
<a name="l00797"></a>00797 
<a name="l00798"></a>00798                         $data = array(
<a name="l00799"></a>00799                                 <span class="stringliteral">&#39;UserID&#39;</span> =&gt; $uuid,
<a name="l00800"></a>00800                                 <span class="stringliteral">&#39;Name&#39;</span>   =&gt; $name,
<a name="l00801"></a>00801                                 <span class="stringliteral">&#39;Email&#39;</span>  =&gt; $email
<a name="l00802"></a>00802                         );
<a name="l00803"></a>00803                         <span class="keywordflow">if</span>($RLInfo instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\RLInfo){
<a name="l00804"></a>00804                                 <span class="keywordflow">foreach</span>($RLInfo as $k=&gt;$v){
<a name="l00805"></a>00805                                         $data[$k] = $v;
<a name="l00806"></a>00806                                 }
<a name="l00807"></a>00807                         }
<a name="l00808"></a>00808                         <span class="keywordflow">if</span>(isset($userLevel) === <span class="keyword">true</span>){
<a name="l00809"></a>00809                                 $data[<span class="stringliteral">&#39;UserLevel&#39;</span>] = $userLevel;
<a name="l00810"></a>00810                         }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;EditUser&#39;</span>, $data, array(
<a name="l00813"></a>00813                                 <span class="stringliteral">&#39;agent&#39;</span>   =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l00814"></a>00814                                 <span class="stringliteral">&#39;account&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l00815"></a>00815                         ));
<a name="l00816"></a>00816 
<a name="l00817"></a>00817                         <span class="keywordflow">return</span> ($result-&gt;agent &amp;&amp; $result-&gt;account);
<a name="l00818"></a>00818                 }
<a name="l00819"></a>00819 
<a name="l00821"></a>00821 
<a name="l00824"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a1be7d290d18f4c1f967b46d43babeda1">00824</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a1be7d290d18f4c1f967b46d43babeda1" title="Attempt to reset the user&#39;s avatar.">ResetAvatar</a>($uuid){
<a name="l00825"></a>00825                         <span class="keywordflow">if</span>($uuid instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser){
<a name="l00826"></a>00826                                 <span class="keywordflow">if</span>(is_null($name) === <span class="keyword">true</span>){
<a name="l00827"></a>00827                                         $name = $uuid-&gt;Name();
<a name="l00828"></a>00828                                 }
<a name="l00829"></a>00829                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l00830"></a>00830                         }
<a name="l00831"></a>00831 
<a name="l00832"></a>00832                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00833"></a>00833                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l00834"></a>00834                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) === <span class="keyword">false</span>){
<a name="l00835"></a>00835                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID was not a valid UUID.&#39;</span>);
<a name="l00836"></a>00836                         }
<a name="l00837"></a>00837 
<a name="l00838"></a>00838                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;ResetAvatar&#39;</span>, array(
<a name="l00839"></a>00839                                 <span class="stringliteral">&#39;User&#39;</span> =&gt; $uuid
<a name="l00840"></a>00840                         ), array(
<a name="l00841"></a>00841                                 <span class="stringliteral">&#39;Success&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span> =&gt; array())
<a name="l00842"></a>00842                         ))-&gt;Success;
<a name="l00843"></a>00843                 }
<a name="l00844"></a>00844 
<a name="l00845"></a>00845 <span class="preprocessor">#endregion</span>
<a name="l00846"></a>00846 <span class="preprocessor"></span>
<a name="l00847"></a>00847 <span class="preprocessor">#region Users</span>
<a name="l00848"></a>00848 <span class="preprocessor"></span>
<a name="l00850"></a>00850 
<a name="l00856"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a7b142edf7eb5ae1084f97d7010cc7f32">00856</a>                 <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a7b142edf7eb5ae1084f97d7010cc7f32" title="Validator array to be used with Aurora::Addon::WebUI::makeCallToAPI()">GridUserInfoValidator</a>(){
<a name="l00857"></a>00857                         <span class="keyword">static</span> $validator = array(
<a name="l00858"></a>00858                                 <span class="stringliteral">&#39;UUID&#39;</span>              =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00859"></a>00859                                 <span class="stringliteral">&#39;HomeUUID&#39;</span>          =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00860"></a>00860                                 <span class="stringliteral">&#39;HomeName&#39;</span>          =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00861"></a>00861                                 <span class="stringliteral">&#39;CurrentRegionUUID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00862"></a>00862                                 <span class="stringliteral">&#39;CurrentRegionName&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00863"></a>00863                                 <span class="stringliteral">&#39;Online&#39;</span>            =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l00864"></a>00864                                 <span class="stringliteral">&#39;Email&#39;</span>             =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00865"></a>00865                                 <span class="stringliteral">&#39;Name&#39;</span>              =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00866"></a>00866                                 <span class="stringliteral">&#39;FirstName&#39;</span>         =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00867"></a>00867                                 <span class="stringliteral">&#39;LastName&#39;</span>          =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l00868"></a>00868                                 <span class="stringliteral">&#39;LastLogin&#39;</span>         =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array(<span class="keyword">false</span>), <span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l00869"></a>00869                                 <span class="stringliteral">&#39;LastLogout&#39;</span>        =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array(<span class="keyword">false</span>), <span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l00870"></a>00870                         );
<a name="l00871"></a>00871                         <span class="keywordflow">return</span> $validator;
<a name="l00872"></a>00872                 }
<a name="l00873"></a>00873 
<a name="l00875"></a>00875 
<a name="l00879"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a04df4e0d1c21d0853c42510744bc42cd">00879</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a04df4e0d1c21d0853c42510744bc42cd" title="Get the GetGridUserInfo for the specified user.">GetGridUserInfo</a>($uuid){
<a name="l00880"></a>00880                         <span class="keywordflow">if</span>($uuid instanceof User){
<a name="l00881"></a>00881                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l00882"></a>00882                         }
<a name="l00883"></a>00883                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00884"></a>00884                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID should be a string.&#39;</span>);
<a name="l00885"></a>00885                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l00886"></a>00886                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID supplied was not a valid UUID.&#39;</span>);
<a name="l00887"></a>00887                         }
<a name="l00888"></a>00888                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetGridUserInfo&#39;</span>, array(<span class="stringliteral">&#39;UUID&#39;</span>=&gt;$uuid), static::GridUserInfoValidator());
<a name="l00889"></a>00889                         <span class="comment">// this is where we get lazy and leave validation up to the GridUserInfo class.</span>
<a name="l00890"></a>00890                         <span class="keywordflow">return</span>  WebUI\GridUserInfo::r(
<a name="l00891"></a>00891                                 $result-&gt;UUID,
<a name="l00892"></a>00892                                 $result-&gt;Name,
<a name="l00893"></a>00893                                 $result-&gt;HomeUUID,
<a name="l00894"></a>00894                                 $result-&gt;HomeName,
<a name="l00895"></a>00895                                 $result-&gt;CurrentRegionUUID,
<a name="l00896"></a>00896                                 $result-&gt;CurrentRegionName,
<a name="l00897"></a>00897                                 $result-&gt;Online,
<a name="l00898"></a>00898                                 $result-&gt;Email,
<a name="l00899"></a>00899                                 $result-&gt;LastLogin === <span class="keyword">false</span> ? null : $result-&gt;LastLogin,
<a name="l00900"></a>00900                                 $result-&gt;LastLogout === <span class="keyword">false</span> ? null : $result-&gt;LastLogout
<a name="l00901"></a>00901                         );
<a name="l00902"></a>00902                 }
<a name="l00903"></a>00903 
<a name="l00905"></a>00905 
<a name="l00911"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a16235f89e688819e5cdbc4c87aff2b10">00911</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a16235f89e688819e5cdbc4c87aff2b10" title="Attempt to get the profile object for the specified user.">GetProfile</a>($name=<span class="stringliteral">&#39;&#39;</span>, $uuid=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>){
<a name="l00912"></a>00912                         <span class="keywordflow">if</span>($name instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser){
<a name="l00913"></a>00913                                 $uuid = $name-&gt;PrincipalID();
<a name="l00914"></a>00914                                 $name = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00915"></a>00915                         }
<a name="l00916"></a>00916                         <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">false</span>){
<a name="l00917"></a>00917                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Account name must be a string.&#39;</span>);
<a name="l00918"></a>00918                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l00919"></a>00919                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Account UUID must be a string.&#39;</span>);
<a name="l00920"></a>00920                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l00921"></a>00921                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Account UUID was not a valid UUID.&#39;</span>);
<a name="l00922"></a>00922                         }
<a name="l00923"></a>00923 
<a name="l00924"></a>00924                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetProfile&#39;</span>, array(<span class="stringliteral">&#39;Name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;UUID&#39;</span> =&gt; $uuid), array(
<a name="l00925"></a>00925                                 <span class="stringliteral">&#39;account&#39;</span>=&gt; array(<span class="stringliteral">&#39;object&#39;</span>=&gt;array(array(
<a name="l00926"></a>00926                                         <span class="stringliteral">&#39;Created&#39;</span>          =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l00927"></a>00927                                         <span class="stringliteral">&#39;Name&#39;</span>             =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l00928"></a>00928                                         <span class="stringliteral">&#39;PrincipalID&#39;</span>      =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l00929"></a>00929                                         <span class="stringliteral">&#39;Email&#39;</span>            =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l00930"></a>00930                                         <span class="stringliteral">&#39;TimeSinceCreated&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l00931"></a>00931                                         <span class="stringliteral">&#39;UserLevel&#39;</span>        =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l00932"></a>00932                                 )))
<a name="l00933"></a>00933                         ));
<a name="l00934"></a>00934 
<a name="l00935"></a>00935                         $account = $result-&gt;account;
<a name="l00936"></a>00936 
<a name="l00937"></a>00937                         $allowPublish = $maturePublish  = $visible     = <span class="keyword">false</span>;
<a name="l00938"></a>00938                         $wantToMask   = $canDoMask      = 0;
<a name="l00939"></a>00939                         $wantToText   = $canDoText      = $languages   = $aboutText = $firstLifeAboutText = $webURL = $displayName = $customType = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00940"></a>00940                         $image        = $firstLifeImage = <span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>;
<a name="l00941"></a>00941                         $notes        = json_encode(<span class="stringliteral">&#39;&#39;</span>);
<a name="l00942"></a>00942                         $userLevel    = $account-&gt;UserLevel;
<a name="l00943"></a>00943                         <span class="keywordflow">if</span>(isset($result-&gt;profile) === <span class="keyword">true</span>){
<a name="l00944"></a>00944                                 $profile = $result-&gt;profile;
<a name="l00945"></a>00945                                 <span class="keywordflow">if</span>(isset(
<a name="l00946"></a>00946                                         $profile-&gt;AllowPublish, $profile-&gt;MaturePublish, $profile-&gt;Visible,
<a name="l00947"></a>00947                                         $profile-&gt;WantToMask, $profile-&gt;CanDoMask,
<a name="l00948"></a>00948                                         $profile-&gt;WantToText, $profile-&gt;CanDoText, $profile-&gt;Languages, $profile-&gt;AboutText, $profile-&gt;FirstLifeAboutText, $profile-&gt;WebURL, $profile-&gt;DisplayName, $profile-&gt;CustomType,
<a name="l00949"></a>00949                                         $profile-&gt;Image, $profile-&gt;FirstLifeImage,
<a name="l00950"></a>00950                                         $profile-&gt;Notes
<a name="l00951"></a>00951                                 ) === <span class="keyword">false</span>){
<a name="l00952"></a>00952                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but optional response properties were missing.&#39;</span>);
<a name="l00953"></a>00953                                 }
<a name="l00954"></a>00954 
<a name="l00955"></a>00955                                 $allowPublish       = $profile-&gt;AllowPublish;
<a name="l00956"></a>00956                                 $maturePublish      = $profile-&gt;MaturePublish;
<a name="l00957"></a>00957                                 $visible            = $profile-&gt;Visible;
<a name="l00958"></a>00958                                 $wantToMask         = $profile-&gt;WantToMask;
<a name="l00959"></a>00959                                 $canDoMask          = $profile-&gt;CanDoMask;
<a name="l00960"></a>00960                                 $wantToText         = $profile-&gt;WantToText;
<a name="l00961"></a>00961                                 $canDoText          = $profile-&gt;CanDoText;
<a name="l00962"></a>00962                                 $languages          = $profile-&gt;Languages;
<a name="l00963"></a>00963                                 $aboutText          = $profile-&gt;AboutText;
<a name="l00964"></a>00964                                 $firstLifeAboutText = $profile-&gt;FirstLifeAboutText;
<a name="l00965"></a>00965                                 $webURL             = $profile-&gt;WebURL;
<a name="l00966"></a>00966                                 $displayName        = $profile-&gt;DisplayName;
<a name="l00967"></a>00967                                 $customType         = $profile-&gt;CustomType;
<a name="l00968"></a>00968                                 $image              = $profile-&gt;Image;
<a name="l00969"></a>00969                                 $firstLifeImage     = $profile-&gt;FirstLifeImage;
<a name="l00970"></a>00970                                 $notes              = $profile-&gt;Notes;
<a name="l00971"></a>00971                         }
<a name="l00972"></a>00972 
<a name="l00973"></a>00973                         $RLName = $RLAddress = $RLZip = $RLCity = $RLCountry = null;
<a name="l00974"></a>00974                         <span class="keywordflow">if</span>(isset($result-&gt;agent) === <span class="keyword">true</span>){
<a name="l00975"></a>00975                                 $agent = $result-&gt;agent;
<a name="l00976"></a>00976                                 $properties = array(
<a name="l00977"></a>00977                                         <span class="stringliteral">&#39;RLName&#39;</span>,
<a name="l00978"></a>00978                                         <span class="stringliteral">&#39;RLAddress&#39;</span>,
<a name="l00979"></a>00979                                         <span class="stringliteral">&#39;RLZip&#39;</span>,
<a name="l00980"></a>00980                                         <span class="stringliteral">&#39;RLCity&#39;</span>,
<a name="l00981"></a>00981                                         <span class="stringliteral">&#39;RLCountry&#39;</span>
<a name="l00982"></a>00982                                 );
<a name="l00983"></a>00983                                 <span class="keywordflow">foreach</span>($properties as $v){
<a name="l00984"></a>00984                                         <span class="keywordflow">if</span>(property_exists($result-&gt;agent, $v) === <span class="keyword">false</span>){
<a name="l00985"></a>00985                                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but optional response properties were missing.&#39;</span>);
<a name="l00986"></a>00986                                         }
<a name="l00987"></a>00987                                 }
<a name="l00988"></a>00988 
<a name="l00989"></a>00989                                 $RLName    = $agent-&gt;RLName;
<a name="l00990"></a>00990                                 $RLAddress = $agent-&gt;RLAddress;
<a name="l00991"></a>00991                                 $RLZip     = $agent-&gt;RLZip;
<a name="l00992"></a>00992                                 $RLCity    = $agent-&gt;RLCity;
<a name="l00993"></a>00993                                 $RLCountry = $agent-&gt;RLCountry;
<a name="l00994"></a>00994                         }
<a name="l00995"></a>00995                         <span class="keywordflow">return</span> WebUI\UserProfile::r($account-&gt;PrincipalID, $account-&gt;Name, $account-&gt;Email, $account-&gt;Created, $allowPublish, $maturePublish, $wantToMask, $wantToText, $canDoMask, $canDoText, $languages, $image, $aboutText, $firstLifeImage, $firstLifeAboutText, $webURL, $displayName, isset($account-&gt;PartnerUUID) ? $account-&gt;PartnerUUID : <span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>, $visible, $customType, $notes, $userLevel, $RLName, $RLAddress, $RLZip, $RLCity, $RLCountry);
<a name="l00996"></a>00996                 }
<a name="l00997"></a>00997 
<a name="l00999"></a>00999 
<a name="l01004"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#abd0b4b2067816a304b49250ca7e92747">01004</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#abd0b4b2067816a304b49250ca7e92747" title="Attempt to delete the user.">DeleteUser</a>($uuid){
<a name="l01005"></a>01005                         <span class="keywordflow">if</span>($uuid instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser){
<a name="l01006"></a>01006                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l01007"></a>01007                         }
<a name="l01008"></a>01008                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">true</span>){
<a name="l01009"></a>01009                                 $uuid = trim($uuid);
<a name="l01010"></a>01010                         }
<a name="l01011"></a>01011 
<a name="l01012"></a>01012                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l01013"></a>01013                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l01014"></a>01014                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) === <span class="keyword">false</span>){
<a name="l01015"></a>01015                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID was not a valid UUID.&#39;</span>);
<a name="l01016"></a>01016                         }
<a name="l01017"></a>01017 
<a name="l01018"></a>01018                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;DeleteUser&#39;</span>, array(<span class="stringliteral">&#39;UserID&#39;</span> =&gt; $uuid), array(
<a name="l01019"></a>01019                                 <span class="stringliteral">&#39;Finished&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l01020"></a>01020                         ));
<a name="l01021"></a>01021 
<a name="l01022"></a>01022                         <span class="keywordflow">return</span> $result-&gt;Finished;
<a name="l01023"></a>01023                 }
<a name="l01024"></a>01024 
<a name="l01026"></a>01026 
<a name="l01032"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ac9e3a38cd0b8e6d9bddba1f1967bfd3a">01032</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ac9e3a38cd0b8e6d9bddba1f1967bfd3a" title="Set the home location for the specified user.">SetHomeLocation</a>($uuid, \Aurora\Services\Interfaces\GridRegion $region=null, \OpenMetaverse\Vector3 $position=null, \OpenMetaverse\Vector3 $lookAt=null){
<a name="l01033"></a>01033                         <span class="keywordflow">if</span>($uuid instanceof User){
<a name="l01034"></a>01034                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l01035"></a>01035                         }
<a name="l01036"></a>01036                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l01037"></a>01037                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID should be a string.&#39;</span>);
<a name="l01038"></a>01038                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l01039"></a>01039                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID supplied was not a valid UUID.&#39;</span>);
<a name="l01040"></a>01040                         }
<a name="l01041"></a>01041 
<a name="l01042"></a>01042                         $input = array(
<a name="l01043"></a>01043                                 <span class="stringliteral">&#39;User&#39;</span> =&gt; $uuid
<a name="l01044"></a>01044                         );
<a name="l01045"></a>01045                         <span class="keywordflow">if</span>(isset($region) === <span class="keyword">true</span>){
<a name="l01046"></a>01046                                 $input[<span class="stringliteral">&#39;RegionID&#39;</span>] = $region-&gt;RegionID();
<a name="l01047"></a>01047                         }
<a name="l01048"></a>01048                         <span class="keywordflow">if</span>(isset($position) === <span class="keyword">true</span>){
<a name="l01049"></a>01049                                 $input[<span class="stringliteral">&#39;Position&#39;</span>] = (string)$position;
<a name="l01050"></a>01050                         }
<a name="l01051"></a>01051                         <span class="keywordflow">if</span>(isset($lookAt) === <span class="keyword">true</span>){
<a name="l01052"></a>01052                                 $input[<span class="stringliteral">&#39;LookAt&#39;</span>] = (string)$lookAt;
<a name="l01053"></a>01053                         }
<a name="l01054"></a>01054 
<a name="l01055"></a>01055                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;SetHomeLocation&#39;</span>, $input, array(
<a name="l01056"></a>01056                                 <span class="stringliteral">&#39;Success&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span> =&gt; array())
<a name="l01057"></a>01057                         ))-&gt;Success;
<a name="l01058"></a>01058                 }
<a name="l01059"></a>01059 
<a name="l01060"></a>01060 <span class="preprocessor">#region banning</span>
<a name="l01061"></a>01061 <span class="preprocessor"></span>
<a name="l01063"></a>01063 
<a name="l01070"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad19a31f0fa2070027e66c183669ed800">01070</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad19a31f0fa2070027e66c183669ed800" title="Attempts to ban a user permanently or temporarily.">BanUser</a>($uuid, $until=null){
<a name="l01071"></a>01071                         <span class="keywordflow">if</span>($uuid instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser){
<a name="l01072"></a>01072                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l01073"></a>01073                         }
<a name="l01074"></a>01074                         <span class="keywordflow">if</span>($until instanceof DateTime){
<a name="l01075"></a>01075                                 $until = $until-&gt;format(<span class="charliteral">&#39;c&#39;</span>);
<a name="l01076"></a>01076                         }
<a name="l01077"></a>01077 
<a name="l01078"></a>01078                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l01079"></a>01079                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l01080"></a>01080                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l01081"></a>01081                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID was not a valid UUID.&#39;</span>);
<a name="l01082"></a>01082                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($until) === <span class="keyword">true</span>){
<a name="l01083"></a>01083                                 <span class="keywordflow">if</span>(is_string($until) === <span class="keyword">false</span>){
<a name="l01084"></a>01084                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;temporary ban date must be a string.&#39;</span>);
<a name="l01085"></a>01085                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(strtotime($until) === <span class="keyword">false</span>){
<a name="l01086"></a>01086                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;temporary ban date must be a valid date.&#39;</span>);
<a name="l01087"></a>01087                                 }
<a name="l01088"></a>01088                         }
<a name="l01089"></a>01089 
<a name="l01090"></a>01090                         $result = $this-&gt;makeCallToAPI(isset($until) ? <span class="stringliteral">&#39;TempBanUser&#39;</span> : <span class="stringliteral">&#39;BanUser&#39;</span>, array(<span class="stringliteral">&#39;UserID&#39;</span> =&gt; $uuid, <span class="stringliteral">&#39;BannedUntil&#39;</span> =&gt; $until), array(
<a name="l01091"></a>01091                                 <span class="stringliteral">&#39;Finished&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l01092"></a>01092                         ));
<a name="l01093"></a>01093 
<a name="l01094"></a>01094                         <span class="keywordflow">return</span> $result-&gt;Finished;
<a name="l01095"></a>01095                 }
<a name="l01096"></a>01096 
<a name="l01098"></a>01098 
<a name="l01106"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aad1846e80e3ca412363c83dfa92e51ee">01106</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aad1846e80e3ca412363c83dfa92e51ee" title="Attempts to temporarily ban a user.">TempBanUser</a>($uuid, $until){
<a name="l01107"></a>01107                         <span class="keywordflow">if</span>(isset($until) === <span class="keyword">false</span>){
<a name="l01108"></a>01108                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Temporary ban time must be specified.&#39;</span>);
<a name="l01109"></a>01109                         }
<a name="l01110"></a>01110 
<a name="l01111"></a>01111                         <span class="keywordflow">return</span> $this-&gt;BanUser($uuid, $until);
<a name="l01112"></a>01112                 }
<a name="l01113"></a>01113 
<a name="l01115"></a>01115 
<a name="l01120"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a98002344edb3c59e0e61a73bf8dff082">01120</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a98002344edb3c59e0e61a73bf8dff082" title="Attempts to unban a user.">UnBanUser</a>($uuid){
<a name="l01121"></a>01121                         <span class="keywordflow">if</span>($uuid instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser){
<a name="l01122"></a>01122                                 $uuid = $uuid-&gt;PrincipalID();
<a name="l01123"></a>01123                         }
<a name="l01124"></a>01124 
<a name="l01125"></a>01125                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l01126"></a>01126                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a string.&#39;</span>);
<a name="l01127"></a>01127                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l01128"></a>01128                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;UUID must be a valid UUID.&#39;</span>);
<a name="l01129"></a>01129                         }
<a name="l01130"></a>01130 
<a name="l01131"></a>01131                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;UnBanUser&#39;</span>, array(<span class="stringliteral">&#39;UserID&#39;</span> =&gt; $uuid), array(
<a name="l01132"></a>01132                                 <span class="stringliteral">&#39;Finished&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l01133"></a>01133                         ));
<a name="l01134"></a>01134 
<a name="l01135"></a>01135                         <span class="keywordflow">return</span> $result-&gt;Finished;
<a name="l01136"></a>01136                 }
<a name="l01137"></a>01137 
<a name="l01138"></a>01138 <span class="preprocessor">#endregion</span>
<a name="l01139"></a>01139 <span class="preprocessor"></span>
<a name="l01141"></a>01141 
<a name="l01148"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad9af227a26715cdfa9b84a93c6d35c04">01148</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad9af227a26715cdfa9b84a93c6d35c04" title="Attempt to search for users.">FindUsers</a>($query=<span class="stringliteral">&#39;&#39;</span>, $start=0, $count=25, $asArray=<span class="keyword">false</span>){
<a name="l01149"></a>01149                         <span class="keywordflow">if</span>(is_string($start) === <span class="keyword">true</span> &amp;&amp; ctype_digit($start) === <span class="keyword">true</span>){
<a name="l01150"></a>01150                                 $start = (integer)$start;
<a name="l01151"></a>01151                         }
<a name="l01152"></a>01152                         <span class="keywordflow">if</span>(is_string($count) === <span class="keyword">true</span> &amp;&amp; ctype_digit($count) === <span class="keyword">true</span>){
<a name="l01153"></a>01153                                 $count = (integer)$count;
<a name="l01154"></a>01154                         }
<a name="l01155"></a>01155                         <span class="keywordflow">if</span>(is_string($query) === <span class="keyword">true</span>){
<a name="l01156"></a>01156                                 $query = trim($query);
<a name="l01157"></a>01157                         }
<a name="l01158"></a>01158 
<a name="l01159"></a>01159                         <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l01160"></a>01160                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be an integer.&#39;</span>);
<a name="l01161"></a>01161                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l01162"></a>01162                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count point must be an integer.&#39;</span>);
<a name="l01163"></a>01163                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($query) === <span class="keyword">false</span>){
<a name="l01164"></a>01164                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Query filter must be a string.&#39;</span>);
<a name="l01165"></a>01165                         }
<a name="l01166"></a>01166 
<a name="l01167"></a>01167                         $has = WebUI\SearchUserResults::hasInstance($this, $query);
<a name="l01168"></a>01168                         $results = array();
<a name="l01169"></a>01169 
<a name="l01170"></a>01170                         <span class="keywordflow">if</span>($asArray == <span class="keyword">true</span> || $has === <span class="keyword">false</span>){
<a name="l01171"></a>01171                                 $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;FindUsers&#39;</span>, array(
<a name="l01172"></a>01172                                         <span class="stringliteral">&#39;Start&#39;</span>=&gt;$start,
<a name="l01173"></a>01173                                         <span class="stringliteral">&#39;Count&#39;</span>=&gt;$count,
<a name="l01174"></a>01174                                         <span class="stringliteral">&#39;Query&#39;</span>=&gt;$query
<a name="l01175"></a>01175                                 ), array(
<a name="l01176"></a>01176                                         <span class="stringliteral">&#39;Users&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array()),
<a name="l01177"></a>01177                                         <span class="stringliteral">&#39;Total&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l01178"></a>01178                                 ));
<a name="l01179"></a>01179 
<a name="l01180"></a>01180                                 <span class="keywordflow">foreach</span>($result-&gt;Users as $userdata){
<a name="l01181"></a>01181                                         <span class="keywordflow">if</span>(isset($userdata-&gt;PrincipalID, $userdata-&gt;UserName, $userdata-&gt;Created, $userdata-&gt;UserFlags) === <span class="keyword">false</span>){
<a name="l01182"></a>01182                                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful but required response sub-properties were missing.&#39;</span>);
<a name="l01183"></a>01183                                         }
<a name="l01184"></a>01184                                         $results[] = WebUI\SearchUser::r($userdata-&gt;PrincipalID, $userdata-&gt;UserName, $userdata-&gt;Created, $userdata-&gt;UserFlags);
<a name="l01185"></a>01185                                 }
<a name="l01186"></a>01186                         }
<a name="l01187"></a>01187 
<a name="l01188"></a>01188 
<a name="l01189"></a>01189                         <span class="keywordflow">return</span> $asArray ? $results : WebUI\SearchUserResults::r($this, $query, $start, $has ? null : $result-&gt;Total, $results);
<a name="l01190"></a>01190                 }
<a name="l01191"></a>01191 
<a name="l01193"></a>01193 
<a name="l01197"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aece76f4c36f862b548338d2b13662b2e">01197</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aece76f4c36f862b548338d2b13662b2e" title="returns the friends list for the specified user.">GetFriends</a>($forUser){
<a name="l01198"></a>01198                         <span class="keywordflow">if</span>(($forUser instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser) === <span class="keyword">false</span>){
<a name="l01199"></a>01199                                 <span class="keywordflow">if</span>(is_string($forUser) === <span class="keyword">false</span>){
<a name="l01200"></a>01200                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;forUser must be a string.&#39;</span>);
<a name="l01201"></a>01201                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $forUser) !== 1){
<a name="l01202"></a>01202                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;forUser must be a valid UUID.&#39;</span>);
<a name="l01203"></a>01203                                 }
<a name="l01204"></a>01204                                 $forUser = $this-&gt;GetProfile(<span class="stringliteral">&#39;&#39;</span>, $forUser);
<a name="l01205"></a>01205                         }
<a name="l01206"></a>01206 
<a name="l01207"></a>01207                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetFriends&#39;</span>, array(<span class="stringliteral">&#39;UserID&#39;</span> =&gt; $forUser-&gt;PrincipalID()), array(
<a name="l01208"></a>01208                                 <span class="stringliteral">&#39;Friends&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array())
<a name="l01209"></a>01209                         ));
<a name="l01210"></a>01210                         $response = array();
<a name="l01211"></a>01211                         <span class="keywordflow">foreach</span>($result-&gt;Friends as $v){
<a name="l01212"></a>01212                                 <span class="keywordflow">if</span>(isset($v-&gt;PrincipalID, $v-&gt;Name, $v-&gt;MyFlags, $v-&gt;TheirFlags) === <span class="keyword">false</span>){
<a name="l01213"></a>01213                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but required response sub-properties were missing.&#39;</span>);
<a name="l01214"></a>01214                                 }
<a name="l01215"></a>01215                                 $response[] = WebUI\FriendInfo::r($forUser, $v-&gt;PrincipalID, $v-&gt;Name, $v-&gt;MyFlags, $v-&gt;TheirFlags);
<a name="l01216"></a>01216                         }
<a name="l01217"></a>01217 
<a name="l01218"></a>01218                         <span class="keywordflow">return</span> <span class="keyword">new</span> WebUI\FriendsList($response);
<a name="l01219"></a>01219                 }
<a name="l01220"></a>01220 
<a name="l01221"></a>01221 <span class="preprocessor">#region statistics</span>
<a name="l01222"></a>01222 <span class="preprocessor"></span>
<a name="l01224"></a>01224 
<a name="l01229"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a07dec5ccc5f24b32ee423aa6f954259b">01229</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a07dec5ccc5f24b32ee423aa6f954259b" title="Attempt to get the number of recently online users filtering the query by the method arguments...">NumberOfRecentlyOnlineUsers</a>($secondsAgo=0, $stillOnline=<span class="keyword">false</span>){
<a name="l01230"></a>01230                         <span class="keywordflow">if</span>(is_string($secondsAgo) &amp;&amp; ctype_digit($secondsAgo) === <span class="keyword">true</span>){
<a name="l01231"></a>01231                                 $secondsAgo = (integer)$secondsAgo;
<a name="l01232"></a>01232                         }
<a name="l01233"></a>01233 
<a name="l01234"></a>01234                         <span class="keywordflow">if</span>(is_integer($secondsAgo) === <span class="keyword">false</span>){
<a name="l01235"></a>01235                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;secondsAgo must be specified as integer.&#39;</span>);
<a name="l01236"></a>01236                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($secondsAgo &lt; 0){
<a name="l01237"></a>01237                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;secondsAgo must be greater than or equal to zero.&#39;</span>);
<a name="l01238"></a>01238                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_bool($stillOnline) === <span class="keyword">false</span>){
<a name="l01239"></a>01239                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;stillOnline must be specified as a boolean.&#39;</span>);
<a name="l01240"></a>01240                         }
<a name="l01241"></a>01241                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;NumberOfRecentlyOnlineUsers&#39;</span>, array(
<a name="l01242"></a>01242                                 <span class="stringliteral">&#39;secondsAgo&#39;</span>  =&gt; $secondsAgo,
<a name="l01243"></a>01243                                 <span class="stringliteral">&#39;stillOnline&#39;</span> =&gt; $stillOnline ? 1 : 0
<a name="l01244"></a>01244                         ), array(
<a name="l01245"></a>01245                                 <span class="stringliteral">&#39;result&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l01246"></a>01246                         ))-&gt;result;
<a name="l01247"></a>01247                 }
<a name="l01248"></a>01248 
<a name="l01250"></a>01250 
<a name="l01257"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a4b85c39e556a0404922aa961484b63da">01257</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a4b85c39e556a0404922aa961484b63da" title="Attempt to get a list of recently online users.">RecentlyOnlineUsers</a>($secondsAgo=0, $stillOnline=<span class="keyword">false</span>, $start=0, $count=10, $asArray=<span class="keyword">false</span>){
<a name="l01258"></a>01258                         <span class="keywordflow">if</span>(is_string($secondsAgo) &amp;&amp; ctype_digit($secondsAgo) === <span class="keyword">true</span>){
<a name="l01259"></a>01259                                 $secondsAgo = (integer)$secondsAgo;
<a name="l01260"></a>01260                         }
<a name="l01261"></a>01261                         <span class="keywordflow">if</span>(is_string($start) &amp;&amp; ctype_digit($start) === <span class="keyword">true</span>){
<a name="l01262"></a>01262                                 $start = (integer)$start;
<a name="l01263"></a>01263                         }
<a name="l01264"></a>01264                         <span class="keywordflow">if</span>(is_string($count) &amp;&amp; ctype_digit($count) === <span class="keyword">true</span>){
<a name="l01265"></a>01265                                 $count = (integer)$count;
<a name="l01266"></a>01266                         }
<a name="l01267"></a>01267 
<a name="l01268"></a>01268 
<a name="l01269"></a>01269                         <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l01270"></a>01270                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be an integer.&#39;</span>);
<a name="l01271"></a>01271                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l01272"></a>01272                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Maximum batch count must be an integer.&#39;</span>);
<a name="l01273"></a>01273                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($secondsAgo) === <span class="keyword">false</span>){
<a name="l01274"></a>01274                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;secondsAgo must be specified as integer.&#39;</span>);
<a name="l01275"></a>01275                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($secondsAgo &lt; 0){
<a name="l01276"></a>01276                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;secondsAgo must be greater than or equal to zero.&#39;</span>);
<a name="l01277"></a>01277                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_bool($stillOnline) === <span class="keyword">false</span>){
<a name="l01278"></a>01278                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;stillOnline must be specified as a boolean.&#39;</span>);
<a name="l01279"></a>01279                         }
<a name="l01280"></a>01280                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;RecentlyOnlineUsers&#39;</span>, array(
<a name="l01281"></a>01281                                 <span class="stringliteral">&#39;secondsAgo&#39;</span>  =&gt; $secondsAgo,
<a name="l01282"></a>01282                                 <span class="stringliteral">&#39;stillOnline&#39;</span> =&gt; $stillOnline ? 1 : 0,
<a name="l01283"></a>01283                                 <span class="stringliteral">&#39;Start&#39;</span>       =&gt; $start,
<a name="l01284"></a>01284                                 <span class="stringliteral">&#39;Count&#39;</span>       =&gt; $count
<a name="l01285"></a>01285                         ), array(
<a name="l01286"></a>01286                                 <span class="stringliteral">&#39;Start&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l01287"></a>01287                                 <span class="stringliteral">&#39;Count&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l01288"></a>01288                                 <span class="stringliteral">&#39;Total&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l01289"></a>01289                                 <span class="stringliteral">&#39;Users&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>  =&gt;array(array(
<a name="l01290"></a>01290                                         <span class="stringliteral">&#39;object&#39;</span> =&gt; array(static::GridUserInfoValidator())
<a name="l01291"></a>01291                                 )))
<a name="l01292"></a>01292                         ));
<a name="l01293"></a>01293 
<a name="l01294"></a>01294                         $users = array();
<a name="l01295"></a>01295                         <span class="keywordflow">foreach</span>($result-&gt;Users as $user){
<a name="l01296"></a>01296                                 $users[] = WebUI\GridUserInfo::r(
<a name="l01297"></a>01297                                         $user-&gt;UUID,
<a name="l01298"></a>01298                                         $user-&gt;Name,
<a name="l01299"></a>01299                                         $user-&gt;HomeUUID,
<a name="l01300"></a>01300                                         $user-&gt;HomeName,
<a name="l01301"></a>01301                                         $user-&gt;CurrentRegionUUID,
<a name="l01302"></a>01302                                         $user-&gt;CurrentRegionName,
<a name="l01303"></a>01303                                         $user-&gt;Online,
<a name="l01304"></a>01304                                         $user-&gt;Email,
<a name="l01305"></a>01305                                         $user-&gt;LastLogin  === <span class="keyword">false</span> ? null : $user-&gt;LastLogin,
<a name="l01306"></a>01306                                         $user-&gt;LastLogout === <span class="keyword">false</span> ? null : $user-&gt;LastLogout
<a name="l01307"></a>01307                                 );
<a name="l01308"></a>01308                         }
<a name="l01309"></a>01309 
<a name="l01310"></a>01310                         <span class="keywordflow">return</span> $asArray ? $users : WebUI\RecentlyOnlineUsersIterator::f($this, $secondsAgo, $stillOnline, $start, $result-&gt;Total, $users);
<a name="l01311"></a>01311                 }
<a name="l01312"></a>01312 
<a name="l01313"></a>01313 <span class="preprocessor">#endregion</span>
<a name="l01314"></a>01314 <span class="preprocessor"></span>
<a name="l01315"></a>01315 <span class="preprocessor">#endregion</span>
<a name="l01316"></a>01316 <span class="preprocessor"></span>
<a name="l01317"></a>01317 <span class="preprocessor">#region IAbuseReports</span>
<a name="l01318"></a>01318 <span class="preprocessor"></span>
<a name="l01320"></a>01320 
<a name="l01325"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ab859c47c72d1ec2921f437252ea4a2a3">01325</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ab859c47c72d1ec2921f437252ea4a2a3" title="Attempt to fetch all Abuse Reports.">GetAbuseReports</a>($start=0, $count=25, $active=<span class="keyword">true</span>){
<a name="l01326"></a>01326                         <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l01327"></a>01327                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be an integer.&#39;</span>);
<a name="l01328"></a>01328                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l01329"></a>01329                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Maximum abuse report count must be an integer.&#39;</span>);
<a name="l01330"></a>01330                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_bool($active) === <span class="keyword">false</span>){
<a name="l01331"></a>01331                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Activity flag must be a boolean.&#39;</span>);
<a name="l01332"></a>01332                         }
<a name="l01333"></a>01333 
<a name="l01334"></a>01334                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetAbuseReports&#39;</span>, array(<span class="stringliteral">&#39;Start&#39;</span> =&gt; $start, <span class="stringliteral">&#39;Count&#39;</span> =&gt; $count, <span class="stringliteral">&#39;Active&#39;</span> =&gt; $active), array(
<a name="l01335"></a>01335                                 <span class="stringliteral">&#39;AbuseReports&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(array(
<a name="l01336"></a>01336                                         <span class="stringliteral">&#39;object&#39;</span> =&gt; array(array(
<a name="l01337"></a>01337                                                 <span class="stringliteral">&#39;AbuseDetails&#39;</span>   =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01338"></a>01338                                                 <span class="stringliteral">&#39;AbuseLocation&#39;</span>  =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01339"></a>01339                                                 <span class="stringliteral">&#39;AbuserName&#39;</span>     =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01340"></a>01340                                                 <span class="stringliteral">&#39;AbuseSummary&#39;</span>   =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01341"></a>01341                                                 <span class="stringliteral">&#39;Active&#39;</span>         =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01342"></a>01342                                                 <span class="stringliteral">&#39;AssignedTo&#39;</span>     =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01343"></a>01343                                                 <span class="stringliteral">&#39;Category&#39;</span>       =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01344"></a>01344                                                 <span class="stringliteral">&#39;Checked&#39;</span>        =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01345"></a>01345                                                 <span class="stringliteral">&#39;Notes&#39;</span>          =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01346"></a>01346                                                 <span class="stringliteral">&#39;Number&#39;</span>         =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l01347"></a>01347                                                 <span class="stringliteral">&#39;ObjectName&#39;</span>     =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01348"></a>01348                                                 <span class="stringliteral">&#39;ObjectPosition&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01349"></a>01349                                                 <span class="stringliteral">&#39;ObjectUUID&#39;</span>     =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01350"></a>01350                                                 <span class="stringliteral">&#39;RegionName&#39;</span>     =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01351"></a>01351                                                 <span class="stringliteral">&#39;ReporterName&#39;</span>   =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array()),
<a name="l01352"></a>01352                                                 <span class="stringliteral">&#39;ScreenshotID&#39;</span>   =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt;array())
<a name="l01353"></a>01353                                         ))
<a name="l01354"></a>01354                                 )))
<a name="l01355"></a>01355                         ));
<a name="l01356"></a>01356 
<a name="l01357"></a>01357                         $results = array();
<a name="l01358"></a>01358                         <span class="keywordflow">foreach</span>($result-&gt;AbuseReports as $AR){
<a name="l01359"></a>01359                                 $results[] = WebUI\AbuseReport::r($AR-&gt;Number, $AR-&gt;AbuseDetails, $AR-&gt;AbuseLocation, $AR-&gt;AbuserName, $AR-&gt;AbuseSummary, $AR-&gt;Active, $AR-&gt;AssignedTo, $AR-&gt;Category, $AR-&gt;Checked, $AR-&gt;Notes, $AR-&gt;ObjectName, $AR-&gt;ObjectPosition, $AR-&gt;ObjectUUID, $AR-&gt;RegionName, $AR-&gt;ReporterName, $AR-&gt;ScreenshotID);
<a name="l01360"></a>01360                         }
<a name="l01361"></a>01361 
<a name="l01362"></a>01362                         <span class="keywordflow">return</span> <span class="keyword">new</span> WebUI\AbuseReports($results);
<a name="l01363"></a>01363                 }
<a name="l01364"></a>01364 
<a name="l01366"></a>01366 
<a name="l01370"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a82ce78597574da80908271c06d014d09">01370</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a82ce78597574da80908271c06d014d09" title="Attempts to mark the specified Abuse Report as complete.">AbuseReportMarkComplete</a>($abuseReport){
<a name="l01371"></a>01371                         <span class="keywordflow">if</span>($abuseReport instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\AbuseReport){
<a name="l01372"></a>01372                                 $abuseReport = $abuseReport-&gt;Number();
<a name="l01373"></a>01373                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($abuseReport) === <span class="keyword">true</span> &amp;&amp; ctype_digit($abuseReport) === <span class="keyword">true</span>){
<a name="l01374"></a>01374                                 $abuseReport = (integer)$abuseReport;
<a name="l01375"></a>01375                         }
<a name="l01376"></a>01376 
<a name="l01377"></a>01377                         <span class="keywordflow">if</span>(is_integer($abuseReport) === <span class="keyword">false</span>){
<a name="l01378"></a>01378                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Abuse report number must be specified as an integer.&#39;</span>);
<a name="l01379"></a>01379                         }
<a name="l01380"></a>01380 
<a name="l01381"></a>01381                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;AbuseReportMarkComplete&#39;</span>, array(<span class="stringliteral">&#39;Number&#39;</span> =&gt; $abuseReport), array(
<a name="l01382"></a>01382                                 <span class="stringliteral">&#39;Finished&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l01383"></a>01383                         ));
<a name="l01384"></a>01384 
<a name="l01385"></a>01385                         <span class="keywordflow">return</span> $result-&gt;Finished;
<a name="l01386"></a>01386                 }
<a name="l01387"></a>01387 
<a name="l01389"></a>01389 
<a name="l01394"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ac15d3e97133b205adbf9c99e96bdc036">01394</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ac15d3e97133b205adbf9c99e96bdc036" title="Attempt to update the notes for the specified abuse report.">AbuseReportSaveNotes</a>($abuseReport, $notes){
<a name="l01395"></a>01395                         <span class="keywordflow">if</span>($abuseReport instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\AbuseReport){
<a name="l01396"></a>01396                                 $abuseReport = $abuseReport-&gt;Number();
<a name="l01397"></a>01397                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($abuseReport) === <span class="keyword">true</span> &amp;&amp; ctype_digit($abuseReport) === <span class="keyword">true</span>){
<a name="l01398"></a>01398                                 $abuseReport = (integer)$abuseReport;
<a name="l01399"></a>01399                         }
<a name="l01400"></a>01400 
<a name="l01401"></a>01401                         <span class="keywordflow">if</span>(is_integer($abuseReport) === <span class="keyword">false</span>){
<a name="l01402"></a>01402                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Abuse report number must be specified as an integer.&#39;</span>);
<a name="l01403"></a>01403                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($notes) === <span class="keyword">false</span>){
<a name="l01404"></a>01404                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Abuse report notes must be specified as a string.&#39;</span>);
<a name="l01405"></a>01405                         }
<a name="l01406"></a>01406 
<a name="l01407"></a>01407                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;AbuseReportSaveNotes&#39;</span>, array(<span class="stringliteral">&#39;Number&#39;</span> =&gt; $abuseReport, <span class="stringliteral">&#39;Notes&#39;</span> =&gt; trim($notes)), array(
<a name="l01408"></a>01408                                 <span class="stringliteral">&#39;Finished&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l01409"></a>01409                         ));
<a name="l01410"></a>01410 
<a name="l01411"></a>01411                         <span class="keywordflow">return</span> $result-&gt;Finished;
<a name="l01412"></a>01412                 }
<a name="l01413"></a>01413 
<a name="l01414"></a>01414 <span class="preprocessor">#endregion</span>
<a name="l01415"></a>01415 <span class="preprocessor"></span>
<a name="l01416"></a>01416 <span class="preprocessor">#region Places</span>
<a name="l01417"></a>01417 <span class="preprocessor"></span>
<a name="l01418"></a>01418 <span class="preprocessor">#region Estate</span>
<a name="l01419"></a>01419 <span class="preprocessor"></span>
<a name="l01421"></a>01421 
<a name="l01424"></a>01424                 <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">function</span> EstateSettingsValidator(){
<a name="l01425"></a>01425                         <span class="keywordflow">return</span> array(
<a name="l01426"></a>01426                                 <span class="stringliteral">&#39;object&#39;</span> =&gt; array(array(
<a name="l01427"></a>01427                                         <span class="stringliteral">&#39;EstateID&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l01428"></a>01428                                         <span class="stringliteral">&#39;EstateName&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l01429"></a>01429                                         <span class="stringliteral">&#39;AbuseEmailToEstateOwner&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01430"></a>01430                                         <span class="stringliteral">&#39;DenyAnonymous&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01431"></a>01431                                         <span class="stringliteral">&#39;ResetHomeOnTeleport&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01432"></a>01432                                         <span class="stringliteral">&#39;FixedSun&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01433"></a>01433                                         <span class="stringliteral">&#39;DenyTransacted&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01434"></a>01434                                         <span class="stringliteral">&#39;BlockDwell&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01435"></a>01435                                         <span class="stringliteral">&#39;DenyIdentified&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01436"></a>01436                                         <span class="stringliteral">&#39;AllowVoice&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01437"></a>01437                                         <span class="stringliteral">&#39;UseGlobalTime&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01438"></a>01438                                         <span class="stringliteral">&#39;PricePerMeter&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l01439"></a>01439                                         <span class="stringliteral">&#39;TaxFree&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01440"></a>01440                                         <span class="stringliteral">&#39;AllowDirectTeleport&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01441"></a>01441                                         <span class="stringliteral">&#39;RedirectGridX&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array(), <span class="stringliteral">&#39;null&#39;</span>=&gt;array()),
<a name="l01442"></a>01442                                         <span class="stringliteral">&#39;RedirectGridY&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array(), <span class="stringliteral">&#39;null&#39;</span>=&gt;array()),
<a name="l01443"></a>01443                                         <span class="stringliteral">&#39;ParentEstateID&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l01444"></a>01444                                         <span class="stringliteral">&#39;SunPosition&#39;</span> =&gt; array(<span class="stringliteral">&#39;float&#39;</span>=&gt;array()),
<a name="l01445"></a>01445                                         <span class="stringliteral">&#39;EstateSkipScripts&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01446"></a>01446                                         <span class="stringliteral">&#39;BillableFactor&#39;</span> =&gt; array(<span class="stringliteral">&#39;float&#39;</span>=&gt;array()),
<a name="l01447"></a>01447                                         <span class="stringliteral">&#39;PublicAccess&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01448"></a>01448                                         <span class="stringliteral">&#39;AbuseEmail&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l01449"></a>01449                                         <span class="stringliteral">&#39;EstateOwner&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l01450"></a>01450                                         <span class="stringliteral">&#39;DenyMinors&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01451"></a>01451                                         <span class="stringliteral">&#39;AllowLandmark&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01452"></a>01452                                         <span class="stringliteral">&#39;AllowParcelChanges&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01453"></a>01453                                         <span class="stringliteral">&#39;AllowSetHome&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l01454"></a>01454                                         <span class="stringliteral">&#39;EstateBans&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()))),
<a name="l01455"></a>01455                                         <span class="stringliteral">&#39;EstateManagers&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()))),
<a name="l01456"></a>01456                                         <span class="stringliteral">&#39;EstateGroups&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()))),
<a name="l01457"></a>01457                                         <span class="stringliteral">&#39;EstateAccess&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()))),
<a name="l01458"></a>01458                                 ))
<a name="l01459"></a>01459                         );
<a name="l01460"></a>01460                 }
<a name="l01461"></a>01461 
<a name="l01463"></a>01463 
<a name="l01466"></a>01466                 <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">function</span> EstateSettingsFromResult(\stdClass $Estate){
<a name="l01467"></a>01467                         <span class="keywordflow">return</span> WebUI\EstateSettings::r(
<a name="l01468"></a>01468                                 $Estate-&gt;EstateID,
<a name="l01469"></a>01469                                 $Estate-&gt;EstateName,
<a name="l01470"></a>01470                                 $Estate-&gt;AbuseEmailToEstateOwner,
<a name="l01471"></a>01471                                 $Estate-&gt;DenyAnonymous,
<a name="l01472"></a>01472                                 $Estate-&gt;ResetHomeOnTeleport,
<a name="l01473"></a>01473                                 $Estate-&gt;FixedSun,
<a name="l01474"></a>01474                                 $Estate-&gt;DenyTransacted,
<a name="l01475"></a>01475                                 $Estate-&gt;BlockDwell,
<a name="l01476"></a>01476                                 $Estate-&gt;DenyIdentified,
<a name="l01477"></a>01477                                 $Estate-&gt;AllowVoice,
<a name="l01478"></a>01478                                 $Estate-&gt;UseGlobalTime,
<a name="l01479"></a>01479                                 $Estate-&gt;PricePerMeter,
<a name="l01480"></a>01480                                 $Estate-&gt;TaxFree,
<a name="l01481"></a>01481                                 $Estate-&gt;AllowDirectTeleport,
<a name="l01482"></a>01482                                 $Estate-&gt;RedirectGridX,
<a name="l01483"></a>01483                                 $Estate-&gt;RedirectGridY,
<a name="l01484"></a>01484                                 $Estate-&gt;ParentEstateID,
<a name="l01485"></a>01485                                 $Estate-&gt;SunPosition,
<a name="l01486"></a>01486                                 $Estate-&gt;EstateSkipScripts,
<a name="l01487"></a>01487                                 $Estate-&gt;BillableFactor,
<a name="l01488"></a>01488                                 $Estate-&gt;PublicAccess,
<a name="l01489"></a>01489                                 $Estate-&gt;AbuseEmail,
<a name="l01490"></a>01490                                 $Estate-&gt;EstateOwner,
<a name="l01491"></a>01491                                 $Estate-&gt;DenyMinors,
<a name="l01492"></a>01492                                 $Estate-&gt;AllowLandmark,
<a name="l01493"></a>01493                                 $Estate-&gt;AllowParcelChanges,
<a name="l01494"></a>01494                                 $Estate-&gt;AllowSetHome,
<a name="l01495"></a>01495                                 $Estate-&gt;EstateBans,
<a name="l01496"></a>01496                                 $Estate-&gt;EstateManagers,
<a name="l01497"></a>01497                                 $Estate-&gt;EstateGroups,
<a name="l01498"></a>01498                                 $Estate-&gt;EstateAccess
<a name="l01499"></a>01499                         );
<a name="l01500"></a>01500                 }
<a name="l01501"></a>01501 
<a name="l01503"></a>01503 
<a name="l01508"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a7f70ebcf4c29544955cf1565243de14d">01508</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a7f70ebcf4c29544955cf1565243de14d" title="Gets all estates with the specified owner and optional boolean filters.">GetEstates</a>($Owner, array $boolFields=null){
<a name="l01509"></a>01509                         <span class="keywordflow">if</span>(($Owner instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser) === <span class="keyword">false</span>){
<a name="l01510"></a>01510                                 <span class="keywordflow">if</span>(is_string($Owner) === <span class="keyword">false</span>){
<a name="l01511"></a>01511                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;OwnerID must be a string.&#39;</span>);
<a name="l01512"></a>01512                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $Owner) !== 1){
<a name="l01513"></a>01513                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;OwnerID must be a valid UUID.&#39;</span>);
<a name="l01514"></a>01514                                 }
<a name="l01515"></a>01515                                 $Owner = $this-&gt;GetProfile(<span class="stringliteral">&#39;&#39;</span>, $Owner);
<a name="l01516"></a>01516                         }
<a name="l01517"></a>01517 
<a name="l01518"></a>01518                         $input = array(
<a name="l01519"></a>01519                                 <span class="stringliteral">&#39;Owner&#39;</span> =&gt; $Owner-&gt;PrincipalID()
<a name="l01520"></a>01520                         );
<a name="l01521"></a>01521                         <span class="keywordflow">if</span>(isset($boolFields) === <span class="keyword">true</span>){
<a name="l01522"></a>01522                                 $input[<span class="stringliteral">&#39;BoolFields&#39;</span>] = $boolFields;
<a name="l01523"></a>01523                         }
<a name="l01524"></a>01524 
<a name="l01525"></a>01525                         $Estates = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetEstates&#39;</span>, $input, array(
<a name="l01526"></a>01526                                 <span class="stringliteral">&#39;Estates&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span> =&gt; array(
<a name="l01527"></a>01527                                         static::EstateSettingsValidator()
<a name="l01528"></a>01528                                 ))
<a name="l01529"></a>01529                         ))-&gt;Estates;
<a name="l01530"></a>01530                         $result = array();
<a name="l01531"></a>01531                         <span class="keywordflow">foreach</span>($Estates as $Estate){
<a name="l01532"></a>01532                                 $result[] = static::EstateSettingsFromResult($Estate);
<a name="l01533"></a>01533                         }
<a name="l01534"></a>01534 
<a name="l01535"></a>01535                         <span class="keywordflow">return</span> <span class="keyword">new</span> WebUI\EstateSettingsIterator($result);
<a name="l01536"></a>01536                 }
<a name="l01537"></a>01537 
<a name="l01539"></a>01539 
<a name="l01543"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad98214fc31c4ac47da51659b755f9efc">01543</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad98214fc31c4ac47da51659b755f9efc" title="Gets a single estate by estate name.">GetEstate</a>($Estate){
<a name="l01544"></a>01544                         <span class="keywordflow">if</span>(is_string($Estate) === <span class="keyword">true</span>){
<a name="l01545"></a>01545                                 <span class="keywordflow">if</span>(ctype_digit($Estate) === <span class="keyword">true</span>){
<a name="l01546"></a>01546                                         $Estate = (integer)$Estate;
<a name="l01547"></a>01547                                 }<span class="keywordflow">else</span>{
<a name="l01548"></a>01548                                         $Estate = trim($Estate);
<a name="l01549"></a>01549                                 }
<a name="l01550"></a>01550                         }
<a name="l01551"></a>01551 
<a name="l01552"></a>01552                         <span class="keywordflow">if</span>(is_integer($Estate) === <span class="keyword">false</span> &amp;&amp; is_string($Estate) === <span class="keyword">false</span>){
<a name="l01553"></a>01553                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Estate must be specified as integer or string.&#39;</span>);
<a name="l01554"></a>01554                         }
<a name="l01555"></a>01555 
<a name="l01556"></a>01556                         <span class="keywordflow">return</span> static::EstateSettingsFromResult($this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetEstate&#39;</span>, array(<span class="stringliteral">&#39;Estate&#39;</span> =&gt; $Estate), array(
<a name="l01557"></a>01557                                 <span class="stringliteral">&#39;Estate&#39;</span> =&gt; static::EstateSettingsValidator()
<a name="l01558"></a>01558                         ))-&gt;Estate);
<a name="l01559"></a>01559                 }
<a name="l01560"></a>01560 
<a name="l01561"></a>01561 <span class="preprocessor">#endregion</span>
<a name="l01562"></a>01562 <span class="preprocessor"></span>
<a name="l01563"></a>01563 <span class="preprocessor">#region Regions</span>
<a name="l01564"></a>01564 <span class="preprocessor"></span>
<a name="l01566"></a>01566 
<a name="l01569"></a>01569                 <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">function</span> GridRegionValidator(){
<a name="l01570"></a>01570                         <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;object&#39;</span> =&gt; array(array(
<a name="l01571"></a>01571                                 <span class="stringliteral">&#39;uuid&#39;</span>                 =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01572"></a>01572                                 <span class="stringliteral">&#39;locX&#39;</span>                 =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01573"></a>01573                                 <span class="stringliteral">&#39;locY&#39;</span>                 =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01574"></a>01574                                 <span class="stringliteral">&#39;locZ&#39;</span>                 =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01575"></a>01575                                 <span class="stringliteral">&#39;regionName&#39;</span>           =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01576"></a>01576                                 <span class="stringliteral">&#39;regionType&#39;</span>           =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01577"></a>01577                                 <span class="stringliteral">&#39;serverIP&#39;</span>             =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01578"></a>01578                                 <span class="stringliteral">&#39;serverHttpPort&#39;</span>       =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01579"></a>01579                                 <span class="stringliteral">&#39;serverURI&#39;</span>            =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01580"></a>01580                                 <span class="stringliteral">&#39;serverPort&#39;</span>           =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01581"></a>01581                                 <span class="stringliteral">&#39;regionMapTexture&#39;</span>     =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01582"></a>01582                                 <span class="stringliteral">&#39;regionTerrainTexture&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01583"></a>01583                                 <span class="stringliteral">&#39;access&#39;</span>               =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01584"></a>01584                                 <span class="stringliteral">&#39;owner_uuid&#39;</span>           =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01585"></a>01585                                 <span class="stringliteral">&#39;AuthToken&#39;</span>            =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01586"></a>01586                                 <span class="stringliteral">&#39;sizeX&#39;</span>                =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01587"></a>01587                                 <span class="stringliteral">&#39;sizeY&#39;</span>                =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01588"></a>01588                                 <span class="stringliteral">&#39;sizeZ&#39;</span>                =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01589"></a>01589                                 <span class="stringliteral">&#39;LastSeen&#39;</span>             =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01590"></a>01590                                 <span class="stringliteral">&#39;SessionID&#39;</span>            =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01591"></a>01591                                 <span class="stringliteral">&#39;Flags&#39;</span>                =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01592"></a>01592                                 <span class="stringliteral">&#39;GenericMap&#39;</span>           =&gt; array(<span class="stringliteral">&#39;object&#39;</span>  =&gt; array()),
<a name="l01593"></a>01593                                 <span class="stringliteral">&#39;EstateOwner&#39;</span>          =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l01594"></a>01594                                 <span class="stringliteral">&#39;EstateID&#39;</span>             =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01595"></a>01595                                 <span class="stringliteral">&#39;remoteEndPointIP&#39;</span>     =&gt; array(<span class="stringliteral">&#39;array&#39;</span>   =&gt; array()),
<a name="l01596"></a>01596                                 <span class="stringliteral">&#39;remoteEndPointPort&#39;</span>   =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01597"></a>01597                         )));
<a name="l01598"></a>01598                 }
<a name="l01599"></a>01599 
<a name="l01601"></a>01601 
<a name="l01615"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a2728389b32a8565a87fbd90637d2721f">01615</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a2728389b32a8565a87fbd90637d2721f" title="Get a list of regions in the AuroraSim install that match the specified flags.">GetRegions</a>($flags=null, $excludeFlags=null, $start=0, $count=10, $sortRegionName=null, $sortLocX=null, $sortLocY=null, $asArray=<span class="keyword">false</span>){
<a name="l01616"></a>01616                         <span class="keywordflow">if</span>(isset($flags) === <span class="keyword">false</span>){
<a name="l01617"></a>01617                                 $flags = RegionFlags::RegionOnline;
<a name="l01618"></a>01618                         }
<a name="l01619"></a>01619                         <span class="keywordflow">if</span>(isset($excludeFlags) === <span class="keyword">false</span>){
<a name="l01620"></a>01620                                 $excludeFlags = 0;
<a name="l01621"></a>01621                         }
<a name="l01622"></a>01622                         <span class="keywordflow">if</span>(is_string($flags) === <span class="keyword">true</span> &amp;&amp; ctype_digit($flags) === <span class="keyword">true</span>){
<a name="l01623"></a>01623                                 $flags = (integer)$flags;
<a name="l01624"></a>01624                         }
<a name="l01625"></a>01625                         <span class="keywordflow">if</span>(is_string($excludeFlags) === <span class="keyword">true</span> &amp;&amp; ctype_digit($excludeFlags) === <span class="keyword">true</span>){
<a name="l01626"></a>01626                                 $excludeFlags = (integer)$excludeFlags;
<a name="l01627"></a>01627                         }
<a name="l01628"></a>01628                         <span class="keywordflow">if</span>(is_string($start) === <span class="keyword">true</span> &amp;&amp; ctype_digit($start) === <span class="keyword">true</span>){
<a name="l01629"></a>01629                                 $start = (integer)$start;
<a name="l01630"></a>01630                         }
<a name="l01631"></a>01631                         <span class="keywordflow">if</span>(is_string($count) === <span class="keyword">true</span> &amp;&amp; ctype_digit($count) === <span class="keyword">true</span>){
<a name="l01632"></a>01632                                 $count = (integer)$count;
<a name="l01633"></a>01633                         }
<a name="l01634"></a>01634 
<a name="l01635"></a>01635                         <span class="keywordflow">if</span>(is_bool($asArray) === <span class="keyword">false</span>){
<a name="l01636"></a>01636                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;asArray flag must be a boolean.&#39;</span>);
<a name="l01637"></a>01637                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($flags) === <span class="keyword">false</span>){
<a name="l01638"></a>01638                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags argument should be supplied as integer.&#39;</span>);
<a name="l01639"></a>01639                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($flags &lt; 0){
<a name="l01640"></a>01640                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags cannot be less than zero&#39;</span>);
<a name="l01641"></a>01641                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(RegionFlags::isValid($flags) === <span class="keyword">false</span>){ <span class="comment">// Aurora::Framework::RegionFlags::isValid() does do a check for integerness, but we want to throw a different exception message if it is an integer.</span>
<a name="l01642"></a>01642                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags value is invalid, aborting call to API&#39;</span>);
<a name="l01643"></a>01643                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($excludeFlags &lt; 0){
<a name="l01644"></a>01644                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Region ExcludeFlags cannot be less than zero&#39;</span>);
<a name="l01645"></a>01645                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(RegionFlags::isValid($excludeFlags) === <span class="keyword">false</span>){ <span class="comment">// Aurora::Framework::RegionFlags::isValid() does do a check for integerness, but we want to throw a different exception message if it is an integer.</span>
<a name="l01646"></a>01646                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Region ExcludeFlags value is invalid, aborting call to API&#39;</span>);
<a name="l01647"></a>01647                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l01648"></a>01648                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be an integer.&#39;</span>);
<a name="l01649"></a>01649                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($count) === <span class="keyword">true</span>){
<a name="l01650"></a>01650                                 <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l01651"></a>01651                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be an integer.&#39;</span>);
<a name="l01652"></a>01652                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($count &lt; 1){
<a name="l01653"></a>01653                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be greater than zero.&#39;</span>);
<a name="l01654"></a>01654                                 }
<a name="l01655"></a>01655                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($sortRegionName) === <span class="keyword">true</span> &amp;&amp; is_bool($sortRegionName) === <span class="keyword">false</span>){
<a name="l01656"></a>01656                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If set, the sort by region name flag must be a boolean.&#39;</span>);
<a name="l01657"></a>01657                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($sortLocX) === <span class="keyword">true</span> &amp;&amp; is_bool($sortLocX) === <span class="keyword">false</span>){
<a name="l01658"></a>01658                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If set, the sort by x-axis flag must be a boolean.&#39;</span>);
<a name="l01659"></a>01659                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($sortLocY) === <span class="keyword">true</span> &amp;&amp; is_bool($sortLocY) === <span class="keyword">false</span>){
<a name="l01660"></a>01660                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If set, the sort by y-axis flag must be a boolean.&#39;</span>);
<a name="l01661"></a>01661                         }
<a name="l01662"></a>01662                         $response = array();
<a name="l01663"></a>01663                         $input = array(
<a name="l01664"></a>01664                                 <span class="stringliteral">&#39;RegionFlags&#39;</span>        =&gt; $flags,
<a name="l01665"></a>01665                                 <span class="stringliteral">&#39;ExcludeRegionFlags&#39;</span> =&gt; $excludeFlags,
<a name="l01666"></a>01666                                 <span class="stringliteral">&#39;Start&#39;</span>              =&gt; $start,
<a name="l01667"></a>01667                                 <span class="stringliteral">&#39;Count&#39;</span>              =&gt; $count
<a name="l01668"></a>01668                         );
<a name="l01669"></a>01669                         <span class="keywordflow">if</span>(isset($sortRegionName) === <span class="keyword">true</span>){
<a name="l01670"></a>01670                                 $input[<span class="stringliteral">&#39;SortRegionName&#39;</span>] = $sortRegionName;
<a name="l01671"></a>01671                         }
<a name="l01672"></a>01672                         <span class="keywordflow">if</span>(isset($sortLocX) === <span class="keyword">true</span>){
<a name="l01673"></a>01673                                 $input[<span class="stringliteral">&#39;SortLocX&#39;</span>] = $sortLocX;
<a name="l01674"></a>01674                         }
<a name="l01675"></a>01675                         <span class="keywordflow">if</span>(isset($sortLocY) === <span class="keyword">true</span>){
<a name="l01676"></a>01676                                 $input[<span class="stringliteral">&#39;SortLocY&#39;</span>] = $sortLocY;
<a name="l01677"></a>01677                         }
<a name="l01678"></a>01678                         $has = WebUI\GetRegions::hasInstance($this, $flags, $excludeFlags, $sortRegionName, $sortLocX, $sortLocY);
<a name="l01679"></a>01679                         <span class="keywordflow">if</span>($asArray === <span class="keyword">true</span> || $has === <span class="keyword">false</span>){
<a name="l01680"></a>01680                                 $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetRegions&#39;</span>, $input, array(
<a name="l01681"></a>01681                                         <span class="stringliteral">&#39;Regions&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(static::GridRegionValidator())),
<a name="l01682"></a>01682                                         <span class="stringliteral">&#39;Total&#39;</span>   =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l01683"></a>01683                                 ));
<a name="l01684"></a>01684                                 <span class="keywordflow">foreach</span>($result-&gt;Regions as $val){
<a name="l01685"></a>01685                                         $response[] = WebUI\GridRegion::fromEndPointResult($val);
<a name="l01686"></a>01686                                 }
<a name="l01687"></a>01687                         }
<a name="l01688"></a>01688 
<a name="l01689"></a>01689                         <span class="keywordflow">return</span> $asArray ? $response : WebUI\GetRegions::r($this, $flags, $excludeFlags, $start, $has ? null : $result-&gt;Total, $sortRegionName, $sortLocX, $sortLocY, $response);
<a name="l01690"></a>01690                 }
<a name="l01691"></a>01691 
<a name="l01693"></a>01693 
<a name="l01701"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a6b39c2f410060d2b601ce0dcfa25a583">01701</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a6b39c2f410060d2b601ce0dcfa25a583" title="Get a list of regions in the AuroraSim install at the specified x/y coordinates that also match the s...">GetRegionsByXY</a>($x, $y, $flags=null, $excludeFlags=null, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>){
<a name="l01702"></a>01702                         <span class="keywordflow">if</span>(isset($flags) === <span class="keyword">false</span>){
<a name="l01703"></a>01703                                 $flags = RegionFlags::RegionOnline;
<a name="l01704"></a>01704                         }
<a name="l01705"></a>01705                         <span class="keywordflow">if</span>(is_string($x) === <span class="keyword">true</span> &amp;&amp; ctype_digit($x) === <span class="keyword">true</span>){
<a name="l01706"></a>01706                                 $x = (integer)$x;
<a name="l01707"></a>01707                         }
<a name="l01708"></a>01708                         <span class="keywordflow">if</span>(is_string($y) === <span class="keyword">true</span> &amp;&amp; ctype_digit($y) === <span class="keyword">true</span>){
<a name="l01709"></a>01709                                 $y = (integer)$y;
<a name="l01710"></a>01710                         }
<a name="l01711"></a>01711 
<a name="l01712"></a>01712                         <span class="keywordflow">if</span>(is_integer($flags) === <span class="keyword">false</span>){
<a name="l01713"></a>01713                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags argument should be supplied as integer.&#39;</span>);
<a name="l01714"></a>01714                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($flags &lt; 0){
<a name="l01715"></a>01715                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags cannot be less than zero&#39;</span>);
<a name="l01716"></a>01716                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(RegionFlags::isValid($flags) === <span class="keyword">false</span>){ <span class="comment">// Aurora::Framework::RegionFlags::isValid() does do a check for integerness, but we want to throw a different exception message if it is an integer.</span>
<a name="l01717"></a>01717                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags value is invalid, aborting call to API&#39;</span>);
<a name="l01718"></a>01718                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($scopeID) === <span class="keyword">false</span>){
<a name="l01719"></a>01719                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;ScopeID must be specified as a string.&#39;</span>);
<a name="l01720"></a>01720                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $scopeID) != 1){
<a name="l01721"></a>01721                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;ScopeID must be a valid UUID.&#39;</span>);
<a name="l01722"></a>01722                         }
<a name="l01723"></a>01723                         <span class="keywordflow">if</span>(isset($excludeFlags) === <span class="keyword">true</span>){
<a name="l01724"></a>01724                                 <span class="keywordflow">if</span>(is_integer($excludeFlags) === <span class="keyword">false</span>){
<a name="l01725"></a>01725                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags exclusion argument should be supplied as integer.&#39;</span>);
<a name="l01726"></a>01726                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($excludeFlags &lt; 0){
<a name="l01727"></a>01727                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags exclusion cannot be less than zero&#39;</span>);
<a name="l01728"></a>01728                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(RegionFlags::isValid($excludeFlags) === <span class="keyword">false</span>){ <span class="comment">// Aurora::Framework::RegionFlags::isValid() does do a check for integerness, but we want to throw a different exception message if it is an integer.</span>
<a name="l01729"></a>01729                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags exclusion value is invalid, aborting call to API&#39;</span>);
<a name="l01730"></a>01730                                 }
<a name="l01731"></a>01731                         }
<a name="l01732"></a>01732 
<a name="l01733"></a>01733                         $input = array(
<a name="l01734"></a>01734                                 <span class="charliteral">&#39;X&#39;</span>           =&gt; $x,
<a name="l01735"></a>01735                                 <span class="charliteral">&#39;Y&#39;</span>           =&gt; $y,
<a name="l01736"></a>01736                                 <span class="stringliteral">&#39;ScopeID&#39;</span>     =&gt; $scopeID,
<a name="l01737"></a>01737                                 <span class="stringliteral">&#39;RegionFlags&#39;</span> =&gt; $flags
<a name="l01738"></a>01738                         );
<a name="l01739"></a>01739                         <span class="keywordflow">if</span>(isset($excludeFlags) === <span class="keyword">true</span>){
<a name="l01740"></a>01740                                 $input[<span class="stringliteral">&#39;ExcludeRegionFlags&#39;</span>] = $excludeFlags;
<a name="l01741"></a>01741                         }
<a name="l01742"></a>01742 
<a name="l01743"></a>01743                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetRegionsByXY&#39;</span>, $input, array(
<a name="l01744"></a>01744                                 <span class="stringliteral">&#39;Regions&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(static::GridRegionValidator())),
<a name="l01745"></a>01745                                 <span class="stringliteral">&#39;Total&#39;</span>   =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l01746"></a>01746                         ));
<a name="l01747"></a>01747                         $response = array();
<a name="l01748"></a>01748                         <span class="keywordflow">foreach</span>($result-&gt;Regions as $val){
<a name="l01749"></a>01749                                 $response[] = WebUI\GridRegion::fromEndPointResult($val);
<a name="l01750"></a>01750                         }
<a name="l01751"></a>01751 
<a name="l01752"></a>01752                         <span class="keywordflow">return</span> WebUI\GetRegionsByXY::r($this, $x, $y, $flags, isset($excludeFlags) ? $excludeFlags : 0, $scopeID, $response);
<a name="l01753"></a>01753                 }
<a name="l01754"></a>01754 
<a name="l01756"></a>01756 
<a name="l01764"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ac4712739b6d99b82a281edd2d98dd2d9">01764</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ac4712739b6d99b82a281edd2d98dd2d9" title="Get a list of regions in the specified area.">GetRegionsInArea</a>($startX, $startY, $endX, $endY, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>, $asArray=<span class="keyword">false</span>){
<a name="l01765"></a>01765                         $has      = WebUI\GetRegionsInArea::hasInstance($this, $startX, $startY, $endX, $endY, $scopeID);
<a name="l01766"></a>01766                         $response = array();
<a name="l01767"></a>01767                         <span class="keywordflow">if</span>($asArray === <span class="keyword">true</span> || $has === <span class="keyword">false</span>){
<a name="l01768"></a>01768                                 $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetRegionsInArea&#39;</span>, array(
<a name="l01769"></a>01769                                         <span class="stringliteral">&#39;StartX&#39;</span>  =&gt; $startX,
<a name="l01770"></a>01770                                         <span class="stringliteral">&#39;StartY&#39;</span>  =&gt; $startY,
<a name="l01771"></a>01771                                         <span class="stringliteral">&#39;EndX&#39;</span>    =&gt; $endX,
<a name="l01772"></a>01772                                         <span class="stringliteral">&#39;EndY&#39;</span>    =&gt; $endY,
<a name="l01773"></a>01773                                         <span class="stringliteral">&#39;ScopeID&#39;</span> =&gt; $scopeID
<a name="l01774"></a>01774                                 ), array(
<a name="l01775"></a>01775                                         <span class="stringliteral">&#39;Regions&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(static::GridRegionValidator())),
<a name="l01776"></a>01776                                         <span class="stringliteral">&#39;Total&#39;</span>   =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l01777"></a>01777                                 ));
<a name="l01778"></a>01778                                 <span class="keywordflow">foreach</span>($result-&gt;Regions as $val){
<a name="l01779"></a>01779                                         $response[] = WebUI\GridRegion::fromEndPointResult($val);
<a name="l01780"></a>01780                                 }
<a name="l01781"></a>01781                         }
<a name="l01782"></a>01782 
<a name="l01783"></a>01783                         <span class="keywordflow">return</span> $asArray ? $response : WebUI\GetRegionsInArea::r($this, $startX, $startY, $endX, $endY, $scopeID, 0, $result-&gt;Total, $response);
<a name="l01784"></a>01784                 }
<a name="l01785"></a>01785 
<a name="l01787"></a>01787 
<a name="l01801"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ae1e11ab89b1ece08bd2b662e528da77d">01801</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ae1e11ab89b1ece08bd2b662e528da77d" title="Get a list of regions in the specified estate that match the specified flags.">GetRegionsInEstate</a>(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\EstateSettings $Estate, $flags=null, $start=0, $count=null, $sortRegionName=null, $sortLocX=null, $sortLocY=null, $asArray=<span class="keyword">false</span>){
<a name="l01802"></a>01802                         <span class="keywordflow">if</span>(isset($flags) === <span class="keyword">false</span>){
<a name="l01803"></a>01803                                 $flags = RegionFlags::RegionOnline;
<a name="l01804"></a>01804                         }
<a name="l01805"></a>01805                         <span class="keywordflow">if</span>(is_bool($asArray) === <span class="keyword">false</span>){
<a name="l01806"></a>01806                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;asArray flag must be a boolean.&#39;</span>);
<a name="l01807"></a>01807                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($flags) === <span class="keyword">false</span>){
<a name="l01808"></a>01808                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags argument should be supplied as integer.&#39;</span>);
<a name="l01809"></a>01809                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($flags &lt; 0){
<a name="l01810"></a>01810                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags cannot be less than zero&#39;</span>);
<a name="l01811"></a>01811                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(RegionFlags::isValid($flags) === <span class="keyword">false</span>){ <span class="comment">// Aurora::Framework::RegionFlags::isValid() does do a check for integerness, but we want to throw a different exception message if it is an integer.</span>
<a name="l01812"></a>01812                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;RegionFlags value is invalid, aborting call to API&#39;</span>);
<a name="l01813"></a>01813                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l01814"></a>01814                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be an integer.&#39;</span>);
<a name="l01815"></a>01815                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($count) === <span class="keyword">true</span>){
<a name="l01816"></a>01816                                 <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l01817"></a>01817                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be an integer.&#39;</span>);
<a name="l01818"></a>01818                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($count &lt; 1){
<a name="l01819"></a>01819                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be greater than zero.&#39;</span>);
<a name="l01820"></a>01820                                 }
<a name="l01821"></a>01821                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($sortRegionName) === <span class="keyword">true</span> &amp;&amp; is_bool($sortRegionName) === <span class="keyword">false</span>){
<a name="l01822"></a>01822                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If set, the sort by region name flag must be a boolean.&#39;</span>);
<a name="l01823"></a>01823                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($sortLocX) === <span class="keyword">true</span> &amp;&amp; is_bool($sortLocX) === <span class="keyword">false</span>){
<a name="l01824"></a>01824                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If set, the sort by x-axis flag must be a boolean.&#39;</span>);
<a name="l01825"></a>01825                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($sortLocY) === <span class="keyword">true</span> &amp;&amp; is_bool($sortLocY) === <span class="keyword">false</span>){
<a name="l01826"></a>01826                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If set, the sort by y-axis flag must be a boolean.&#39;</span>);
<a name="l01827"></a>01827                         }
<a name="l01828"></a>01828                         $response = array();
<a name="l01829"></a>01829                         $input = array(
<a name="l01830"></a>01830                                 <span class="stringliteral">&#39;Estate&#39;</span>      =&gt; $Estate-&gt;EstateID(),
<a name="l01831"></a>01831                                 <span class="stringliteral">&#39;RegionFlags&#39;</span> =&gt; $flags,
<a name="l01832"></a>01832                                 <span class="stringliteral">&#39;Start&#39;</span>       =&gt; $start,
<a name="l01833"></a>01833                                 <span class="stringliteral">&#39;Count&#39;</span>       =&gt; $count
<a name="l01834"></a>01834                         );
<a name="l01835"></a>01835 
<a name="l01836"></a>01836                         <span class="keywordflow">if</span>(isset($sortRegionName) === <span class="keyword">true</span> || isset($sortRegionName) === <span class="keyword">true</span> || isset($sortLocY) === <span class="keyword">true</span>){
<a name="l01837"></a>01837                                 $input[<span class="stringliteral">&#39;Sort&#39;</span>] = array();
<a name="l01838"></a>01838                                 <span class="keywordflow">if</span>(isset($sortRegionName) === <span class="keyword">true</span>){
<a name="l01839"></a>01839                                         $input[<span class="stringliteral">&#39;Sort&#39;</span>][<span class="stringliteral">&#39;RegionName&#39;</span>] = $sortRegionName;
<a name="l01840"></a>01840                                 }
<a name="l01841"></a>01841                                 <span class="keywordflow">if</span>(isset($sortLocX) === <span class="keyword">true</span>){
<a name="l01842"></a>01842                                         $input[<span class="stringliteral">&#39;Sort&#39;</span>][<span class="stringliteral">&#39;LocX&#39;</span>] = $sortLocX;
<a name="l01843"></a>01843                                 }
<a name="l01844"></a>01844                                 <span class="keywordflow">if</span>(isset($sortLocY) === <span class="keyword">true</span>){
<a name="l01845"></a>01845                                         $input[<span class="stringliteral">&#39;Sort&#39;</span>][<span class="stringliteral">&#39;LocY&#39;</span>] = $sortLocY;
<a name="l01846"></a>01846                                 }
<a name="l01847"></a>01847                         }
<a name="l01848"></a>01848 
<a name="l01849"></a>01849                         $has = WebUI\GetRegions::hasInstance($this, $Estate, $flags, $sortRegionName, $sortLocX, $sortLocY);
<a name="l01850"></a>01850                         <span class="keywordflow">if</span>($asArray === <span class="keyword">true</span> || $has === <span class="keyword">false</span>){
<a name="l01851"></a>01851                                 $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetRegions&#39;</span>, $input, array(
<a name="l01852"></a>01852                                         <span class="stringliteral">&#39;Regions&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(static::GridRegionValidator())),
<a name="l01853"></a>01853                                         <span class="stringliteral">&#39;Total&#39;</span>   =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l01854"></a>01854                                 ));
<a name="l01855"></a>01855                                 <span class="keywordflow">foreach</span>($result-&gt;Regions as $val){
<a name="l01856"></a>01856                                         $response[] = WebUI\GridRegion::fromEndPointResult($val);
<a name="l01857"></a>01857                                 }
<a name="l01858"></a>01858                         }
<a name="l01859"></a>01859 
<a name="l01860"></a>01860                         <span class="keywordflow">return</span> $asArray ? $response : WebUI\GetRegionsInEstate::r($this, $Estate, $flags, $start, $has ? null : $result-&gt;Total, $sortRegionName, $sortLocX, $sortLocY, $response);
<a name="l01861"></a>01861                 }
<a name="l01862"></a>01862 
<a name="l01864"></a>01864 
<a name="l01869"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#af9239052ecd5500be0b07177a7ca0271">01869</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#af9239052ecd5500be0b07177a7ca0271" title="Get a single region.">GetRegion</a>($region, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>){
<a name="l01870"></a>01870                         <span class="keywordflow">if</span>(is_string($region) === <span class="keyword">false</span>){
<a name="l01871"></a>01871                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Region must be specified as a string.&#39;</span>);
<a name="l01872"></a>01872                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(trim($region) === <span class="stringliteral">&#39;&#39;</span>){
<a name="l01873"></a>01873                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Region must not be an empty string.&#39;</span>);
<a name="l01874"></a>01874                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($scopeID) === <span class="keyword">false</span>){
<a name="l01875"></a>01875                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;ScopeID must be specified as a string.&#39;</span>);
<a name="l01876"></a>01876                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $scopeID) != 1){
<a name="l01877"></a>01877                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;ScopeID must be a valid UUID.&#39;</span>);
<a name="l01878"></a>01878                         }
<a name="l01879"></a>01879 
<a name="l01880"></a>01880                         $input = array(
<a name="l01881"></a>01881                                 <span class="stringliteral">&#39;ScopeID&#39;</span> =&gt; $scopeID
<a name="l01882"></a>01882                         );
<a name="l01883"></a>01883 
<a name="l01884"></a>01884                         <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $region) != 1){
<a name="l01885"></a>01885                                 $input[<span class="stringliteral">&#39;Region&#39;</span>] = trim($region);
<a name="l01886"></a>01886                         }<span class="keywordflow">else</span>{
<a name="l01887"></a>01887                                 $input[<span class="stringliteral">&#39;RegionID&#39;</span>] = $region;
<a name="l01888"></a>01888                         }
<a name="l01889"></a>01889 
<a name="l01890"></a>01890                         <span class="keywordflow">return</span> WebUI\GridRegion::fromEndPointResult($this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetRegion&#39;</span>, $input, array(
<a name="l01891"></a>01891                                 <span class="stringliteral">&#39;Region&#39;</span> =&gt; static::GridRegionValidator()
<a name="l01892"></a>01892                         ))-&gt;Region);
<a name="l01893"></a>01893                 }
<a name="l01894"></a>01894 
<a name="l01896"></a>01896 
<a name="l01904"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a7dedfa90f78ba6669ad24a87d8d17c8f">01904</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a7dedfa90f78ba6669ad24a87d8d17c8f" title="Get a list of regions within range of the specified region.">GetRegionNeighbours</a>($region, $range=128, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>, $start=0, $asArray=<span class="keyword">false</span>){
<a name="l01905"></a>01905                         <span class="keywordflow">if</span>(is_string($range) === <span class="keyword">true</span> &amp;&amp; ctype_digit($range) === <span class="keyword">true</span>){
<a name="l01906"></a>01906                                 $range = (integer)$range;
<a name="l01907"></a>01907                         }
<a name="l01908"></a>01908 
<a name="l01909"></a>01909                         <span class="keywordflow">if</span>(is_string($region) === <span class="keyword">false</span>){
<a name="l01910"></a>01910                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Region ID must be specified as a string.&#39;</span>);
<a name="l01911"></a>01911                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $region) != 1){
<a name="l01912"></a>01912                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Region ID must be a valid UUID.&#39;</span>);
<a name="l01913"></a>01913                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($scopeID) === <span class="keyword">false</span>){
<a name="l01914"></a>01914                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;ScopeID must be specified as a string.&#39;</span>);
<a name="l01915"></a>01915                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $scopeID) != 1){
<a name="l01916"></a>01916                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;ScopeID must be a valid UUID.&#39;</span>);
<a name="l01917"></a>01917                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($range) === <span class="keyword">false</span>){
<a name="l01918"></a>01918                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Range must be specified as integer.&#39;</span>);
<a name="l01919"></a>01919                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($range &lt; 8){
<a name="l01920"></a>01920                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Range must be greater than or equal to 8&#39;</span>);
<a name="l01921"></a>01921                         }
<a name="l01922"></a>01922 
<a name="l01923"></a>01923                         $response = array();
<a name="l01924"></a>01924                         $has = WebUI\GetRegionNeighbours::hasInstance($this, $region, $range=128, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>);
<a name="l01925"></a>01925                         <span class="keywordflow">if</span>($asArray === <span class="keyword">true</span> || $has === <span class="keyword">false</span>){
<a name="l01926"></a>01926                                 $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetRegionNeighbours&#39;</span>, array(
<a name="l01927"></a>01927                                                 <span class="stringliteral">&#39;RegionID&#39;</span> =&gt; $region,
<a name="l01928"></a>01928                                                 <span class="stringliteral">&#39;ScopeID&#39;</span>  =&gt; $scopeID,
<a name="l01929"></a>01929                                                 <span class="stringliteral">&#39;Range&#39;</span>    =&gt; $range
<a name="l01930"></a>01930                                         ), array(
<a name="l01931"></a>01931                                                 <span class="stringliteral">&#39;Regions&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(static::GridRegionValidator())),
<a name="l01932"></a>01932                                                 <span class="stringliteral">&#39;Total&#39;</span>   =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l01933"></a>01933                                         )
<a name="l01934"></a>01934                                 );
<a name="l01935"></a>01935                                 <span class="keywordflow">foreach</span>($result-&gt;Regions as $val){
<a name="l01936"></a>01936                                         $response[] = WebUI\GridRegion::fromEndPointResult($val);
<a name="l01937"></a>01937                                 }
<a name="l01938"></a>01938                         }
<a name="l01939"></a>01939                         <span class="keywordflow">return</span> $asArray ? $response : WebUI\GetRegionNeighbours::r($this, $region, $range=128, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>, $start, $has ? null : $result-&gt;Total, $response);
<a name="l01940"></a>01940                 }
<a name="l01941"></a>01941 
<a name="l01942"></a>01942 <span class="preprocessor">#endregion</span>
<a name="l01943"></a>01943 <span class="preprocessor"></span>
<a name="l01944"></a>01944 <span class="preprocessor">#region Parcels</span>
<a name="l01945"></a>01945 <span class="preprocessor"></span>
<a name="l01947"></a>01947 
<a name="l01950"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a5f3fe5985554595c1cb20f40bfbfb828">01950</a>                 <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a5f3fe5985554595c1cb20f40bfbfb828" title="PHP doesn&#39;t do const arrays :(.">ParcelResultValidatorArray</a>(){
<a name="l01951"></a>01951                         <span class="keyword">static</span> $validator = array(
<a name="l01952"></a>01952                                 <span class="stringliteral">&#39;object&#39;</span> =&gt; array(array(
<a name="l01953"></a>01953                                         <span class="stringliteral">&#39;GroupID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01954"></a>01954                                         <span class="stringliteral">&#39;OwnerID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01955"></a>01955                                         <span class="stringliteral">&#39;Maturity&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01956"></a>01956                                         <span class="stringliteral">&#39;Area&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01957"></a>01957                                         <span class="stringliteral">&#39;AuctionID&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01958"></a>01958                                         <span class="stringliteral">&#39;SalePrice&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01959"></a>01959                                         <span class="stringliteral">&#39;InfoUUID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01960"></a>01960                                         <span class="stringliteral">&#39;Dwell&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01961"></a>01961                                         <span class="stringliteral">&#39;Flags&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01962"></a>01962                                         <span class="stringliteral">&#39;Name&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01963"></a>01963                                         <span class="stringliteral">&#39;Description&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01964"></a>01964                                         <span class="stringliteral">&#39;UserLocation&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span> =&gt; array(array(
<a name="l01965"></a>01965                                                 array(<span class="stringliteral">&#39;float&#39;</span> =&gt; array()),
<a name="l01966"></a>01966                                                 array(<span class="stringliteral">&#39;float&#39;</span> =&gt; array()),
<a name="l01967"></a>01967                                                 array(<span class="stringliteral">&#39;float&#39;</span> =&gt; array())
<a name="l01968"></a>01968                                         ))),
<a name="l01969"></a>01969                                         <span class="stringliteral">&#39;LocalID&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01970"></a>01970                                         <span class="stringliteral">&#39;GlobalID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01971"></a>01971                                         <span class="stringliteral">&#39;RegionID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01972"></a>01972                                         <span class="stringliteral">&#39;MediaDescription&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01973"></a>01973                                         <span class="stringliteral">&#39;MediaHeight&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01974"></a>01974                                         <span class="stringliteral">&#39;MediaLoop&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span> =&gt; array()),
<a name="l01975"></a>01975                                         <span class="stringliteral">&#39;MediaType&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01976"></a>01976                                         <span class="stringliteral">&#39;ObscureMedia&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span> =&gt; array()),
<a name="l01977"></a>01977                                         <span class="stringliteral">&#39;ObscureMusic&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span> =&gt; array()),
<a name="l01978"></a>01978                                         <span class="stringliteral">&#39;SnapshotID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01979"></a>01979                                         <span class="stringliteral">&#39;MediaAutoScale&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01980"></a>01980                                         <span class="stringliteral">&#39;MediaLoopSet&#39;</span> =&gt; array(<span class="stringliteral">&#39;float&#39;</span> =&gt; array()),
<a name="l01981"></a>01981                                         <span class="stringliteral">&#39;MediaURL&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01982"></a>01982                                         <span class="stringliteral">&#39;MusicURL&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01983"></a>01983                                         <span class="stringliteral">&#39;Bitmap&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01984"></a>01984                                         <span class="stringliteral">&#39;Category&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01985"></a>01985                                         <span class="stringliteral">&#39;FirstParty&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span> =&gt; array()),
<a name="l01986"></a>01986                                         <span class="stringliteral">&#39;ClaimDate&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01987"></a>01987                                         <span class="stringliteral">&#39;ClaimPrice&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01988"></a>01988                                         <span class="stringliteral">&#39;Status&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01989"></a>01989                                         <span class="stringliteral">&#39;LandingType&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01990"></a>01990                                         <span class="stringliteral">&#39;PassHours&#39;</span> =&gt; array(<span class="stringliteral">&#39;float&#39;</span> =&gt; array()),
<a name="l01991"></a>01991                                         <span class="stringliteral">&#39;PassPrice&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01992"></a>01992                                         <span class="stringliteral">&#39;UserLookAt&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span> =&gt; array(array(
<a name="l01993"></a>01993                                                 array(<span class="stringliteral">&#39;float&#39;</span> =&gt; array()),
<a name="l01994"></a>01994                                                 array(<span class="stringliteral">&#39;float&#39;</span> =&gt; array()),
<a name="l01995"></a>01995                                                 array(<span class="stringliteral">&#39;float&#39;</span> =&gt; array())
<a name="l01996"></a>01996                                         ))),
<a name="l01997"></a>01997                                         <span class="stringliteral">&#39;AuthBuyerID&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l01998"></a>01998                                         <span class="stringliteral">&#39;OtherCleanTime&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l01999"></a>01999                                         <span class="stringliteral">&#39;RegionHandle&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l02000"></a>02000                                         <span class="stringliteral">&#39;Private&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span> =&gt; array()),
<a name="l02001"></a>02001                                         <span class="stringliteral">&#39;GenericData&#39;</span> =&gt; array(<span class="stringliteral">&#39;object&#39;</span> =&gt; array()),
<a name="l02002"></a>02002                                 ))
<a name="l02003"></a>02003                         );
<a name="l02004"></a>02004                         <span class="keywordflow">return</span> $validator;
<a name="l02005"></a>02005                 }
<a name="l02006"></a>02006 
<a name="l02008"></a>02008 
<a name="l02012"></a>02012                 <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">function</span> ParcelResult2LandData(\stdClass $result){
<a name="l02013"></a>02013                         $result-&gt;UserLookAt   = <span class="keyword">new</span> Vector3($result-&gt;UserLookAt[0]  , $result-&gt;UserLookAt[1]  , $result-&gt;UserLookAt[2]  );
<a name="l02014"></a>02014                         $result-&gt;UserLocation = <span class="keyword">new</span> Vector3($result-&gt;UserLocation[0], $result-&gt;UserLocation[1], $result-&gt;UserLocation[2]);
<a name="l02015"></a>02015                         <span class="keywordflow">return</span> WebUI\LandData::r(
<a name="l02016"></a>02016                                 $result-&gt;InfoUUID,
<a name="l02017"></a>02017                                 $result-&gt;RegionID,
<a name="l02018"></a>02018                                 $result-&gt;GlobalID,
<a name="l02019"></a>02019                                 $result-&gt;LocalID,
<a name="l02020"></a>02020                                 $result-&gt;SalePrice,
<a name="l02021"></a>02021                                 $result-&gt;UserLocation,
<a name="l02022"></a>02022                                 $result-&gt;UserLookAt,
<a name="l02023"></a>02023                                 $result-&gt;Name,
<a name="l02024"></a>02024                                 $result-&gt;Description,
<a name="l02025"></a>02025                                 $result-&gt;Flags,
<a name="l02026"></a>02026                                 $result-&gt;Dwell,
<a name="l02027"></a>02027                                 $result-&gt;AuctionID,
<a name="l02028"></a>02028                                 $result-&gt;Area,
<a name="l02029"></a>02029                                 $result-&gt;Maturity,
<a name="l02030"></a>02030                                 $result-&gt;OwnerID,
<a name="l02031"></a>02031                                 $result-&gt;GroupID,
<a name="l02032"></a>02032                                 $result-&gt;IsGroupOwned,
<a name="l02033"></a>02033                                 $result-&gt;SnapshotID,
<a name="l02034"></a>02034                                 $result-&gt;MediaDescription,
<a name="l02035"></a>02035                                 $result-&gt;MediaWidth,
<a name="l02036"></a>02036                                 $result-&gt;MediaHeight,
<a name="l02037"></a>02037                                 $result-&gt;MediaLoop,
<a name="l02038"></a>02038                                 $result-&gt;MediaType,
<a name="l02039"></a>02039                                 $result-&gt;ObscureMedia,
<a name="l02040"></a>02040                                 $result-&gt;ObscureMusic,
<a name="l02041"></a>02041                                 $result-&gt;MediaLoopSet,
<a name="l02042"></a>02042                                 $result-&gt;MediaAutoScale,
<a name="l02043"></a>02043                                 $result-&gt;MediaURL,
<a name="l02044"></a>02044                                 $result-&gt;MusicURL,
<a name="l02045"></a>02045                                 $result-&gt;Bitmap,
<a name="l02046"></a>02046                                 $result-&gt;Category,
<a name="l02047"></a>02047                                 $result-&gt;FirstParty,
<a name="l02048"></a>02048                                 $result-&gt;ClaimDate,
<a name="l02049"></a>02049                                 $result-&gt;ClaimPrice,
<a name="l02050"></a>02050                                 $result-&gt;LandingType,
<a name="l02051"></a>02051                                 $result-&gt;PassHours,
<a name="l02052"></a>02052                                 $result-&gt;PassPrice,
<a name="l02053"></a>02053                                 $result-&gt;AuthBuyerID,
<a name="l02054"></a>02054                                 $result-&gt;OtherCleanTime,
<a name="l02055"></a>02055                                 $result-&gt;RegionHandle,
<a name="l02056"></a>02056                                 $result-&gt;Private,
<a name="l02057"></a>02057                                 $result-&gt;GenericData
<a name="l02058"></a>02058                         );
<a name="l02059"></a>02059                 }
<a name="l02060"></a>02060 
<a name="l02062"></a>02062 
<a name="l02071"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a20c7ca7004b68bfc7e203b5312ca8daf">02071</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a20c7ca7004b68bfc7e203b5312ca8daf" title="Gets all parcels in a region, optionally filtering by parcel owner and region scope ID...">GetParcelsByRegion</a>($start=0, $count=10, <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GridRegion $region, $owner=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>, $asArray=<span class="keyword">false</span>){
<a name="l02072"></a>02072                         <span class="keywordflow">if</span>(is_string($start) === <span class="keyword">true</span> &amp;&amp; ctype_digit($start) === <span class="keyword">true</span>){
<a name="l02073"></a>02073                                 $start = (integer)$start;
<a name="l02074"></a>02074                         }
<a name="l02075"></a>02075                         <span class="keywordflow">if</span>(is_string($count) === <span class="keyword">true</span> &amp;&amp; ctype_digit($count) === <span class="keyword">true</span>){
<a name="l02076"></a>02076                                 $count = (integer)$count;
<a name="l02077"></a>02077                         }
<a name="l02078"></a>02078 
<a name="l02079"></a>02079                         <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l02080"></a>02080                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be specified as integer.&#39;</span>);
<a name="l02081"></a>02081                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($start &lt; 0){
<a name="l02082"></a>02082                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be greater than or equal to zero.&#39;</span>);
<a name="l02083"></a>02083                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l02084"></a>02084                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be specified as integer.&#39;</span>);
<a name="l02085"></a>02085                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($count &lt; 0){
<a name="l02086"></a>02086                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be greater than or equal to zero.&#39;</span>);
<a name="l02087"></a>02087                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($owner) === <span class="keyword">false</span>){
<a name="l02088"></a>02088                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Owner must be specified as string.&#39;</span>);
<a name="l02089"></a>02089                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $owner) != 1){
<a name="l02090"></a>02090                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Owner must be valid UUID.&#39;</span>);
<a name="l02091"></a>02091                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($scopeID) === <span class="keyword">false</span>){
<a name="l02092"></a>02092                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;scopeID must be specified as string.&#39;</span>);
<a name="l02093"></a>02093                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $scopeID) != 1){
<a name="l02094"></a>02094                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;scopeID must be valid UUID.&#39;</span>);
<a name="l02095"></a>02095                         }
<a name="l02096"></a>02096 
<a name="l02097"></a>02097                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetParcelsByRegion&#39;</span>, array(
<a name="l02098"></a>02098                                 <span class="stringliteral">&#39;Start&#39;</span>   =&gt; $start,
<a name="l02099"></a>02099                                 <span class="stringliteral">&#39;Count&#39;</span>   =&gt; $count,
<a name="l02100"></a>02100                                 <span class="stringliteral">&#39;Region&#39;</span>  =&gt; $region-&gt;RegionID(),
<a name="l02101"></a>02101                                 <span class="stringliteral">&#39;Owner&#39;</span>   =&gt; $owner,
<a name="l02102"></a>02102                                 <span class="stringliteral">&#39;ScopeID&#39;</span> =&gt; $scopeID,
<a name="l02103"></a>02103                         ), array(
<a name="l02104"></a>02104                                 <span class="stringliteral">&#39;Parcels&#39;</span> =&gt; array(
<a name="l02105"></a>02105                                         <span class="stringliteral">&#39;array&#39;</span> =&gt; array(self::ParcelResultValidatorArray())
<a name="l02106"></a>02106                                 ),
<a name="l02107"></a>02107                                 <span class="stringliteral">&#39;Total&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l02108"></a>02108                         ));
<a name="l02109"></a>02109                         <span class="keywordflow">foreach</span>($result-&gt;Parcels as $k=&gt;$v){
<a name="l02110"></a>02110                                 $result-&gt;Parcels[$k] = self::ParcelResult2LandData($v);
<a name="l02111"></a>02111                         }
<a name="l02112"></a>02112                         <span class="keywordflow">return</span> $asArray ? $result-&gt;Parcels : WebUI\GetParcelsByRegion::r($this, $start, $result-&gt;Total, $region, $owner, $scopeID, $result-&gt;Parcels);
<a name="l02113"></a>02113                 }
<a name="l02114"></a>02114 
<a name="l02116"></a>02116 
<a name="l02122"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ae62d8a433176b74f6bf44ec604521bdc">02122</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ae62d8a433176b74f6bf44ec604521bdc" title="Gets a parcel either by infoID or by name, region and region scopeID.">GetParcel</a>($parcel, <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GridRegion $region=null, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>){
<a name="l02123"></a>02123                         <span class="keywordflow">if</span>(is_string($parcel) === <span class="keyword">false</span>){
<a name="l02124"></a>02124                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Parcel argument must be specified as string.&#39;</span>);
<a name="l02125"></a>02125                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($scopeID) === <span class="keyword">false</span>){
<a name="l02126"></a>02126                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;ScopeID must be specified as string.&#39;</span>);
<a name="l02127"></a>02127                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $scopeID) != 1){
<a name="l02128"></a>02128                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;ScopeID must be a valid UUID.&#39;</span>);
<a name="l02129"></a>02129                         }
<a name="l02130"></a>02130 
<a name="l02131"></a>02131                         $input = array();
<a name="l02132"></a>02132                         <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $parcel) != 1){
<a name="l02133"></a>02133                                 <span class="keywordflow">if</span>(isset($region) === <span class="keyword">false</span>){
<a name="l02134"></a>02134                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;When attempting to get a parcel by name, the region must be specified.&#39;</span>);
<a name="l02135"></a>02135                                 }
<a name="l02136"></a>02136                                 $input[<span class="stringliteral">&#39;RegionID&#39;</span>] = $region-&gt;RegionID();
<a name="l02137"></a>02137                                 $input[<span class="stringliteral">&#39;ScopeID&#39;</span>] = $scopeID;
<a name="l02138"></a>02138                                 $input[<span class="stringliteral">&#39;Parcel&#39;</span>] = trim($parcel);
<a name="l02139"></a>02139                         }<span class="keywordflow">else</span>{
<a name="l02140"></a>02140                                 $input[<span class="stringliteral">&#39;ParcelInfoUUID&#39;</span>] = $parcel;
<a name="l02141"></a>02141                         }
<a name="l02142"></a>02142 
<a name="l02143"></a>02143                         <span class="keywordflow">return</span> self::ParcelResult2LandData($this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetParcel&#39;</span>, $input, array(
<a name="l02144"></a>02144                                 <span class="stringliteral">&#39;Parcel&#39;</span> =&gt; self::ParcelResultValidatorArray()
<a name="l02145"></a>02145                         ))-&gt;Parcel);
<a name="l02146"></a>02146                 }
<a name="l02147"></a>02147 
<a name="l02149"></a>02149 
<a name="l02158"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ab24c8e9125d62e7961db553e050561bb">02158</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ab24c8e9125d62e7961db553e050561bb" title="Gets all parcels in the specified region with the specified parcel name.">GetParcelsWithNameByRegion</a>($start=0, $count=10, $name, <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GridRegion $region, $scopeID=<span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>, $asArray=<span class="keyword">false</span>){
<a name="l02159"></a>02159                         <span class="keywordflow">if</span>(is_string($start) === <span class="keyword">true</span> &amp;&amp; ctype_digit($start) === <span class="keyword">true</span>){
<a name="l02160"></a>02160                                 $start = (integer)$start;
<a name="l02161"></a>02161                         }
<a name="l02162"></a>02162                         <span class="keywordflow">if</span>(is_string($count) === <span class="keyword">true</span> &amp;&amp; ctype_digit($count) === <span class="keyword">true</span>){
<a name="l02163"></a>02163                                 $count = (integer)$count;
<a name="l02164"></a>02164                         }
<a name="l02165"></a>02165                         <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">true</span>){
<a name="l02166"></a>02166                                 $name = trim($name);
<a name="l02167"></a>02167                         }
<a name="l02168"></a>02168 
<a name="l02169"></a>02169                         <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l02170"></a>02170                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be specified as integer.&#39;</span>);
<a name="l02171"></a>02171                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($start &lt; 0){
<a name="l02172"></a>02172                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be greater than or equal to zero.&#39;</span>);
<a name="l02173"></a>02173                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l02174"></a>02174                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be specified as integer.&#39;</span>);
<a name="l02175"></a>02175                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($count &lt; 0){
<a name="l02176"></a>02176                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be greater than or equal to zero.&#39;</span>);
<a name="l02177"></a>02177                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($scopeID) === <span class="keyword">false</span>){
<a name="l02178"></a>02178                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;scopeID must be specified as string.&#39;</span>);
<a name="l02179"></a>02179                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $scopeID) != 1){
<a name="l02180"></a>02180                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;scopeID must be valid UUID.&#39;</span>);
<a name="l02181"></a>02181                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">false</span>){
<a name="l02182"></a>02182                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Parcel name must be specified as string.&#39;</span>);
<a name="l02183"></a>02183                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($name === <span class="stringliteral">&#39;&#39;</span>){
<a name="l02184"></a>02184                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Parcel name must not be empty string.&#39;</span>);
<a name="l02185"></a>02185                         }
<a name="l02186"></a>02186 
<a name="l02187"></a>02187                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetParcelsWithNameByRegion&#39;</span>, array(
<a name="l02188"></a>02188                                 <span class="stringliteral">&#39;Start&#39;</span>   =&gt; $start,
<a name="l02189"></a>02189                                 <span class="stringliteral">&#39;Count&#39;</span>   =&gt; $count,
<a name="l02190"></a>02190                                 <span class="stringliteral">&#39;Region&#39;</span>  =&gt; $region-&gt;RegionID(),
<a name="l02191"></a>02191                                 <span class="stringliteral">&#39;Parcel&#39;</span>   =&gt; $name,
<a name="l02192"></a>02192                                 <span class="stringliteral">&#39;ScopeID&#39;</span> =&gt; $scopeID,
<a name="l02193"></a>02193                         ), array(
<a name="l02194"></a>02194                                 <span class="stringliteral">&#39;Parcels&#39;</span> =&gt; array(
<a name="l02195"></a>02195                                         <span class="stringliteral">&#39;array&#39;</span> =&gt; array(self::ParcelResultValidatorArray())
<a name="l02196"></a>02196                                 ),
<a name="l02197"></a>02197                                 <span class="stringliteral">&#39;Total&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l02198"></a>02198                         ));
<a name="l02199"></a>02199                         <span class="keywordflow">foreach</span>($result-&gt;Parcels as $k=&gt;$v){
<a name="l02200"></a>02200                                 $result-&gt;Parcels[$k] = self::ParcelResult2LandData($v);
<a name="l02201"></a>02201                         }
<a name="l02202"></a>02202                         <span class="keywordflow">return</span> $asArray ? $result-&gt;Parcels : WebUI\GetParcelsWithNameByRegion::r($this, $start, $result-&gt;Total, $name, $region, $scopeID, $result-&gt;Parcels);
<a name="l02203"></a>02203                 }
<a name="l02204"></a>02204 
<a name="l02205"></a>02205 <span class="preprocessor">#endregion</span>
<a name="l02206"></a>02206 <span class="preprocessor"></span>
<a name="l02207"></a>02207 <span class="preprocessor">#endregion</span>
<a name="l02208"></a>02208 <span class="preprocessor"></span>
<a name="l02209"></a>02209 <span class="preprocessor">#region Groups</span>
<a name="l02210"></a>02210 <span class="preprocessor"></span>
<a name="l02211"></a>02211 <span class="preprocessor">#region GroupRecord</span>
<a name="l02212"></a>02212 <span class="preprocessor"></span>
<a name="l02214"></a>02214 
<a name="l02218"></a>02218                 <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">function</span> GroupResult2GroupRecord(\stdClass $group){
<a name="l02219"></a>02219                         <span class="keywordflow">if</span>(isset(
<a name="l02220"></a>02220                                 $group-&gt;GroupID,
<a name="l02221"></a>02221                                 $group-&gt;GroupName,
<a name="l02222"></a>02222                                 $group-&gt;Charter,
<a name="l02223"></a>02223                                 $group-&gt;GroupPicture,
<a name="l02224"></a>02224                                 $group-&gt;FounderID,
<a name="l02225"></a>02225                                 $group-&gt;MembershipFee,
<a name="l02226"></a>02226                                 $group-&gt;OpenEnrollment,
<a name="l02227"></a>02227                                 $group-&gt;ShowInList,
<a name="l02228"></a>02228                                 $group-&gt;AllowPublish,
<a name="l02229"></a>02229                                 $group-&gt;MaturePublish,
<a name="l02230"></a>02230                                 $group-&gt;OwnerRoleID
<a name="l02231"></a>02231                         ) === <span class="keyword">false</span>){
<a name="l02232"></a>02232                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Call to API was successful, but required response sub-properties were missing.&#39;</span>);
<a name="l02233"></a>02233                         }
<a name="l02234"></a>02234                         <span class="keywordflow">return</span> WebUI\GroupRecord::r(
<a name="l02235"></a>02235                                 $group-&gt;GroupID,
<a name="l02236"></a>02236                                 $group-&gt;GroupName,
<a name="l02237"></a>02237                                 $group-&gt;Charter,
<a name="l02238"></a>02238                                 $group-&gt;GroupPicture,
<a name="l02239"></a>02239                                 $group-&gt;FounderID,
<a name="l02240"></a>02240                                 $group-&gt;MembershipFee,
<a name="l02241"></a>02241                                 $group-&gt;OpenEnrollment,
<a name="l02242"></a>02242                                 $group-&gt;ShowInList,
<a name="l02243"></a>02243                                 $group-&gt;AllowPublish,
<a name="l02244"></a>02244                                 $group-&gt;MaturePublish,
<a name="l02245"></a>02245                                 $group-&gt;OwnerRoleID
<a name="l02246"></a>02246                         );
<a name="l02247"></a>02247                 }
<a name="l02248"></a>02248 
<a name="l02250"></a>02250 
<a name="l02255"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a72a785dc4b45c139dc5c57d9abf32496">02255</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a72a785dc4b45c139dc5c57d9abf32496" title="Enables or disables the specified group as a news source for WebUI.">GroupAsNewsSource</a>(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GroupRecord $group, $useAsNewsSource=<span class="keyword">true</span>){
<a name="l02256"></a>02256                         <span class="keywordflow">if</span>(is_bool($useAsNewsSource) === <span class="keyword">false</span>){
<a name="l02257"></a>02257                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;flag must be a boolean.&#39;</span>);
<a name="l02258"></a>02258                         }
<a name="l02259"></a>02259 
<a name="l02260"></a>02260                         $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GroupAsNewsSource&#39;</span>, array(
<a name="l02261"></a>02261                                 <span class="stringliteral">&#39;Group&#39;</span> =&gt; $group-&gt;GroupID(),
<a name="l02262"></a>02262                                 <span class="stringliteral">&#39;Use&#39;</span>   =&gt; $useAsNewsSource
<a name="l02263"></a>02263                         ), array(
<a name="l02264"></a>02264                                 <span class="stringliteral">&#39;Verified&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array(<span class="keyword">true</span>))
<a name="l02265"></a>02265                         ));
<a name="l02266"></a>02266                 }
<a name="l02267"></a>02267 
<a name="l02269"></a>02269 
<a name="l02277"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a3fdb8be4a31b918f03e3e2d4fa16f552">02277</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a3fdb8be4a31b918f03e3e2d4fa16f552" title="Gets an iterator for the number of groups specified, with optional filters.">GetGroups</a>($start=0, $count=10, array $sort=null, array $boolFields=null){
<a name="l02278"></a>02278                         $input = array(
<a name="l02279"></a>02279                                 <span class="stringliteral">&#39;Start&#39;</span> =&gt; $start,
<a name="l02280"></a>02280                                 <span class="stringliteral">&#39;Count&#39;</span> =&gt; $count
<a name="l02281"></a>02281                         );
<a name="l02282"></a>02282                         <span class="keywordflow">if</span>(isset($sort) === <span class="keyword">true</span>){
<a name="l02283"></a>02283                                 $input[<span class="stringliteral">&#39;Sort&#39;</span>] = $sort;
<a name="l02284"></a>02284                         }
<a name="l02285"></a>02285                         <span class="keywordflow">if</span>(isset($boolFields) === <span class="keyword">true</span>){
<a name="l02286"></a>02286                                 $input[<span class="stringliteral">&#39;BoolFields&#39;</span>] = $boolFields;
<a name="l02287"></a>02287                         }
<a name="l02288"></a>02288 
<a name="l02289"></a>02289                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetGroups&#39;</span>, $input, array(
<a name="l02290"></a>02290                                 <span class="stringliteral">&#39;Start&#39;</span>  =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l02291"></a>02291                                 <span class="stringliteral">&#39;Total&#39;</span>  =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l02292"></a>02292                                 <span class="stringliteral">&#39;Groups&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(array(<span class="stringliteral">&#39;object&#39;</span>=&gt;array()))),
<a name="l02293"></a>02293                         ));
<a name="l02294"></a>02294 
<a name="l02295"></a>02295                         $groups = array();
<a name="l02296"></a>02296                         <span class="keywordflow">foreach</span>($result-&gt;Groups as $group){
<a name="l02297"></a>02297                                 $groups[] = self::GroupResult2GroupRecord($group);
<a name="l02298"></a>02298                         }
<a name="l02299"></a>02299 
<a name="l02300"></a>02300                         <span class="keywordflow">return</span> WebUI\GetGroupRecords::r($this, $result-&gt;Start, $result-&gt;Total, $sort, $boolFields, $groups);
<a name="l02301"></a>02301                 }
<a name="l02302"></a>02302 
<a name="l02304"></a>02304 
<a name="l02310"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aa4a2500c11c96fdf449406fb47af98e0">02310</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#aa4a2500c11c96fdf449406fb47af98e0" title="Gets an iterator for the groups usable as news sources.">GetNewsSources</a>($start=0, $count=10, $asArray=<span class="keyword">false</span>){
<a name="l02311"></a>02311                         <span class="keywordflow">if</span>(is_string($start) === <span class="keyword">true</span> &amp;&amp; ctype_digit($start) === <span class="keyword">true</span>){
<a name="l02312"></a>02312                                 $start = (integer)$start;
<a name="l02313"></a>02313                         }
<a name="l02314"></a>02314                         <span class="keywordflow">if</span>(is_string($count) === <span class="keyword">true</span> &amp;&amp; ctype_digit($count) === <span class="keyword">true</span>){
<a name="l02315"></a>02315                                 $count = (integer)$count;
<a name="l02316"></a>02316                         }
<a name="l02317"></a>02317 
<a name="l02318"></a>02318                         <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l02319"></a>02319                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be specified as integer.&#39;</span>);
<a name="l02320"></a>02320                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($start &lt; 0){
<a name="l02321"></a>02321                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be greater than or equal to zero.&#39;</span>);
<a name="l02322"></a>02322                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l02323"></a>02323                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be specified as integer.&#39;</span>);
<a name="l02324"></a>02324                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($count &lt; 1){
<a name="l02325"></a>02325                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be greater than or equal to one.&#39;</span>);
<a name="l02326"></a>02326                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_bool($asArray) === <span class="keyword">false</span>){
<a name="l02327"></a>02327                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;asArray flag must be specified as boolean.&#39;</span>);
<a name="l02328"></a>02328                         }
<a name="l02329"></a>02329 
<a name="l02330"></a>02330                         $response = array();
<a name="l02331"></a>02331                         <span class="keywordflow">if</span>($asArray === <span class="keyword">true</span> || <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GetNewsSources::hasInstance($this) === <span class="keyword">false</span>){
<a name="l02332"></a>02332                                 $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetNewsSources&#39;</span>, array(
<a name="l02333"></a>02333                                         <span class="stringliteral">&#39;Start&#39;</span> =&gt; $start,
<a name="l02334"></a>02334                                         <span class="stringliteral">&#39;Count&#39;</span> =&gt; $count
<a name="l02335"></a>02335                                 ), array(
<a name="l02336"></a>02336                                         <span class="stringliteral">&#39;Total&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l02337"></a>02337                                         <span class="stringliteral">&#39;Groups&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(array(<span class="stringliteral">&#39;object&#39;</span>=&gt;array())))
<a name="l02338"></a>02338                                 ));
<a name="l02339"></a>02339                                 <span class="keywordflow">foreach</span>($result-&gt;Groups as $group){
<a name="l02340"></a>02340                                         $response[] = self::GroupResult2GroupRecord($group);
<a name="l02341"></a>02341                                 }
<a name="l02342"></a>02342                         }
<a name="l02343"></a>02343 
<a name="l02344"></a>02344                         <span class="keywordflow">return</span> $asArray ? $response : WebUI\GetNewsSources::r($this, $start, $result-&gt;Total, $response);
<a name="l02345"></a>02345                 }
<a name="l02346"></a>02346 
<a name="l02348"></a>02348 
<a name="l02353"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a734df71119217f7216d8c5fe5e9fdefd">02353</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a734df71119217f7216d8c5fe5e9fdefd" title="Fetches the specified group.">GetGroup</a>($nameOrUUID){
<a name="l02354"></a>02354                         <span class="keywordflow">if</span>(is_string($nameOrUUID) === <span class="keyword">true</span>){
<a name="l02355"></a>02355                                 $nameOrUUID = trim($nameOrUUID);
<a name="l02356"></a>02356                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($nameOrUUID) === <span class="keyword">false</span>){
<a name="l02357"></a>02357                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Method argument should be a string.&#39;</span>);
<a name="l02358"></a>02358                         }
<a name="l02359"></a>02359                         $name = <span class="stringliteral">&#39;&#39;</span>;
<a name="l02360"></a>02360                         $uuid = <span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>;
<a name="l02361"></a>02361                         <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $nameOrUUID) !== 1){
<a name="l02362"></a>02362                                 $input = array(
<a name="l02363"></a>02363                                         <span class="stringliteral">&#39;Name&#39;</span> =&gt; $nameOrUUID
<a name="l02364"></a>02364                                 );
<a name="l02365"></a>02365                         }<span class="keywordflow">else</span>{
<a name="l02366"></a>02366                                 $input = array(
<a name="l02367"></a>02367                                         <span class="stringliteral">&#39;UUID&#39;</span> =&gt; $nameOrUUID
<a name="l02368"></a>02368                                 );
<a name="l02369"></a>02369                         }
<a name="l02370"></a>02370 
<a name="l02371"></a>02371                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetGroup&#39;</span>, $input, array(
<a name="l02372"></a>02372                                 <span class="stringliteral">&#39;Group&#39;</span> =&gt; array(
<a name="l02373"></a>02373                                         <span class="stringliteral">&#39;object&#39;</span>  =&gt; array(),
<a name="l02374"></a>02374                                         <span class="stringliteral">&#39;boolean&#39;</span> =&gt; array(<span class="keyword">false</span>)
<a name="l02375"></a>02375                                 )
<a name="l02376"></a>02376                         ));
<a name="l02377"></a>02377 
<a name="l02378"></a>02378                         <span class="keywordflow">return</span> $result-&gt;Group ? self::GroupResult2GroupRecord($result-&gt;Group) : <span class="keyword">false</span>;
<a name="l02379"></a>02379                 }
<a name="l02380"></a>02380 
<a name="l02382"></a>02382 
<a name="l02386"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#affa4c86e44898f6a0aee0161244ff8f0">02386</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#affa4c86e44898f6a0aee0161244ff8f0" title="Gets an iterator for the specified list of GroupIDs.">foreknowledgeGetGroupRecords</a>(array $GroupIDs){
<a name="l02387"></a>02387 
<a name="l02388"></a>02388                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetGroups&#39;</span>, array(
<a name="l02389"></a>02389                                 <span class="stringliteral">&#39;Groups&#39;</span> =&gt; $GroupIDs
<a name="l02390"></a>02390                         ), array(
<a name="l02391"></a>02391                                 <span class="stringliteral">&#39;Groups&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(array(<span class="stringliteral">&#39;object&#39;</span>=&gt;array()))),
<a name="l02392"></a>02392                         ));
<a name="l02393"></a>02393 
<a name="l02394"></a>02394                         $groups = array();
<a name="l02395"></a>02395                         <span class="keywordflow">foreach</span>($result-&gt;Groups as $group){
<a name="l02396"></a>02396                                 $groups[] = self::GroupResult2GroupRecord($group);
<a name="l02397"></a>02397                         }
<a name="l02398"></a>02398 
<a name="l02399"></a>02399                         <span class="keywordflow">return</span> WebUI\foreknowledgeGetGroupRecords::r($this, $result-&gt;Start, $result-&gt;Total, null, null, $groups);
<a name="l02400"></a>02400                 }
<a name="l02401"></a>02401 
<a name="l02402"></a>02402 <span class="preprocessor">#endregion</span>
<a name="l02403"></a>02403 <span class="preprocessor"></span>
<a name="l02404"></a>02404 <span class="preprocessor">#region GroupNoticeData</span>
<a name="l02405"></a>02405 <span class="preprocessor"></span>
<a name="l02407"></a>02407 
<a name="l02410"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad539d29b687323c9378b5226596ec8d4">02410</a>                 <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ad539d29b687323c9378b5226596ec8d4" title="PHP doesn&#39;t do const arrays :(.">GroupNoticeValidatorArray</a>(){
<a name="l02411"></a>02411                         <span class="keyword">static</span> $validator = array(<span class="stringliteral">&#39;object&#39;</span>=&gt;array(array(
<a name="l02412"></a>02412                                 <span class="stringliteral">&#39;GroupID&#39;</span>       =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l02413"></a>02413                                 <span class="stringliteral">&#39;NoticeID&#39;</span>      =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l02414"></a>02414                                 <span class="stringliteral">&#39;Timestamp&#39;</span>     =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l02415"></a>02415                                 <span class="stringliteral">&#39;FromName&#39;</span>      =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l02416"></a>02416                                 <span class="stringliteral">&#39;Subject&#39;</span>       =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l02417"></a>02417                                 <span class="stringliteral">&#39;Message&#39;</span>       =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l02418"></a>02418                                 <span class="stringliteral">&#39;HasAttachment&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array()),
<a name="l02419"></a>02419                                 <span class="stringliteral">&#39;ItemID&#39;</span>        =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array()),
<a name="l02420"></a>02420                                 <span class="stringliteral">&#39;AssetType&#39;</span>     =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l02421"></a>02421                                 <span class="stringliteral">&#39;ItemName&#39;</span>      =&gt; array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array())
<a name="l02422"></a>02422                         )));
<a name="l02423"></a>02423                         <span class="keywordflow">return</span> $validator;
<a name="l02424"></a>02424                 }
<a name="l02425"></a>02425 
<a name="l02427"></a>02427 
<a name="l02434"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a8780edcbbdc1524b05d57ba180ff5b74">02434</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a8780edcbbdc1524b05d57ba180ff5b74" title="Get group notices for the specified groups.">GroupNotices</a>($start=0, $count=10, array $groups, $asArray=<span class="keyword">false</span>){
<a name="l02435"></a>02435                         $groupIDs = array();
<a name="l02436"></a>02436                         <span class="keywordflow">foreach</span>($groups as $group){
<a name="l02437"></a>02437                                 <span class="keywordflow">if</span>($group instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GroupRecord){
<a name="l02438"></a>02438                                         $groupIDs[] = $group-&gt;GroupID();
<a name="l02439"></a>02439                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_bool($group) === <span class="keyword">false</span>){
<a name="l02440"></a>02440                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Groups must be an array of Aurora::Addon::WebUI::GroupRecord instances&#39;</span>);
<a name="l02441"></a>02441                                 }
<a name="l02442"></a>02442                         }
<a name="l02443"></a>02443 
<a name="l02444"></a>02444                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GroupNotices&#39;</span>, array(
<a name="l02445"></a>02445                                 <span class="stringliteral">&#39;Start&#39;</span> =&gt; $start,
<a name="l02446"></a>02446                                 <span class="stringliteral">&#39;Count&#39;</span> =&gt; $count,
<a name="l02447"></a>02447                                 <span class="stringliteral">&#39;Groups&#39;</span> =&gt; $groupIDs
<a name="l02448"></a>02448                         ), array(
<a name="l02449"></a>02449                                 <span class="stringliteral">&#39;Total&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l02450"></a>02450                                 <span class="stringliteral">&#39;GroupNotices&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(self::GroupNoticeValidatorArray()))
<a name="l02451"></a>02451                         ));
<a name="l02452"></a>02452 
<a name="l02453"></a>02453                         $groupNotices = array();
<a name="l02454"></a>02454                         <span class="keywordflow">foreach</span>($result-&gt;GroupNotices as $groupNotice){
<a name="l02455"></a>02455                                 $groupNotices[] = WebUI\GroupNoticeData::r(
<a name="l02456"></a>02456                                         $groupNotice-&gt;GroupID,
<a name="l02457"></a>02457                                         $groupNotice-&gt;NoticeID,
<a name="l02458"></a>02458                                         $groupNotice-&gt;Timestamp,
<a name="l02459"></a>02459                                         $groupNotice-&gt;FromName,
<a name="l02460"></a>02460                                         $groupNotice-&gt;Subject,
<a name="l02461"></a>02461                                         $groupNotice-&gt;Message,
<a name="l02462"></a>02462                                         $groupNotice-&gt;HasAttachment,
<a name="l02463"></a>02463                                         $groupNotice-&gt;ItemID,
<a name="l02464"></a>02464                                         $groupNotice-&gt;AssetType,
<a name="l02465"></a>02465                                         $groupNotice-&gt;ItemName
<a name="l02466"></a>02466                                 );
<a name="l02467"></a>02467                         }
<a name="l02468"></a>02468 
<a name="l02469"></a>02469                         <span class="keywordflow">return</span> $asArray ? $groupNotices : WebUI\GetGroupNotices::r($this, $start, $result-&gt;Total, $groupIDs, $groupNotices);
<a name="l02470"></a>02470                 }
<a name="l02471"></a>02471 
<a name="l02473"></a>02473 
<a name="l02479"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a1491903062b105bceb182e360a99c49a">02479</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a1491903062b105bceb182e360a99c49a" title="Get group notices from groups flagged as being news sources.">NewsFromGroupNotices</a>($start=0, $count=10, $asArray=<span class="keyword">false</span>){
<a name="l02480"></a>02480 
<a name="l02481"></a>02481                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;NewsFromGroupNotices&#39;</span>, array(
<a name="l02482"></a>02482                                 <span class="stringliteral">&#39;Start&#39;</span> =&gt; $start,
<a name="l02483"></a>02483                                 <span class="stringliteral">&#39;Count&#39;</span> =&gt; $count
<a name="l02484"></a>02484                         ), array(
<a name="l02485"></a>02485                                 <span class="stringliteral">&#39;Total&#39;</span> =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array()),
<a name="l02486"></a>02486                                 <span class="stringliteral">&#39;GroupNotices&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array(self::GroupNoticeValidatorArray()))
<a name="l02487"></a>02487                         ));
<a name="l02488"></a>02488 
<a name="l02489"></a>02489                         $groupNotices = array();
<a name="l02490"></a>02490                         <span class="keywordflow">foreach</span>($result-&gt;GroupNotices as $groupNotice){
<a name="l02491"></a>02491                                 $groupNotices[] = WebUI\GroupNoticeData::r(
<a name="l02492"></a>02492                                         $groupNotice-&gt;GroupID,
<a name="l02493"></a>02493                                         $groupNotice-&gt;NoticeID,
<a name="l02494"></a>02494                                         $groupNotice-&gt;Timestamp,
<a name="l02495"></a>02495                                         $groupNotice-&gt;FromName,
<a name="l02496"></a>02496                                         $groupNotice-&gt;Subject,
<a name="l02497"></a>02497                                         $groupNotice-&gt;Message,
<a name="l02498"></a>02498                                         $groupNotice-&gt;HasAttachment,
<a name="l02499"></a>02499                                         $groupNotice-&gt;ItemID,
<a name="l02500"></a>02500                                         $groupNotice-&gt;AssetType,
<a name="l02501"></a>02501                                         $groupNotice-&gt;ItemName
<a name="l02502"></a>02502                                 );
<a name="l02503"></a>02503                         }
<a name="l02504"></a>02504 
<a name="l02505"></a>02505                         <span class="keywordflow">return</span> $asArray ? $groupNotices : WebUI\GetNewsFromGroupNotices::r($this, $start, $result-&gt;Total, array(), $groupNotices);
<a name="l02506"></a>02506                 }
<a name="l02507"></a>02507 
<a name="l02509"></a>02509 
<a name="l02513"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ab63b49cf8c565b92e395e9d20c9c557e">02513</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#ab63b49cf8c565b92e395e9d20c9c557e" title="Get individual group notice.">GetGroupNotice</a>($uuid){
<a name="l02514"></a>02514                         <span class="keywordflow">if</span>(is_string($uuid) === <span class="keyword">false</span>){
<a name="l02515"></a>02515                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Group notice ID should be specified as string.&#39;</span>);
<a name="l02516"></a>02516                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(self::regex_UUID, $uuid) !== 1){
<a name="l02517"></a>02517                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Group notice ID should be a valid UUID&#39;</span>);
<a name="l02518"></a>02518                         }
<a name="l02519"></a>02519                         $groupNotice = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetGroupNotice&#39;</span>, array(
<a name="l02520"></a>02520                                 <span class="stringliteral">&#39;NoticeID&#39;</span> =&gt; strtolower($uuid)
<a name="l02521"></a>02521                         ), array(
<a name="l02522"></a>02522                                 <span class="stringliteral">&#39;GroupNotice&#39;</span> =&gt; self::GroupNoticeValidatorArray()
<a name="l02523"></a>02523                         ))-&gt;GroupNotice;
<a name="l02524"></a>02524 
<a name="l02525"></a>02525                         <span class="keywordflow">return</span> WebUI\GroupNoticeData::r(
<a name="l02526"></a>02526                                 $groupNotice-&gt;GroupID,
<a name="l02527"></a>02527                                 $groupNotice-&gt;NoticeID,
<a name="l02528"></a>02528                                 $groupNotice-&gt;Timestamp,
<a name="l02529"></a>02529                                 $groupNotice-&gt;FromName,
<a name="l02530"></a>02530                                 $groupNotice-&gt;Subject,
<a name="l02531"></a>02531                                 $groupNotice-&gt;Message,
<a name="l02532"></a>02532                                 $groupNotice-&gt;HasAttachment,
<a name="l02533"></a>02533                                 $groupNotice-&gt;ItemID,
<a name="l02534"></a>02534                                 $groupNotice-&gt;AssetType,
<a name="l02535"></a>02535                                 $groupNotice-&gt;ItemName
<a name="l02536"></a>02536                         );
<a name="l02537"></a>02537                 }
<a name="l02538"></a>02538 
<a name="l02540"></a>02540 
<a name="l02545"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a621bd9efec26a64a235adc6773239e52">02545</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a621bd9efec26a64a235adc6773239e52" title="Edit a group notice.">EditGroupNotice</a>($notice, $subject=null, $message=null){
<a name="l02546"></a>02546                         <span class="keywordflow">if</span>(isset($subject) === <span class="keyword">true</span> &amp;&amp; is_string($subject) === <span class="keyword">false</span>){
<a name="l02547"></a>02547                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If subject is specified, it must be specified as string.&#39;</span>);
<a name="l02548"></a>02548                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($subject) === <span class="keyword">true</span> &amp;&amp; is_string($subject) === <span class="keyword">true</span> &amp;&amp; trim($subject) === <span class="stringliteral">&#39;&#39;</span>){
<a name="l02549"></a>02549                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If subject is specified, it must not be empty.&#39;</span>);
<a name="l02550"></a>02550                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($message) === <span class="keyword">true</span> &amp;&amp; is_string($message) === <span class="keyword">false</span>){
<a name="l02551"></a>02551                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If message is specified, it must be specified as string.&#39;</span>);
<a name="l02552"></a>02552                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($message) === <span class="keyword">true</span> &amp;&amp; is_string($message) === <span class="keyword">true</span> &amp;&amp; trim($message) === <span class="stringliteral">&#39;&#39;</span>){
<a name="l02553"></a>02553                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;If message is specified, it must not be empty.&#39;</span>);
<a name="l02554"></a>02554                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($subject, $message) === <span class="keyword">false</span>){
<a name="l02555"></a>02555                                 <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// if no changes are made, return immediately</span>
<a name="l02556"></a>02556                         }
<a name="l02557"></a>02557 
<a name="l02558"></a>02558                         <span class="keywordflow">if</span>($notice instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GroupNoticeData){
<a name="l02559"></a>02559                                 $notice = $notice-&gt;NoticeID();
<a name="l02560"></a>02560                         }
<a name="l02561"></a>02561                         <span class="keywordflow">if</span>(is_string($notice) === <span class="keyword">false</span>){
<a name="l02562"></a>02562                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;NoticeID must be specified as string.&#39;</span>);
<a name="l02563"></a>02563                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(static::regex_UUID, $notice) != 1){
<a name="l02564"></a>02564                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;NoticeID must be a valid UUID.&#39;</span>);
<a name="l02565"></a>02565                         }
<a name="l02566"></a>02566 
<a name="l02567"></a>02567                         $input = array(
<a name="l02568"></a>02568                                 <span class="stringliteral">&#39;NoticeID&#39;</span> =&gt; $notice
<a name="l02569"></a>02569                         );
<a name="l02570"></a>02570                         <span class="keywordflow">if</span>(isset($subject) === <span class="keyword">true</span>){
<a name="l02571"></a>02571                                 $input[<span class="stringliteral">&#39;Subject&#39;</span>] = trim($subject);
<a name="l02572"></a>02572                         }
<a name="l02573"></a>02573                         <span class="keywordflow">if</span>(isset($message) === <span class="keyword">true</span>){
<a name="l02574"></a>02574                                 $input[<span class="stringliteral">&#39;Message&#39;</span>] = trim($message);
<a name="l02575"></a>02575                         }
<a name="l02576"></a>02576 
<a name="l02577"></a>02577                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;EditGroupNotice&#39;</span>, $input, array(<span class="stringliteral">&#39;Success&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())))-&gt;Success;
<a name="l02578"></a>02578                 }
<a name="l02579"></a>02579 
<a name="l02581"></a>02581 
<a name="l02588"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a4fe3c1b1ef588a16ac693bc33b4c7c31">02588</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a4fe3c1b1ef588a16ac693bc33b4c7c31" title="Create a group notice.">AddGroupNotice</a>($group, $author, $subject, $message){
<a name="l02589"></a>02589                         <span class="keywordflow">if</span>($group instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GroupRecord){
<a name="l02590"></a>02590                                 $group = $group-&gt;GroupID();
<a name="l02591"></a>02591                         }
<a name="l02592"></a>02592                         <span class="keywordflow">if</span>($author instanceof \Aurora\Services\Interfaces\User){
<a name="l02593"></a>02593                                 $author = $author-&gt;PrincipalID();
<a name="l02594"></a>02594                         }
<a name="l02595"></a>02595                         <span class="keywordflow">if</span>(is_string($subject) === <span class="keyword">true</span>){
<a name="l02596"></a>02596                                 $subject = trim($subject);
<a name="l02597"></a>02597                         }
<a name="l02598"></a>02598                         <span class="keywordflow">if</span>(is_string($message) === <span class="keyword">true</span>){
<a name="l02599"></a>02599                                 $message = trim($message);
<a name="l02600"></a>02600                         }
<a name="l02601"></a>02601 
<a name="l02602"></a>02602                         <span class="keywordflow">if</span>(is_string($group) === <span class="keyword">false</span>){
<a name="l02603"></a>02603                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Group ID must be specified as string.&#39;</span>);
<a name="l02604"></a>02604                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(static::regex_UUID, $group) != 1){
<a name="l02605"></a>02605                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Group ID must be specified as UUID.&#39;</span>);
<a name="l02606"></a>02606                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($author) === <span class="keyword">false</span>){
<a name="l02607"></a>02607                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Author ID must be specified as string.&#39;</span>);
<a name="l02608"></a>02608                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(static::regex_UUID, $author) != 1){
<a name="l02609"></a>02609                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Author ID must be specified as UUID.&#39;</span>);
<a name="l02610"></a>02610                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($subject) === <span class="keyword">false</span>){
<a name="l02611"></a>02611                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Subject must be specified as string.&#39;</span>);
<a name="l02612"></a>02612                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($subject === <span class="stringliteral">&#39;&#39;</span>){
<a name="l02613"></a>02613                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Subject must be specified as non-empty string.&#39;</span>);
<a name="l02614"></a>02614                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($message) === <span class="keyword">false</span>){
<a name="l02615"></a>02615                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Message must be specified as string.&#39;</span>);
<a name="l02616"></a>02616                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($message === <span class="stringliteral">&#39;&#39;</span>){
<a name="l02617"></a>02617                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Message must be specified as non-empty string.&#39;</span>);
<a name="l02618"></a>02618                         }
<a name="l02619"></a>02619 
<a name="l02620"></a>02620                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;AddGroupNotice&#39;</span>, array(
<a name="l02621"></a>02621                                 <span class="stringliteral">&#39;GroupID&#39;</span>  =&gt; $group,
<a name="l02622"></a>02622                                 <span class="stringliteral">&#39;AuthorID&#39;</span> =&gt; $author,
<a name="l02623"></a>02623                                 <span class="stringliteral">&#39;Subject&#39;</span>  =&gt; $subject,
<a name="l02624"></a>02624                                 <span class="stringliteral">&#39;Message&#39;</span>  =&gt; $message
<a name="l02625"></a>02625                         ), array(<span class="stringliteral">&#39;NoticeID&#39;</span>=&gt;array(<span class="stringliteral">&#39;string&#39;</span>=&gt;array())))-&gt;NoticeID;
<a name="l02626"></a>02626                 }
<a name="l02627"></a>02627 
<a name="l02629"></a>02629 
<a name="l02634"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a6da23e36f36acf6f31b109e73a6e27d0">02634</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a6da23e36f36acf6f31b109e73a6e27d0" title="Remove a group notice.">RemoveGroupNotice</a>($group, $notice){
<a name="l02635"></a>02635                         <span class="keywordflow">if</span>($group instanceof <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GroupRecord){
<a name="l02636"></a>02636                                 $group = $group-&gt;GroupID();
<a name="l02637"></a>02637                         }
<a name="l02638"></a>02638 
<a name="l02639"></a>02639                         <span class="keywordflow">if</span>(is_string($group) === <span class="keyword">false</span>){
<a name="l02640"></a>02640                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Group ID must be specified as string.&#39;</span>);
<a name="l02641"></a>02641                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(static::regex_UUID, $group) != 1){
<a name="l02642"></a>02642                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Group ID must be specified as UUID.&#39;</span>);
<a name="l02643"></a>02643                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($notice) === <span class="keyword">false</span>){
<a name="l02644"></a>02644                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;NoticeID must be specified as string.&#39;</span>);
<a name="l02645"></a>02645                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(static::regex_UUID, $notice) != 1){
<a name="l02646"></a>02646                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;NoticeID must be a valid UUID.&#39;</span>);
<a name="l02647"></a>02647                         }
<a name="l02648"></a>02648 
<a name="l02649"></a>02649                         <span class="keywordflow">return</span> $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;RemoveGroupNotice&#39;</span>, array(
<a name="l02650"></a>02650                                 <span class="stringliteral">&#39;GroupID&#39;</span>  =&gt; $group,
<a name="l02651"></a>02651                                 <span class="stringliteral">&#39;NoticeID&#39;</span> =&gt; $notice
<a name="l02652"></a>02652                         ), array(
<a name="l02653"></a>02653                                 <span class="stringliteral">&#39;Success&#39;</span> =&gt; array(<span class="stringliteral">&#39;boolean&#39;</span>=&gt;array())
<a name="l02654"></a>02654                         ))-&gt;Success;
<a name="l02655"></a>02655                 }
<a name="l02656"></a>02656 
<a name="l02657"></a>02657 <span class="preprocessor">#endregion</span>
<a name="l02658"></a>02658 <span class="preprocessor"></span>
<a name="l02659"></a>02659 <span class="preprocessor">#endregion</span>
<a name="l02660"></a>02660 <span class="preprocessor"></span>
<a name="l02661"></a>02661 <span class="preprocessor">#region Events</span>
<a name="l02662"></a>02662 <span class="preprocessor"></span>
<a name="l02664"></a>02664 
<a name="l02667"></a>02667                 <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">function</span> EventsResultValidatorArray(){
<a name="l02668"></a>02668                         <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;object&#39;</span> =&gt; array(array(
<a name="l02669"></a>02669                                 <span class="stringliteral">&#39;eventID&#39;</span>     =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l02670"></a>02670                                 <span class="stringliteral">&#39;creator&#39;</span>     =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l02671"></a>02671                                 <span class="stringliteral">&#39;name&#39;</span>        =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l02672"></a>02672                                 <span class="stringliteral">&#39;category&#39;</span>    =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l02673"></a>02673                                 <span class="stringliteral">&#39;description&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l02674"></a>02674                                 <span class="stringliteral">&#39;date&#39;</span>        =&gt; array(<span class="stringliteral">&#39;string&#39;</span>  =&gt; array()),
<a name="l02675"></a>02675                                 <span class="stringliteral">&#39;dateUTC&#39;</span>     =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l02676"></a>02676                                 <span class="stringliteral">&#39;duration&#39;</span>    =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l02677"></a>02677                                 <span class="stringliteral">&#39;cover&#39;</span>       =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l02678"></a>02678                                 <span class="stringliteral">&#39;amount&#39;</span>      =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l02679"></a>02679                                 <span class="stringliteral">&#39;simName&#39;</span>     =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array()),
<a name="l02680"></a>02680                                 <span class="stringliteral">&#39;globalPos&#39;</span>   =&gt; array(<span class="stringliteral">&#39;array&#39;</span>   =&gt; array()),
<a name="l02681"></a>02681                                 <span class="stringliteral">&#39;eventFlags&#39;</span>  =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array()),
<a name="l02682"></a>02682                                 <span class="stringliteral">&#39;maturity&#39;</span>    =&gt; array(<span class="stringliteral">&#39;integer&#39;</span> =&gt; array())
<a name="l02683"></a>02683                         )));
<a name="l02684"></a>02684                 }
<a name="l02685"></a>02685 
<a name="l02687"></a>02687 
<a name="l02695"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a586888c626ced4bc84b1864b4ff3e82e">02695</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a586888c626ced4bc84b1864b4ff3e82e" title="Get a list of events with optional filters.">GetEvents</a>($start=0, $count=10, array $filter=null, array $sort=null, $asArray=<span class="keyword">false</span>){
<a name="l02696"></a>02696                         <span class="keywordflow">if</span>(is_string($start) === <span class="keyword">true</span> &amp;&amp; ctype_digit($start) === <span class="keyword">true</span>){
<a name="l02697"></a>02697                                 $start = (integer)$start;
<a name="l02698"></a>02698                         }
<a name="l02699"></a>02699                         <span class="keywordflow">if</span>(is_string($count) === <span class="keyword">true</span> &amp;&amp; ctype_digit($count) === <span class="keyword">true</span>){
<a name="l02700"></a>02700                                 $count = (integer)$count;
<a name="l02701"></a>02701                         }
<a name="l02702"></a>02702 
<a name="l02703"></a>02703                         <span class="keywordflow">if</span>(is_integer($start) === <span class="keyword">false</span>){
<a name="l02704"></a>02704                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Start point must be specified as integer.&#39;</span>);
<a name="l02705"></a>02705                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($count) === <span class="keyword">false</span>){
<a name="l02706"></a>02706                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be specified as integer.&#39;</span>);
<a name="l02707"></a>02707                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($count &lt; 0){
<a name="l02708"></a>02708                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Count must be greater than or equal to zero.&#39;</span>);
<a name="l02709"></a>02709                         }
<a name="l02710"></a>02710 
<a name="l02711"></a>02711                         $input = array(
<a name="l02712"></a>02712                                 <span class="stringliteral">&#39;Start&#39;</span> =&gt; $start,
<a name="l02713"></a>02713                                 <span class="stringliteral">&#39;Count&#39;</span> =&gt; $count
<a name="l02714"></a>02714                         );
<a name="l02715"></a>02715                         <span class="keywordflow">if</span>(isset($filter) === <span class="keyword">true</span>){
<a name="l02716"></a>02716                                 $input[<span class="stringliteral">&#39;Filter&#39;</span>] = $filter;
<a name="l02717"></a>02717                         }
<a name="l02718"></a>02718                         <span class="keywordflow">if</span>(isset($sort) === <span class="keyword">true</span>){
<a name="l02719"></a>02719                                 $input[<span class="stringliteral">&#39;Sort&#39;</span>] = $sort;
<a name="l02720"></a>02720                         }
<a name="l02721"></a>02721 
<a name="l02722"></a>02722                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;GetEvents&#39;</span>, $input, array(
<a name="l02723"></a>02723                                 <span class="stringliteral">&#39;Events&#39;</span> =&gt; array(<span class="stringliteral">&#39;array&#39;</span>=&gt;array( static::EventsResultValidatorArray())),
<a name="l02724"></a>02724                                 <span class="stringliteral">&#39;Total&#39;</span>  =&gt; array(<span class="stringliteral">&#39;integer&#39;</span>=&gt;array())
<a name="l02725"></a>02725                         ));
<a name="l02726"></a>02726                         $events = array();
<a name="l02727"></a>02727                         <span class="keywordflow">foreach</span>($result-&gt;Events as $event){
<a name="l02728"></a>02728                                 $events[] = WebUI\EventData::r(
<a name="l02729"></a>02729                                         $event-&gt;eventID,
<a name="l02730"></a>02730                                         $event-&gt;creator,
<a name="l02731"></a>02731                                         $event-&gt;name,
<a name="l02732"></a>02732                                         $event-&gt;description,
<a name="l02733"></a>02733                                         $event-&gt;category,
<a name="l02734"></a>02734                                         DateTime::createFromFormat(<span class="charliteral">&#39;U&#39;</span>, $event-&gt;dateUTC),
<a name="l02735"></a>02735                                         $event-&gt;duration,
<a name="l02736"></a>02736                                         $event-&gt;cover,
<a name="l02737"></a>02737                                         $event-&gt;simName,
<a name="l02738"></a>02738                                         <span class="keyword">new</span> Vector3($event-&gt;globalPos[0], $event-&gt;globalPos[1], $event-&gt;globalPos[2]) ,
<a name="l02739"></a>02739                                         $event-&gt;eventFlags,
<a name="l02740"></a>02740                                         $event-&gt;maturity
<a name="l02741"></a>02741                                 );
<a name="l02742"></a>02742                         }
<a name="l02743"></a>02743                         <span class="keywordflow">return</span> $asArray ? $events : WebUI\GetEvents::r($this, $start, $result-&gt;Total, $filter, $sort, $events);
<a name="l02744"></a>02744                 }
<a name="l02745"></a>02745 
<a name="l02747"></a>02747 
<a name="l02761"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a0a36010fdce0f2236cd3f60763b43ea7">02761</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#a0a36010fdce0f2236cd3f60763b43ea7" title="Adds an event to the grid directory.">CreateEvent</a>(<a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\abstractUser $creator, <a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>\GridRegion $region, DateTime $date, $cover, $maturity, $eventFlags, $duration, Vector3 $localPos, $name, $description, $category){
<a name="l02762"></a>02762                         <span class="keywordflow">if</span>(is_string($cover) === <span class="keyword">true</span> &amp;&amp; ctype_digit($cover) === <span class="keyword">true</span>){
<a name="l02763"></a>02763                                 $cover = (integer)$cover;
<a name="l02764"></a>02764                         }
<a name="l02765"></a>02765                         <span class="keywordflow">if</span>(is_string($maturity) === <span class="keyword">true</span> &amp;&amp; ctype_digit($maturity) === <span class="keyword">true</span>){
<a name="l02766"></a>02766                                 $maturity = (integer)$maturity;
<a name="l02767"></a>02767                         }
<a name="l02768"></a>02768                         <span class="keywordflow">if</span>(is_string($eventFlags) === <span class="keyword">true</span> &amp;&amp; ctype_digit($eventFlags) === <span class="keyword">true</span>){
<a name="l02769"></a>02769                                 $eventFlags = (integer)$eventFlags;
<a name="l02770"></a>02770                         }
<a name="l02771"></a>02771                         <span class="keywordflow">if</span>(is_string($duration) === <span class="keyword">true</span> &amp;&amp; ctype_digit($duration) === <span class="keyword">true</span>){
<a name="l02772"></a>02772                                 $duration = (integer)$duration;
<a name="l02773"></a>02773                         }
<a name="l02774"></a>02774                         <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">true</span>){
<a name="l02775"></a>02775                                 $name = trim($name);
<a name="l02776"></a>02776                         }
<a name="l02777"></a>02777                         <span class="keywordflow">if</span>(is_string($description) === <span class="keyword">true</span>){
<a name="l02778"></a>02778                                 $description = trim($description);
<a name="l02779"></a>02779                         }
<a name="l02780"></a>02780                         <span class="keywordflow">if</span>(is_string($category) === <span class="keyword">true</span>){
<a name="l02781"></a>02781                                 $category = trim($category);
<a name="l02782"></a>02782                         }
<a name="l02783"></a>02783 
<a name="l02784"></a>02784                         <span class="keywordflow">if</span>(is_integer($cover) === <span class="keyword">false</span>){
<a name="l02785"></a>02785                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Cover must be specified as integer.&#39;</span>);
<a name="l02786"></a>02786                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($cover &lt; 0){
<a name="l02787"></a>02787                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Cover must be greater than or equal to zero&#39;</span>);
<a name="l02788"></a>02788                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($maturity) === <span class="keyword">false</span>){
<a name="l02789"></a>02789                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Maturity must be specified as integer.&#39;</span>);
<a name="l02790"></a>02790                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($maturity &lt; 0){
<a name="l02791"></a>02791                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Maturity must be greater than or equal to zero&#39;</span>);
<a name="l02792"></a>02792                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($eventFlags) === <span class="keyword">false</span>){
<a name="l02793"></a>02793                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Flags must be specified as integer.&#39;</span>);
<a name="l02794"></a>02794                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($eventFlags &lt; 0){
<a name="l02795"></a>02795                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Flags must be greater than or equal to zero&#39;</span>);
<a name="l02796"></a>02796                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_integer($duration) === <span class="keyword">false</span>){
<a name="l02797"></a>02797                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Duration must be specified as integer.&#39;</span>);
<a name="l02798"></a>02798                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($duration &lt;= 0){
<a name="l02799"></a>02799                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Duration must be greater than zero&#39;</span>);
<a name="l02800"></a>02800                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($name) === <span class="keyword">false</span>){
<a name="l02801"></a>02801                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Name must be specified as string.&#39;</span>);
<a name="l02802"></a>02802                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($name === <span class="stringliteral">&#39;&#39;</span>){
<a name="l02803"></a>02803                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Name must be non-empty string.&#39;</span>);
<a name="l02804"></a>02804                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($description) === <span class="keyword">false</span>){
<a name="l02805"></a>02805                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Description must be specified as string.&#39;</span>);
<a name="l02806"></a>02806                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($description === <span class="stringliteral">&#39;&#39;</span>){
<a name="l02807"></a>02807                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Description must be non-empty string.&#39;</span>);
<a name="l02808"></a>02808                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(is_string($category) === <span class="keyword">false</span>){
<a name="l02809"></a>02809                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Category must be specified as string.&#39;</span>);
<a name="l02810"></a>02810                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($category === <span class="stringliteral">&#39;&#39;</span>){
<a name="l02811"></a>02811                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Category must be non-empty string.&#39;</span>);
<a name="l02812"></a>02812                         }
<a name="l02813"></a>02813 
<a name="l02814"></a>02814                         $event = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;CreateEvent&#39;</span>, array(
<a name="l02815"></a>02815                                 <span class="stringliteral">&#39;Creator&#39;</span>     =&gt; $creator-&gt;PrincipalID(),
<a name="l02816"></a>02816                                 <span class="stringliteral">&#39;Region&#39;</span>      =&gt; $region-&gt;RegionID(),
<a name="l02817"></a>02817                                 <span class="stringliteral">&#39;Parcel&#39;</span>      =&gt; <span class="stringliteral">&#39;00000000-0000-0000-0000-000000000000&#39;</span>,
<a name="l02818"></a>02818                                 <span class="stringliteral">&#39;Date&#39;</span>        =&gt; $date-&gt;format(<span class="charliteral">&#39;c&#39;</span>),
<a name="l02819"></a>02819                                 <span class="stringliteral">&#39;Cover&#39;</span>       =&gt; $cover,
<a name="l02820"></a>02820                                 <span class="stringliteral">&#39;Maturity&#39;</span>    =&gt; $maturity,
<a name="l02821"></a>02821                                 <span class="stringliteral">&#39;EventFlags&#39;</span>  =&gt; $eventFlags,
<a name="l02822"></a>02822                                 <span class="stringliteral">&#39;Duration&#39;</span>    =&gt; $duration,
<a name="l02823"></a>02823                                 <span class="stringliteral">&#39;Position&#39;</span>    =&gt; (string)$localPos,
<a name="l02824"></a>02824                                 <span class="stringliteral">&#39;Name&#39;</span>        =&gt; $name,
<a name="l02825"></a>02825                                 <span class="stringliteral">&#39;Description&#39;</span> =&gt; $description,
<a name="l02826"></a>02826                                 <span class="stringliteral">&#39;Category&#39;</span>    =&gt; $category
<a name="l02827"></a>02827                         ), array(
<a name="l02828"></a>02828                                 <span class="stringliteral">&#39;Event&#39;</span> =&gt; static::EventsResultValidatorArray()
<a name="l02829"></a>02829                         ))-&gt;Event;
<a name="l02830"></a>02830 
<a name="l02831"></a>02831                         <span class="keywordflow">return</span> WebUI\EventData::r(
<a name="l02832"></a>02832                                 $event-&gt;eventID,
<a name="l02833"></a>02833                                 $event-&gt;creator,
<a name="l02834"></a>02834                                 $event-&gt;name,
<a name="l02835"></a>02835                                 $event-&gt;description,
<a name="l02836"></a>02836                                 $event-&gt;category,
<a name="l02837"></a>02837                                 DateTime::createFromFormat(<span class="charliteral">&#39;U&#39;</span>, $event-&gt;dateUTC),
<a name="l02838"></a>02838                                 $event-&gt;duration,
<a name="l02839"></a>02839                                 $event-&gt;cover,
<a name="l02840"></a>02840                                 $event-&gt;simName,
<a name="l02841"></a>02841                                 <span class="keyword">new</span> Vector3($event-&gt;globalPos[0], $event-&gt;globalPos[1], $event-&gt;globalPos[2]) ,
<a name="l02842"></a>02842                                 $event-&gt;eventFlags,
<a name="l02843"></a>02843                                 $event-&gt;maturity
<a name="l02844"></a>02844                         );
<a name="l02845"></a>02845                 }
<a name="l02846"></a>02846 
<a name="l02847"></a>02847 <span class="preprocessor">#endregion</span>
<a name="l02848"></a>02848 <span class="preprocessor"></span>
<a name="l02850"></a>02850 
<a name="l02853"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI.html#acacfe684b69bc379ecc225c37572dd17">02853</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI.html#acacfe684b69bc379ecc225c37572dd17" title="Gets the client implementation data.">WebUIClientImplementationData</a>(){
<a name="l02854"></a>02854                         $result = $this-&gt;makeCallToAPI(<span class="stringliteral">&#39;WebUIClientImplementationData&#39;</span>, array(), array(
<a name="l02855"></a>02855                                 <span class="stringliteral">&#39;adminmodules&#39;</span> =&gt; array(<span class="stringliteral">&#39;object&#39;</span> =&gt; array()),
<a name="l02856"></a>02856                                 <span class="stringliteral">&#39;adminsetting&#39;</span> =&gt; array(<span class="stringliteral">&#39;object&#39;</span> =&gt; array()),
<a name="l02857"></a>02857                                 <span class="stringliteral">&#39;startregion&#39;</span> =&gt; array(<span class="stringliteral">&#39;string&#39;</span> =&gt; array())
<a name="l02858"></a>02858                         ));
<a name="l02859"></a>02859                         <span class="keywordflow">if</span>(preg_match(static::regex_UUID, $result-&gt;startregion) != 1){
<a name="l02860"></a>02860                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1UnexpectedValueException.html" title="Addon-specific UnexpectedValueException.">UnexpectedValueException</a>(<span class="stringliteral">&#39;Start region ID was not a valid UUID.&#39;</span>);
<a name="l02861"></a>02861                         }
<a name="l02862"></a>02862 
<a name="l02863"></a>02863                         $resp = array(
<a name="l02864"></a>02864                                 <span class="stringliteral">&#39;adminmodules&#39;</span> =&gt; array(),
<a name="l02865"></a>02865                                 <span class="stringliteral">&#39;adminsetting&#39;</span> =&gt; array()
<a name="l02866"></a>02866                         );
<a name="l02867"></a>02867 
<a name="l02868"></a>02868                         <span class="keywordflow">foreach</span>($result-&gt;adminmodules as $k=&gt;$v){
<a name="l02869"></a>02869                                 $resp[<span class="stringliteral">&#39;adminmodules&#39;</span>][$k] = $v;
<a name="l02870"></a>02870                         }
<a name="l02871"></a>02871 
<a name="l02872"></a>02872                         <span class="keywordflow">foreach</span>($result-&gt;adminsetting as $k=&gt;$v){
<a name="l02873"></a>02873                                 $resp[<span class="stringliteral">&#39;adminsetting&#39;</span>][$k] = $v;
<a name="l02874"></a>02874                         }
<a name="l02875"></a>02875 
<a name="l02876"></a>02876                         $resp[<span class="stringliteral">&#39;adminmodules&#39;</span>] = WebUI\BoolWORM::f($resp[<span class="stringliteral">&#39;adminmodules&#39;</span>]);
<a name="l02877"></a>02877                         $resp[<span class="stringliteral">&#39;startregion&#39;</span>] = $result-&gt;startregion;
<a name="l02878"></a>02878 
<a name="l02879"></a>02879                         <span class="keywordflow">return</span> $resp;
<a name="l02880"></a>02880                 }
<a name="l02881"></a>02881         }
<a name="l02882"></a>02882 }
<a name="l02883"></a>02883 
<a name="l02884"></a>02884 <span class="keyword">namespace</span>{
<a name="l02885"></a>02885         require_once(<span class="stringliteral">&#39;WebUI/abstracts.php&#39;</span>);
<a name="l02886"></a>02886 
<a name="l02887"></a>02887         require_once(<span class="stringliteral">&#39;WebUI/GridInfo.php&#39;</span>);
<a name="l02888"></a>02888         require_once(<span class="stringliteral">&#39;WebUI/Regions.php&#39;</span>);
<a name="l02889"></a>02889         require_once(<span class="stringliteral">&#39;WebUI/Parcels.php&#39;</span>);
<a name="l02890"></a>02890         require_once(<span class="stringliteral">&#39;WebUI/User.php&#39;</span>);
<a name="l02891"></a>02891         require_once(<span class="stringliteral">&#39;WebUI/Group.php&#39;</span>);
<a name="l02892"></a>02892         require_once(<span class="stringliteral">&#39;WebUI/Events.php&#39;</span>);
<a name="l02893"></a>02893 
<a name="l02894"></a>02894         require_once(<span class="stringliteral">&#39;WebUI/AbuseReports.php&#39;</span>);
<a name="l02895"></a>02895         require_once(<span class="stringliteral">&#39;WebUI/AvatarArchives.php&#39;</span>);
<a name="l02896"></a>02896         require_once(<span class="stringliteral">&#39;WebUI/Friends.php&#39;</span>);
<a name="l02897"></a>02897         require_once(<span class="stringliteral">&#39;WebUI/Template.php&#39;</span>);
<a name="l02898"></a>02898 }
<a name="l02899"></a>02899 
<a name="l02901"></a>02901 <span class="keyword">namespace </span><a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">Aurora\Addon\WebUI</a>{
<a name="l02902"></a>02902 
<a name="l02903"></a>02903         use <a class="code" href="classAurora_1_1Addon_1_1WORM.html" title="class for Write-Once-Read-Many implementations of ArrayAccess">Aurora\Addon\WORM</a>;
<a name="l02904"></a>02904 
<a name="l02906"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1Configs.html">02906</a>         <span class="keyword">class </span><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1Configs.html" title="Long-term goal of libAurora.php is to support multiple grids on a single website, so we need an itera...">Configs</a> <span class="keyword">extends</span> <a class="code" href="classAurora_1_1Addon_1_1WORM.html" title="class for Write-Once-Read-Many implementations of ArrayAccess">WORM</a>{
<a name="l02907"></a>02907 
<a name="l02909"></a>02909 
<a name="l02912"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1Configs.html#a73e4ce7a056932cccdb802b637135bfd">02912</a>                 <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1Configs.html#a73e4ce7a056932cccdb802b637135bfd" title="singleton method.">i</a>(){
<a name="l02913"></a>02913                         <span class="keyword">static</span> $instance;
<a name="l02914"></a>02914                         <span class="keywordflow">if</span>(isset($instance) === <span class="keyword">false</span>){
<a name="l02915"></a>02915                                 $instance = <span class="keyword">new</span> <span class="keyword">static</span>();
<a name="l02916"></a>02916                         }
<a name="l02917"></a>02917                         <span class="keywordflow">return</span> $instance;
<a name="l02918"></a>02918                 }
<a name="l02919"></a>02919 
<a name="l02921"></a>02921 
<a name="l02924"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1Configs.html#a0035da9c7f88bce47aab2fa9bef37363">02924</a>                 <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1Configs.html#a0035da9c7f88bce47aab2fa9bef37363" title="Shorthand method for getting the default instance of Aurora::Addon::WebUI without having to call Auro...">d</a>(){
<a name="l02925"></a>02925                         <span class="keywordflow">if</span>(static::i()-&gt;offsetExists(0) === <span class="keyword">false</span>){
<a name="l02926"></a>02926                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1BadMethodCallException.html" title="Addon-specific BadMethodCallException.">BadMethodCallException</a>(<span class="stringliteral">&#39;No configs have been set.&#39;</span>);
<a name="l02927"></a>02927                         }
<a name="l02928"></a>02928                         <span class="keywordflow">return</span> static::i()-&gt;offsetGet(0);
<a name="l02929"></a>02929                 }
<a name="l02930"></a>02930 
<a name="l02932"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1Configs.html#ac6bde6b1eb50eb5377e91771fe46b7a3">02932</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1Configs.html#ac6bde6b1eb50eb5377e91771fe46b7a3" title="Restricts offsets to integers and values to instances of Aurora::Addon::WebUI.">offsetSet</a>($offset, $value){
<a name="l02933"></a>02933                         <span class="keywordflow">if</span>(($value instanceof \Aurora\Addon\<a class="code" href="classAurora_1_1Addon_1_1WebUI.html" title="Now you might think this class should be a singleton loading config values from constants instead of ...">WebUI</a>) === <span class="keyword">false</span>){
<a name="l02934"></a>02934                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Only instances of Aurora::Addon::WebUI can be added to instances of Aurora::Addon::WebUI::Configs&#39;</span>);
<a name="l02935"></a>02935                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(isset($offset) === <span class="keyword">true</span> &amp;&amp; is_integer($offset) === <span class="keyword">false</span>){
<a name="l02936"></a>02936                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Only integer offsets allowed.&#39;</span>);
<a name="l02937"></a>02937                         }
<a name="l02938"></a>02938 
<a name="l02939"></a>02939                         $offset = isset($offset) ? $offset : $this-&gt;count();
<a name="l02940"></a>02940 
<a name="l02941"></a>02941                         <span class="keywordflow">if</span>(isset($this[$offset]) === <span class="keyword">true</span>){
<a name="l02942"></a>02942                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Configs cannot be overwritten.&#39;</span>);
<a name="l02943"></a>02943                         }
<a name="l02944"></a>02944 
<a name="l02945"></a>02945                         $this-&gt;data[$offset] = $value;
<a name="l02946"></a>02946                 }
<a name="l02947"></a>02947         }
<a name="l02948"></a>02948 
<a name="l02950"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BoolWORM.html">02950</a>         <span class="keyword">class </span><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BoolWORM.html" title="WORM array of booleans.">BoolWORM</a> <span class="keyword">extends</span> <a class="code" href="classAurora_1_1Addon_1_1WORM.html" title="class for Write-Once-Read-Many implementations of ArrayAccess">WORM</a>{
<a name="l02951"></a>02951 
<a name="l02953"></a>02953 
<a name="l02956"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BoolWORM.html#a912814afb125330dc34c2e184cd96b88">02956</a>                 <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BoolWORM.html#a912814afb125330dc34c2e184cd96b88" title="replacing the constructor">__construct</a>(array $bools){
<a name="l02957"></a>02957                         <span class="keywordflow">foreach</span>($bools as $k=&gt;$v){
<a name="l02958"></a>02958                                 <span class="keywordflow">if</span>(is_bool($v) === <span class="keyword">false</span>){
<a name="l02959"></a>02959                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Values must be boolean&#39;</span>);
<a name="l02960"></a>02960                                 }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(<span class="stringliteral">&#39;/^[A-z][A-z0-9]*$/&#39;</span>, $k) != 1){
<a name="l02961"></a>02961                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Key was invalid&#39;</span>);
<a name="l02962"></a>02962                                 }
<a name="l02963"></a>02963                         }
<a name="l02964"></a>02964                         $this-&gt;data = $bools;
<a name="l02965"></a>02965                 }
<a name="l02966"></a>02966 
<a name="l02968"></a>02968 
<a name="l02972"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BoolWORM.html#aeaacff38e04c56d8aba6d6be3c76172d">02972</a>                 <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BoolWORM.html#aeaacff38e04c56d8aba6d6be3c76172d" title="factory method">f</a>(array $bools){
<a name="l02973"></a>02973                         <span class="keywordflow">return</span> <span class="keyword">new</span> <span class="keyword">static</span>($bools);
<a name="l02974"></a>02974                 }
<a name="l02975"></a>02975 
<a name="l02977"></a><a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BoolWORM.html#ac6bde6b1eb50eb5377e91771fe46b7a3">02977</a>                 <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classAurora_1_1Addon_1_1WebUI_1_1BoolWORM.html#ac6bde6b1eb50eb5377e91771fe46b7a3" title="Restricts values to booleans.">offsetSet</a>($offset, $value){
<a name="l02978"></a>02978                         <span class="keywordflow">if</span>(is_bool($value) === <span class="keyword">false</span>){
<a name="l02979"></a>02979                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Values must be boolean&#39;</span>);
<a name="l02980"></a>02980                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(preg_match(<span class="stringliteral">&#39;/^[A-z][A-z0-9]*$/&#39;</span>, $offset) != 1){
<a name="l02981"></a>02981                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1InvalidArgumentException.html" title="Addon-specific InvalidArgumentException.">InvalidArgumentException</a>(<span class="stringliteral">&#39;Key was invalid&#39;</span>);
<a name="l02982"></a>02982                         }<span class="keywordflow">else</span> <span class="keywordflow">if</span>($this-&gt;offsetExists($offset) === <span class="keyword">true</span>){
<a name="l02983"></a>02983                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classAurora_1_1Addon_1_1BadMethodCallException.html" title="Addon-specific BadMethodCallException.">BadMethodCallException</a>(<span class="stringliteral">&#39;WORM instance values cannot be overwritten.&#39;</span>);
<a name="l02984"></a>02984                         }
<a name="l02985"></a>02985                 }
<a name="l02986"></a>02986         }
<a name="l02987"></a>02987 }
<a name="l02988"></a>02988 ?&gt;
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="WebUI_8php.html">WebUI.php</a>      </li>

    <li class="footer">Generated on Wed Apr 11 2012 12:28:08 for libAurora.php by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
