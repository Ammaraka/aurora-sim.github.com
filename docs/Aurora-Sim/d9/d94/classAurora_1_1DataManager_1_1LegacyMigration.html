<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Aurora-Sim: Aurora.DataManager.LegacyMigration Class Reference</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Aurora-Sim
   
   </div>
   <div id="projectbrief">An Open Source Virtual World Ser</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html','../../');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Events</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#properties">Properties</a>  </div>
  <div class="headertitle">
<div class="title">Aurora.DataManager.LegacyMigration Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> theory is based on the ruby on rails concept. Each database driver is going to be allowed to have files in Resources that specify the database migrations. They will be of the form:  
 <a href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Aurora.DataManager.LegacyMigration:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.png" usemap="#Aurora.DataManager.LegacyMigration_map" alt=""/>
  <map id="Aurora.DataManager.LegacyMigration_map" name="Aurora.DataManager.LegacyMigration_map">
<area href="../../df/dcf/classOpenSim_1_1Data_1_1MySQL_1_1MySqlMigration.html" title="This is a MySQL-customized migration processor. The only difference is in how it executes SQL scripts..." alt="OpenSim.Data.MySQL.MySqlMigration" shape="rect" coords="0,56,232,80"/>
</map>
 </div></div>

<p><a href="../../dd/d40/classAurora_1_1DataManager_1_1LegacyMigration-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7cfff059271f9c3d19ff2a8ed5e1e125"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a7cfff059271f9c3d19ff2a8ed5e1e125">Initialize</a> (DbConnection conn, Assembly assem, string type, string subtype)</td></tr>
<tr class="memdesc:a7cfff059271f9c3d19ff2a8ed5e1e125"><td class="mdescLeft">&#160;</td><td class="mdescRight">Must be called after creating with the parameterless constructor. NOTE that the <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> class now doesn't access database in any way during initialization. Specifically, it won't check if the [migrations] table exists. Such checks are done later: automatically on Update(), or you can explicitly call InitMigrationsTable().  <a href="#a7cfff059271f9c3d19ff2a8ed5e1e125"></a><br/></td></tr>
<tr class="memitem:aa5896fb0b0907600808ce9b5d4cc8fe1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa5896fb0b0907600808ce9b5d4cc8fe1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>InitMigrationsTable</b> ()</td></tr>
<tr class="memitem:a8dee0478ac40162cc4ffb96e9a2308e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a8dee0478ac40162cc4ffb96e9a2308e5">LegacyMigration</a> ()</td></tr>
<tr class="memdesc:a8dee0478ac40162cc4ffb96e9a2308e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Have the parameterless constructor just so we can specify it as a generic parameter with the new() constraint. Currently this is only used in the tests. A <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> instance created this way must be then initialized with <a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a7cfff059271f9c3d19ff2a8ed5e1e125" title="Must be called after creating with the parameterless constructor. NOTE that the Migration class now d...">Initialize()</a>. Regular creation should be through the parameterized constructors.  <a href="#a8dee0478ac40162cc4ffb96e9a2308e5"></a><br/></td></tr>
<tr class="memitem:ac1e827b3621131b47e6a69ba9879024b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac1e827b3621131b47e6a69ba9879024b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>LegacyMigration</b> (DbConnection conn, Assembly assem, string subtype, string type)</td></tr>
<tr class="memitem:a59353d67c16f55f400f04c0379cc5dd7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a59353d67c16f55f400f04c0379cc5dd7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>LegacyMigration</b> (DbConnection conn, Assembly assem, string type)</td></tr>
<tr class="memitem:abaa733f498a803a2912be05370993fd7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abaa733f498a803a2912be05370993fd7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>Update</b> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a3333a78b4f49b64a5e5eb9238da2291b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a3333a78b4f49b64a5e5eb9238da2291b">ExecuteScript</a> (DbConnection conn, string[] script)</td></tr>
<tr class="memdesc:a3333a78b4f49b64a5e5eb9238da2291b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes a script, possibly in a database-specific way. It can be redefined for a specific DBMS, if necessary. Specifically, to avoid problems with proc definitions in <a class="el" href="../../dc/d07/namespaceAurora_1_1DataManager_1_1MySQL.html">MySQL</a>, we must use MySqlScript class instead of just DbCommand. We don't want to bring <a class="el" href="../../dc/d07/namespaceAurora_1_1DataManager_1_1MySQL.html">MySQL</a> references here, so instead define a MySQLMigration class in <a class="el" href="../../df/d7b/namespaceOpenSim_1_1Data_1_1MySQL.html">OpenSim.Data.MySQL</a>.  <a href="#a3333a78b4f49b64a5e5eb9238da2291b"></a><br/></td></tr>
<tr class="memitem:a7dad8d4f78a5ed3c2c7dc73867f9c616"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7dad8d4f78a5ed3c2c7dc73867f9c616"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ExecuteScript</b> (DbConnection conn, string sql)</td></tr>
<tr class="memitem:a3fbd366b94172fcc21aa85de33108630"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3fbd366b94172fcc21aa85de33108630"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ExecuteScript</b> (string sql)</td></tr>
<tr class="memitem:a0d929cee468af74dd3401074001d2bea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0d929cee468af74dd3401074001d2bea"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ExecuteScript</b> (string[] script)</td></tr>
<tr class="memitem:a719582a58766e3a46147320ec939f300"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a719582a58766e3a46147320ec939f300"></a>
virtual int&#160;</td><td class="memItemRight" valign="bottom"><b>FindVersion</b> (DbConnection conn, string type)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:af1e92717cd41f86b65f4cad3de09700e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af1e92717cd41f86b65f4cad3de09700e"></a>
Assembly&#160;</td><td class="memItemRight" valign="bottom"><b>_assem</b></td></tr>
<tr class="memitem:a6ca7ccb1d427fa5d0445765b31576b61"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ca7ccb1d427fa5d0445765b31576b61"></a>
DbConnection&#160;</td><td class="memItemRight" valign="bottom"><b>_conn</b></td></tr>
<tr class="memitem:a8e31b9a66715424bb87a44aca76bad2a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8e31b9a66715424bb87a44aca76bad2a"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>_type</b></td></tr>
<tr><td colspan="2"><h2><a name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a9937f866f51d9e1a062003483cc8d00c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9937f866f51d9e1a062003483cc8d00c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>Version</b><code> [get, set]</code></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> theory is based on the ruby on rails concept. Each database driver is going to be allowed to have files in Resources that specify the database migrations. They will be of the form: </p>
<p>001_Users.sql 002_Users.sql 003_Users.sql 001_Prims.sql 002_Prims.sql ...etc...</p>
<p>When a database driver starts up, it specifies a resource that needs to be brought up to the current revision. For instance:</p>
<p><a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> um = new <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a>(DbConnection, Assembly, "Users"); um.Update();</p>
<p>This works out which version Users is at, and applies all the revisions past it to it. If there is no users table, all revisions are applied in order. Consider each future migration to be an incremental roll forward of the tables in question.</p>
<p>Assembly must be specifically passed in because otherwise you get the assembly that Migration.cs is part of, and what you really want is the assembly of your database class. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8dee0478ac40162cc4ffb96e9a2308e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a8dee0478ac40162cc4ffb96e9a2308e5">Aurora.DataManager.LegacyMigration.LegacyMigration</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Have the parameterless constructor just so we can specify it as a generic parameter with the new() constraint. Currently this is only used in the tests. A <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> instance created this way must be then initialized with <a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a7cfff059271f9c3d19ff2a8ed5e1e125" title="Must be called after creating with the parameterless constructor. NOTE that the Migration class now d...">Initialize()</a>. Regular creation should be through the parameterized constructors. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a3333a78b4f49b64a5e5eb9238da2291b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a3333a78b4f49b64a5e5eb9238da2291b">Aurora.DataManager.LegacyMigration.ExecuteScript</a> </td>
          <td>(</td>
          <td class="paramtype">DbConnection&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string[]&#160;</td>
          <td class="paramname"><em>script</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Executes a script, possibly in a database-specific way. It can be redefined for a specific DBMS, if necessary. Specifically, to avoid problems with proc definitions in <a class="el" href="../../dc/d07/namespaceAurora_1_1DataManager_1_1MySQL.html">MySQL</a>, we must use MySqlScript class instead of just DbCommand. We don't want to bring <a class="el" href="../../dc/d07/namespaceAurora_1_1DataManager_1_1MySQL.html">MySQL</a> references here, so instead define a MySQLMigration class in <a class="el" href="../../df/d7b/namespaceOpenSim_1_1Data_1_1MySQL.html">OpenSim.Data.MySQL</a>. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td></td></tr>
    <tr><td class="paramname">script</td><td>Array of strings, one-per-batch (often just one)</td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../df/dcf/classOpenSim_1_1Data_1_1MySQL_1_1MySqlMigration.html#a75e4d20a953730f548cdea4133c599a6">OpenSim.Data.MySQL.MySqlMigration</a>.</p>

</div>
</div>
<a class="anchor" id="a7cfff059271f9c3d19ff2a8ed5e1e125"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html#a7cfff059271f9c3d19ff2a8ed5e1e125">Aurora.DataManager.LegacyMigration.Initialize</a> </td>
          <td>(</td>
          <td class="paramtype">DbConnection&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Assembly&#160;</td>
          <td class="paramname"><em>assem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>subtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Must be called after creating with the parameterless constructor. NOTE that the <a class="el" href="../../d6/d02/namespaceAurora_1_1DataManager_1_1Migration.html">Migration</a> class now doesn't access database in any way during initialization. Specifically, it won't check if the [migrations] table exists. Such checks are done later: automatically on Update(), or you can explicitly call InitMigrationsTable(). </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td></td></tr>
    <tr><td class="paramname">assem</td><td></td></tr>
    <tr><td class="paramname">subtype</td><td></td></tr>
    <tr><td class="paramname">type</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Aurora/DataManager/Legacy/LegacyMigration.cs</li>
</ul>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d2/d4d/namespaceAurora.html">Aurora</a>      </li>
      <li class="navelem"><a class="el" href="../../d4/d7e/namespaceAurora_1_1DataManager.html">DataManager</a>      </li>
      <li class="navelem"><a class="el" href="../../d9/d94/classAurora_1_1DataManager_1_1LegacyMigration.html">LegacyMigration</a>      </li>

    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
